{"meta":{"title":"xunhan","subtitle":"博客","description":"这是训瀚的博客","author":"xunhanliu","url":"https://www.xunhanliu.top"},"pages":[{"title":"我的简历","date":"2018-07-07T04:00:00.000Z","updated":"2018-07-07T05:53:03.345Z","comments":true,"path":"about/index.html","permalink":"https://www.xunhanliu.top/about/index.html","excerpt":"","text":"pdf版本中文链接&emsp;&emsp;英文链接 基本资料 姓名 性别 年龄 其他信息 刘训瀚 obvious stripling 见链接 技能目前主要使用语言:js、python、C++. JS: 主要使用echarts和d3绘图，使用lodash等函数库进行数据分析。本博客使用了hexo框架开发。 python:主要用来进行数据分析。 C++:语言从C起家，然后汇编，C++。主要开发MFC程序和C#程序。 了解: 对MVC框架有所涉猎，曾用bootstrap开发一个小项目。 对php也比较熟悉。 嵌入式方面：对C51、STM32研究比较多，制作过大概10次PCB。 关于工作无业游民 关于学习哈工程毕业，目前就读天津大学研究生 关于座右铭 低调 好好学习，天天向上 关于爱好热爱运动，尤其喜爱跑步。喜欢玩游戏，尤其是LOL。 联系我微信："},{"title":"","date":"2018-07-05T14:45:10.836Z","updated":"2018-07-05T14:45:03.791Z","comments":true,"path":"css/test.css","permalink":"https://www.xunhanliu.top/css/test.css","excerpt":"","text":"#outCSS{ color: #0f0; }"},{"title":"","date":"2018-07-05T13:13:33.754Z","updated":"2018-07-05T13:06:29.131Z","comments":true,"path":"css/md+html_complex/material-icons.css","permalink":"https://www.xunhanliu.top/css/md+html_complex/material-icons.css","excerpt":"","text":"@font-face { font-family: 'Material Icons'; font-style: normal; font-weight: 400; src: local('Material Icons'), local('MaterialIcons-Regular'), url(MaterialIcons-Regular.woff) format('woff'); } .material-icons { font-family: 'Material Icons'; font-weight: normal; font-style: normal; font-size: 24px; /* Preferred icon size */ display: inline-block; line-height: 1; text-transform: none; letter-spacing: normal; word-wrap: normal; white-space: nowrap; direction: ltr; /* Support for all WebKit browsers. */ -webkit-font-smoothing: antialiased; /* Support for Safari and Chrome. */ text-rendering: optimizeLegibility; /* Support for Firefox. */ -moz-osx-font-smoothing: grayscale; /* Support for IE. */ font-feature-settings: 'liga'; }"},{"title":"","date":"2018-07-05T13:13:33.754Z","updated":"2018-07-05T13:06:29.131Z","comments":true,"path":"css/tsne-how_use/material-icons.css","permalink":"https://www.xunhanliu.top/css/tsne-how_use/material-icons.css","excerpt":"","text":"@font-face { font-family: 'Material Icons'; font-style: normal; font-weight: 400; src: local('Material Icons'), local('MaterialIcons-Regular'), url(MaterialIcons-Regular.woff) format('woff'); } .material-icons { font-family: 'Material Icons'; font-weight: normal; font-style: normal; font-size: 24px; /* Preferred icon size */ display: inline-block; line-height: 1; text-transform: none; letter-spacing: normal; word-wrap: normal; white-space: nowrap; direction: ltr; /* Support for all WebKit browsers. */ -webkit-font-smoothing: antialiased; /* Support for Safari and Chrome. */ text-rendering: optimizeLegibility; /* Support for Firefox. */ -moz-osx-font-smoothing: grayscale; /* Support for IE. */ font-feature-settings: 'liga'; }"},{"title":"","date":"2018-07-05T13:13:26.826Z","updated":"2018-07-05T13:06:25.663Z","comments":true,"path":"js/md+html_complex/demo-configs.js","permalink":"https://www.xunhanliu.top/js/md+html_complex/demo-configs.js","excerpt":"","text":"/** * @fileoverview Synthetic data sets for t-SNE demo and visualizations, * along with some utility functions. */ // Copyright 2018 Google LLC // // Licensed under the Apache License, Version 2.0 (the \"License\"); // you may not use this file except in compliance with the License. // You may obtain a copy of the License at // // http://www.apache.org/licenses/LICENSE-2.0 // // Unless required by applicable law or agreed to in writing, software // distributed under the License is distributed on an \"AS IS\" BASIS, // WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. // See the License for the specific language governing permissions and // limitations under the License. if(typeof require != \"undefined\") { // hack for loading from generator var d3 = require('./d3.min.js') } // Euclidean distance. function dist(a, b) { var d = 0; for (var i = 0; i < a.length; i++) { d += (a[i] - b[i]) * (a[i] - b[i]); } return Math.sqrt(d); } // Gaussian generator, mean = 0, std = 1. var normal = d3.randomNormal(); // Create random Gaussian vector. function normalVector(dim) { var p = []; for (var j = 0; j < dim; j++) { p[j] = normal(); } return p; } // Scale the given vector. function scale(vector, a) { for (var i = 0; i < vector.length; i++) { vector[i] *= a; } } // Add two vectors. function add(a, b) { var n = a.length; var c = []; for (var i = 0; i < n; i++) { c[i] = a[i] + b[i]; } return c; } // A point with color info. var Point = function(coords, color) { this.coords = coords; this.color = color || '#039'; }; // Adds colors to points depending on 2D location of original. function addSpatialColors(points) { var xExtent = d3.extent(points, function(p) {return p.coords[0]}); var yExtent = d3.extent(points, function(p) {return p.coords[1]}); var xScale = d3.scaleLinear().domain(xExtent).range([0, 255]); var yScale = d3.scaleLinear().domain(yExtent).range([0, 255]); points.forEach(function(p) { var c1 = ~~xScale(p.coords[0]); var c2 = ~~yScale(p.coords[1]); p.color = 'rgb(20,' + c1 + ',' + c2 + ')'; }); } // Convenience function to wrap 2d arrays as Points, using a default // color scheme. function makePoints(originals) { var points = originals.map(function(p) {return new Point(p);}); addSpatialColors(points); return points; } // Creates distance matrix for t-SNE input. function distanceMatrix(points) { var matrix = []; var n = points.length; for (var i = 0; i < n; i++) { for (var j = 0; j < n; j++) { matrix.push(dist(points[i].coords, points[j].coords)); } } return matrix; } // Data in shape of 2D grid. function gridData(size) { var points = []; for (var x = 0; x < size; x++) { for (var y = 0; y < size; y++) { points.push([x, y]); } } return makePoints(points); } // Gaussian cloud, symmetric, of given dimension. function gaussianData(n, dim) { var points = []; for (var i = 0; i < n; i++) { var p = normalVector(dim); points.push(new Point(p)); } return points; } // Elongated Gaussian ellipsoid. function longGaussianData(n, dim) { var points = []; for (var i = 0; i < n; i++) { var p = normalVector(dim); for (var j = 0; j < dim; j++) { p[j] /= (1 + j); } points.push(new Point(p)); } return points; } // Return a color for the given angle. function angleColor(t) { var hue = ~~(300 * t / (2 * Math.PI)); return 'hsl(' + hue + ',50%,50%)'; } // Data in a 2D circle, regularly spaced. function circleData(numPoints) { var points = []; for (var i = 0; i < numPoints; i++) { var t = 2 * Math.PI * i / numPoints; points.push(new Point([Math.cos(t), Math.sin(t)], angleColor(t))); } return points; } // Random points on a 2D circle. function randomCircleData(numPoints) { var points = []; for (var i = 0; i < numPoints; i++) { var t = 2 * Math.PI * Math.random(); points.push(new Point([Math.cos(t), Math.sin(t)], angleColor(t))); } return points; } // Clusters arranged in a circle. function randomCircleClusterData(numPoints) { var points = []; for (var i = 0; i < numPoints; i++) { var t = 2 * Math.PI * i / numPoints;//Math.random(); var color = angleColor(t); for (var j = 0; j < 20; j++) { var x = Math.cos(t) + .01 * normal(); var y = Math.sin(t) + .01 * normal(); points.push(new Point([x, y], color)); } } return points; } // Two 2D clusters of different sizes. function twoDifferentClustersData2D(n) { var points = []; for (var i = 0; i < n; i++) { points.push(new Point([10 * normal(), 10 * normal()], '#039')); points.push(new Point([100 + normal(), normal()], '#f90')); } return points; } // Two clusters of the same size. function twoClustersData(n, dim) { dim = dim || 50; var points = []; for (var i = 0; i < n; i++) { points.push(new Point(normalVector(dim), '#039')); var v = normalVector(dim); v[0] += 10; points.push(new Point(v, '#f90')); } return points; } // Two differently sized clusters, of arbitrary dimensions. function twoDifferentClustersData(n, dim, scale) { dim = dim || 50; scale = scale || 10; var points = []; for (var i = 0; i < n; i++) { points.push(new Point(normalVector(dim), '#039')); var v = normalVector(dim); for (var j = 0; j < dim; j++) { v[j] /= scale; } v[0] += 20; points.push(new Point(v, '#f90')); } return points; } // Three clusters, at different distances from each other, in 2D function threeClustersData2d(n) { var points = []; for (var i = 0; i < n; i++) { points.push(new Point([normal(), normal()], '#039')); points.push(new Point([10 + normal(), normal()], '#f90')); points.push(new Point([50 + normal(), normal()], '#6a3')); } return points; } // Three clusters, at different distances from each other, in any dimension. function threeClustersData(n, dim) { dim = dim || 50; var points = []; for (var i = 0; i < n; i++) { var p1 = normalVector(dim); points.push(new Point(p1, '#039')); var p2 = normalVector(dim); p2[0] += 10; points.push(new Point(p2, '#f90')); var p3 = normalVector(dim); p3[0] += 50; points.push(new Point(p3, '#6a3')); } return points; } // One tiny cluster inside of a big cluster. function subsetClustersData(n, dim) { dim = dim || 2; var points = []; for (var i = 0; i < n; i++) { var p1 = normalVector(dim); points.push(new Point(p1, '#039')); var p2 = normalVector(dim); scale(p2, 50); points.push(new Point(p2, '#f90')); } return points; } // Data in a rough simplex. function simplexData(n, noise) { noise = noise || 0.5; var points = []; for (var i = 0; i < n; i++) { var p = []; for (var j = 0; j < n; j++) { p[j] = i == j ? 1 + noise * normal() : 0; } points.push(new Point(p)); } return points; } // Uniform points from a cube. function cubeData(n, dim) { var points = []; for (var i = 0; i < n; i++) { var p = []; for (var j = 0; j < dim; j++) { p[j] = Math.random(); } points.push(new Point(p)); } return points; } // Points in two unlinked rings. function unlinkData(n) { var points = []; function rotate(x, y, z) { var u = x; var cos = Math.cos(.4); var sin = Math.sin(.4); var v = cos * y + sin * z; var w = -sin * y + cos * z; return [u, v, w]; } for (var i = 0; i < n; i++) { var t = 2 * Math.PI * i / n; var sin = Math.sin(t); var cos = Math.cos(t); // Ring 1. points.push(new Point(rotate(cos, sin, 0), '#f90')); // Ring 2. points.push(new Point(rotate(3 + cos, 0, sin), '#039')); } return points; } // Points in linked rings. function linkData(n) { var points = []; function rotate(x, y, z) { var u = x; var cos = Math.cos(.4); var sin = Math.sin(.4); var v = cos * y + sin * z; var w = -sin * y + cos * z; return [u, v, w]; } for (var i = 0; i < n; i++) { var t = 2 * Math.PI * i / n; var sin = Math.sin(t); var cos = Math.cos(t); // Ring 1. points.push(new Point(rotate(cos, sin, 0), '#f90')); // Ring 2. points.push(new Point(rotate(1 + cos, 0, sin), '#039')); } return points; } // Points in a trefoil knot. function trefoilData(n) { var points = []; for (var i = 0; i < n; i++) { var t = 2 * Math.PI * i / n; var x = Math.sin(t) + 2 * Math.sin(2 * t); var y = Math.cos(t) - 2 * Math.cos(2 * t); var z = -Math.sin(3 * t); points.push(new Point([x, y, z], angleColor(t))); } return points; } // Two long, linear clusters in 2D. function longClusterData(n) { var points = []; var s = .03 * n; for (var i = 0; i < n; i++) { var x1 = i + s * normal(); var y1 = i + s * normal(); points.push(new Point([x1, y1], '#039')); var x2 = i + s * normal() + n / 5; var y2 = i + s * normal() - n / 5; points.push(new Point([x2, y2], '#f90')); } return points; } // Mutually orthogonal steps. function orthoCurve(n) { var points = []; for (var i = 0; i < n; i++) { var coords = []; for (var j = 0; j < n; j++) { coords[j] = j < i ? 1 : 0; } var t = 1.5 * Math.PI * i / n; points.push(new Point(coords, angleColor(t))); } return points; } // Random walk function randomWalk(n, dim) { var points = []; var current = []; for (var i = 0; i < dim; i++) { current[i] = 0; } for (var i = 0; i < n; i++) { var step = normalVector(dim); var next = current.slice(); for (var j = 0; j < dim; j++) { next[j] = current[j] + step[j]; } var t = 1.5 * Math.PI * i / n; points.push(new Point(next, angleColor(t))); current = next; } return points; } // Random jump: a random walk with // additional noise added at each step. function randomJump(n, dim) { var points = []; var current = []; for (var i = 0; i < dim; i++) { current[i] = 0; } for (var i = 0; i < n; i++) { var step = normalVector(dim); var next = add(step, current.slice()); var r = normalVector(dim); scale(r, Math.sqrt(dim)); var t = 1.5 * Math.PI * i / n; var coords = add(r, next); points.push(new Point(coords, angleColor(t))); current = next; } return points; } /** * @fileoverview Demo configuration for t-SNE playground. */ var demos = [ { name: 'Grid', description: 'A square grid with equal spacing between points. ' + 'Try convergence at different sizes.', options: [ { name: 'Points Per Side', min: 2, max: 20, start: 10, } ], generator: gridData }, { name: 'Two Clusters', description: 'Two clusters with equal numbers of points.', options: [ { name: 'Points Per Cluster', min: 1, max: 100, start: 50, }, { name: 'Dimensions', min: 1, max: 100, start: 2, } ], generator: twoClustersData }, { name: 'Three Clusters', description: 'Three clusters with equal numbers of points, but at ' + 'different distances from each other. Cluster distances are ' + 'only apparent at certain perplexities', options: [ { name: 'Points Per Cluster', min: 1, max: 100, start: 50, }, { name: 'Dimensions', min: 1, max: 100, start: 2, } ], generator: threeClustersData }, { name: 'Two Different-Sized Clusters', description: 'Two clusters with equal numbers of points, but different ' + 'variances within the clusters. Cluster separation depends on perplexity.', options: [ { name: 'Points Per Cluster', min: 1, max: 100, start: 50, }, { name: 'Dimensions', min: 1, max: 100, start: 2, }, { name: 'Scale', min: 1, max: 10, start: 5, } ], generator: twoDifferentClustersData }, { name: 'Two Long Linear Clusters', description: 'Two sets of points, arranged in parallel lines that ' + 'are close to each other. Note curvature of lines.', options: [ { name: 'Points Per Cluster', min: 1, max: 100, start: 50, } ], generator: longClusterData }, { name: 'Cluster In Cluster', description: 'A dense, tight cluster inside of a wide, sparse cluster. ' + 'Perplexity makes a big difference here.', options: [ { name: 'Points Per Cluster', min: 1, max: 100, start: 50, }, { name: 'Dimensions', min: 1, max: 100, start: 2, } ], generator: subsetClustersData }, { name: 'Circle (Evenly Spaced)', description: 'Points evenly distributed in a circle. ' + 'Hue corresponds to angle in the circle.', options: [ { name: 'Number Of Points', min: 1, max: 100, start: 50, } ], generator: circleData }, { name: 'Circle (Randomly Spaced)', description: 'Points randomly distributed in a circle. ' + 'Hue corresponds to angle in the circle.', options: [ { name: 'Number Of Points', min: 1, max: 100, start: 50, } ], generator: randomCircleData }, { name: 'Gaussian Cloud', description: 'Points in a unit Gaussian distribution. ' + 'Data is entirely random, so any visible subclusters are ' + 'not statistically significant', options: [ { name: 'Number Of Points', min: 1, max: 500, start: 50, }, { name: 'Dimensions', min: 1, max: 100, start: 2, } ], generator: gaussianData }, { name: 'Ellipsoidal Gaussian Cloud', description: 'Points in an ellipsoidal Gaussian distribution. ' + ' Dimension n has variance 1/n. Elongation is visible in plot.', options: [ { name: 'Number Of Points', min: 1, max: 500, start: 50, }, { name: 'Dimensions', min: 1, max: 100, start: 2, } ], generator: longGaussianData }, { name: 'Trefoil Knot', description: 'Points arranged in 3D, following a trefoil knot. ' + 'Different runs may give different results.', options: [ { name: 'Number Of Points', min: 1, max: 200, start: 50, } ], generator: trefoilData }, { name: 'Linked Rings', description: 'Points arranged in 3D, on two linked circles. ' + 'Different runs may give different results.', options: [ { name: 'Number Of Points', min: 1, max: 200, start: 50, } ], generator: linkData }, { name: 'Unlinked Rings', description: 'Points arranged in 3D, on two unlinked circles', options: [ { name: 'Number Of Points', min: 1, max: 200, start: 50, } ], generator: unlinkData }, { name: 'Orthogonal Steps', description: 'Points related by mutually orthogonal steps. ' + 'Very similar to a random walk.', options: [ { name: 'Number Of Points', min: 1, max: 500, start: 50, } ], generator: orthoCurve }, { name: 'Random Walk', description: 'Random (Gaussian) walk. ' + 'Smoother than you might think.', options: [{ name: 'Number Of Points', min: 1, max: 1000, start: 100, }, { name: 'Dimension', min: 1, max: 1000, start: 100, } ], generator: randomWalk }, { name: 'Random Jump', description: 'Random (Gaussian) Jump', options: [ { name: 'Number Of Points', min: 1, max: 1000, start: 100, }, { name: 'Dimension', min: 1, max: 1000, start: 100, } ], generator: randomJump }, { name: 'Equally Spaced', description: 'A set of points, where distances between all pairs of ' + 'points are the same in the original space.', options: [ { name: 'Number Of Points', min: 2, max: 100, start: 50, } ], generator: simplexData }, { name: 'Uniform Distribution', description: 'Points uniformly distributed in a unit cube.', options: [ { name: 'Number Of Points', min: 2, max: 200, start: 50, }, { name: 'Dimensions', min: 1, max: 10, start: 3, } ], generator: cubeData } ]; var demosByName = {} demos.forEach(function(d, i) { d.index = i; demosByName[d.name] = d; }) if(typeof module != \"undefined\") module.exports = { demos: demos, demosByName: demosByName, distanceMatrix: distanceMatrix, Point: Point };"},{"title":"","date":"2018-07-05T13:13:33.697Z","updated":"2018-07-05T13:06:26.122Z","comments":true,"path":"js/md+html_complex/figure-configs.js","permalink":"https://www.xunhanliu.top/js/md+html_complex/figure-configs.js","excerpt":"","text":"var figures = [ { id: \"01\", params: [50, 2], dataset: \"Two Clusters\", no3d: true, examples: [ { id: \"01\", perplexity: 2, epsilon: 10, dim: 2, step: 5000 }, { id: \"02\", perplexity: 5, epsilon: 10, dim: 2, step: 5000 }, { id: \"03\", perplexity: 30, epsilon: 10, dim: 2, step: 5000 }, { id: \"04\", perplexity: 50, epsilon: 10, dim: 2, step: 5000 }, { id: \"05\", perplexity: 100, epsilon: 10, dim: 2, step: 5000 }, ] }, { id: \"02\", params: [50, 2], dataset: \"Two Clusters\", no3d: true, examples: [ { id: \"01\", perplexity: 30, epsilon: 10, dim: 2, step: 10 }, { id: \"02\", perplexity: 30, epsilon: 10, dim: 2, step: 20 }, { id: \"03\", perplexity: 30, epsilon: 10, dim: 2, step: 60}, { id: \"04\", perplexity: 30, epsilon: 10, dim: 2, step: 120 }, { id: \"05\", perplexity: 30, epsilon: 10, dim: 2, step: 1000 }, ] }, { id: \"03\", params: [75, 2], dataset: 'Two Different-Sized Clusters', no3d: true, examples: [ { id: \"01\", perplexity: 2, epsilon: 10, dim: 2, step: 5000 }, { id: \"02\", perplexity: 5, epsilon: 10, dim: 2, step: 5000 }, { id: \"03\", perplexity: 30, epsilon: 10, dim: 2, step: 5000 }, { id: \"04\", perplexity: 50, epsilon: 10, dim: 2, step: 5000 }, { id: \"05\", perplexity: 100, epsilon: 10, dim: 2, step: 5000 }, ] }, { id: \"04\", params: [50, 2], dataset: 'Three Clusters', no3d: true, examples: [ { id: \"01\", perplexity: 2, epsilon: 10, dim: 2, step: 5000 }, { id: \"02\", perplexity: 5, epsilon: 10, dim: 2, step: 5000 }, { id: \"03\", perplexity: 30, epsilon: 10, dim: 2, step: 5000 }, { id: \"04\", perplexity: 50, epsilon: 10, dim: 2, step: 5000 }, { id: \"05\", perplexity: 100, epsilon: 10, dim: 2, step: 5000 }, ] }, { id: \"05\", params: [200, 2], dataset: 'Three Clusters', no3d: true, examples: [ { id: \"01\", perplexity: 2, epsilon: 10, dim: 2, step: 5000 }, { id: \"02\", perplexity: 5, epsilon: 10, dim: 2, step: 5000 }, { id: \"03\", perplexity: 30, epsilon: 10, dim: 2, step: 5000 }, { id: \"04\", perplexity: 50, epsilon: 10, dim: 2, step: 5000 }, { id: \"05\", perplexity: 100, epsilon: 10, dim: 2, step: 5000 }, ] }, { id: \"06\", params: [500, 100], dataset: 'Gaussian Cloud', no3d: true, examples: [ { id: \"01\", perplexity: 2, epsilon: 10, dim: 2, step: 5000 }, { id: \"02\", perplexity: 5, epsilon: 10, dim: 2, step: 5000 }, { id: \"03\", perplexity: 30, epsilon: 10, dim: 2, step: 5000 }, { id: \"04\", perplexity: 50, epsilon: 10, dim: 2, step: 5000 }, { id: \"05\", perplexity: 100, epsilon: 10, dim: 2, step: 5000 }, ] }, { id: \"07\", params: [100, 50], dataset: 'Ellipsoidal Gaussian Cloud', no3d: true, examples: [ { id: \"01\", perplexity: 2, epsilon: 10, dim: 2, step: 5000 }, { id: \"02\", perplexity: 5, epsilon: 10, dim: 2, step: 5000 }, { id: \"03\", perplexity: 30, epsilon: 10, dim: 2, step: 5000 }, { id: \"04\", perplexity: 50, epsilon: 10, dim: 2, step: 5000 }, { id: \"05\", perplexity: 100, epsilon: 10, dim: 2, step: 5000 }, ] }, { id: \"08\", params: [75, 2], dataset: 'Two Long Linear Clusters', no3d: true, examples: [ { id: \"01\", perplexity: 2, epsilon: 10, dim: 2, step: 5000 }, { id: \"02\", perplexity: 5, epsilon: 10, dim: 2, step: 5000 }, { id: \"03\", perplexity: 30, epsilon: 10, dim: 2, step: 5000 }, { id: \"04\", perplexity: 50, epsilon: 10, dim: 2, step: 5000 }, { id: \"05\", perplexity: 100, epsilon: 10, dim: 2, step: 5000 }, ] }, { id: \"09\", params: [75, 50], dataset: 'Cluster In Cluster', no3d: true, examples: [ { id: \"01\", perplexity: 2, epsilon: 10, dim: 2, step: 5000 }, { id: \"02\", perplexity: 5, epsilon: 10, dim: 2, step: 5000 }, { id: \"03\", perplexity: 30, epsilon: 10, dim: 2, step: 5000 }, { id: \"04\", perplexity: 50, epsilon: 10, dim: 2, step: 5000 }, { id: \"05\", perplexity: 100, epsilon: 10, dim: 2, step: 5000 }, ] }, { id: \"10\", params: [100], dataset: 'Linked Rings', no3d: false, examples: [ { id: \"01\", perplexity: 2, epsilon: 10, dim: 2, step: 5000 }, { id: \"02\", perplexity: 5, epsilon: 10, dim: 2, step: 5000 }, { id: \"03\", perplexity: 30, epsilon: 10, dim: 2, step: 5000 }, { id: \"04\", perplexity: 50, epsilon: 10, dim: 2, step: 5000 }, { id: \"05\", perplexity: 100, epsilon: 10, dim: 2, step: 5000 }, ] }, { id: \"11\", params: [150], dataset: 'Trefoil Knot', no3d: false, examples: [ { id: \"01\", perplexity: 2, epsilon: 10, dim: 2, step: 5000 }, { id: \"02\", perplexity: 5, epsilon: 10, dim: 2, step: 5000 }, { id: \"03\", perplexity: 30, epsilon: 10, dim: 2, step: 5000 }, { id: \"04\", perplexity: 50, epsilon: 10, dim: 2, step: 5000 }, { id: \"05\", perplexity: 100, epsilon: 10, dim: 2, step: 5000 }, ] }, { id: \"12\", params: [100], dataset: 'Trefoil Knot', no3d: false, examples: [ { id: \"01\", perplexity: 2, epsilon: 10, dim: 2, step: 5000 }, { id: \"02\", perplexity: 2, epsilon: 10, dim: 2, step: 5000 }, { id: \"03\", perplexity: 2, epsilon: 10, dim: 2, step: 5000 }, { id: \"04\", perplexity: 2, epsilon: 10, dim: 2, step: 5000 }, { id: \"05\", perplexity: 2, epsilon: 10, dim: 2, step: 5000 }, ] }, { id: \"13\", params: [100], dataset: 'Trefoil Knot', no3d: false, examples: [ { id: \"01\", perplexity: 50, epsilon: 10, dim: 2, step: 5000 }, { id: \"02\", perplexity: 50, epsilon: 10, dim: 2, step: 5000 }, { id: \"03\", perplexity: 50, epsilon: 10, dim: 2, step: 5000 }, { id: \"04\", perplexity: 50, epsilon: 10, dim: 2, step: 5000 }, { id: \"05\", perplexity: 50, epsilon: 10, dim: 2, step: 5000 }, ] }, ] if(typeof module != \"undefined\") module.exports = figures;"},{"title":"","date":"2018-07-05T13:13:26.775Z","updated":"2018-07-05T13:06:26.594Z","comments":true,"path":"js/md+html_complex/figures.js","permalink":"https://www.xunhanliu.top/js/md+html_complex/figures.js","excerpt":"","text":"/* Configurations and utility functions for figures */ // Copyright 2018 Google LLC // // Licensed under the Apache License, Version 2.0 (the \"License\"); // you may not use this file except in compliance with the License. // You may obtain a copy of the License at // // http://www.apache.org/licenses/LICENSE-2.0 // // Unless required by applicable law or agreed to in writing, software // distributed under the License is distributed on an \"AS IS\" BASIS, // WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. // See the License for the specific language governing permissions and // limitations under the License. if(typeof require != \"undefined\") { // hack for loading from generator var d3 = require('./d3.min.js') var visualize = require('./visualize.js').visualize var tsnejs = require('./tsne.js') var demoConfigs = require('./demo-configs.js') var distanceMatrix = demoConfigs.distanceMatrix var Point = demoConfigs.Point } var FIGURES = { width: 150, height: 150, downscaleWidth: 300, downscaleHeight: 300, } function getPoints(demo, params) { if(!params) { params = [demo.options[0].start] if(demo.options[1]) params.push(demo.options[1].start) } var points = demo.generator.apply(null, params); return points; } function renderDemoInitial(demo, params, canvas) { visualize(points, canvas, null, null) } /* var demoTimescale = d3.scaleLinear() .domain([0, 200, 6000]) .range([20, 10, 0]) */ var timescale = d3.scaleLinear() .domain([0, 20, 50, 100, 200, 6000]) .range([60, 30, 20, 10, 0]); function demoMaker(points, canvas, options, stepCb) { var demo = {}; var paused = false; var step = 0; var chunk = 1; var frameId; var tsne = new tsnejs.tSNE(options); var dists = distanceMatrix(points); tsne.initDataDist(dists); function iterate() { if(paused) return; // control speed at which we iterate if(step >= 200) chunk = 10; for(var k = 0; k < chunk; k++) { tsne.step(); ++step; } //inform the caller about the current step stepCb(step) // update the solution and render var solution = tsne.getSolution().map(function(coords, i) { return new Point(coords, points[i].color); }); visualize(solution, canvas, \"\"); //removed message //control the loop. var timeout = timescale(step) setTimeout(function() { frameId = window.requestAnimationFrame(iterate); }, timeout) } demo.pause = function() { if(paused) return; // already paused paused = true; window.cancelAnimationFrame(frameId) } demo.unpause = function() { if(!paused) return; // already unpaused paused = false; iterate(); } demo.paused = function() { return paused; } demo.destroy = function() { demo.pause(); delete demo; } iterate(); return demo; } function runDemoSync(points, canvas, options, stepLimit, no3d) { var tsne = new tsnejs.tSNE(options); var dists = distanceMatrix(points); tsne.initDataDist(dists); var step = 0; for(var k = 0; k < stepLimit; k++) { if(k % 100 === 0) console.log(\"step\", step) tsne.step(); ++step; } var solution = tsne.getSolution().map(function(coords, i) { return new Point(coords, points[i].color); }); visualize(solution, canvas, \"\", no3d); //removed message return step; } if(typeof module != \"undefined\") module.exports = { demoMaker: demoMaker, runDemoSync: runDemoSync, getPoints: getPoints, FIGURES: FIGURES }"},{"title":"","date":"2018-07-05T13:13:26.814Z","updated":"2018-07-05T13:06:27.132Z","comments":true,"path":"js/md+html_complex/playground.js","permalink":"https://www.xunhanliu.top/js/md+html_complex/playground.js","excerpt":"","text":"/** * @fileoverview Demo that helps explain what t-SNE is doing. * In particular, shows how various geometries translate to a 2D map, * and lets you play with the perplexity hyperparameter. * * None of this is optimized code, because it doesn't seem necessary * for the small cases we're considering. */ // Copyright 2018 Google LLC // // Licensed under the Apache License, Version 2.0 (the \"License\"); // you may not use this file except in compliance with the License. // You may obtain a copy of the License at // // http://www.apache.org/licenses/LICENSE-2.0 // // Unless required by applicable law or agreed to in writing, software // distributed under the License is distributed on an \"AS IS\" BASIS, // WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. // See the License for the specific language governing permissions and // limitations under the License. // Global variable for whether we should keep optimizing. var playgroundThread = 0; var GLOBALS = { playgroundDemo: null, // the object to control running the playground simulation trayDemo: null, // the object to control running the tray simulation running: true, unpausedBefore: false, stepLimit: 5000, state: {}, showDemo: null, perplexitySlider: null, epsilonSlider: null, } main(); // Main entry point. function main() { // Set state from hash. var format = d3.format(\",\"); function setStateFromParams() { var params = {}; window.location.hash.substring(1).split('&').forEach(function(p) { var tokens = p.split('='); params[tokens[0]] = tokens[1]; }); function getParam(key, fallback) { return params[key] === undefined ? fallback : params[key]; } GLOBALS.state = { perplexity: +getParam('perplexity', 10), epsilon: +getParam('epsilon', 5), demo: +getParam('demo', 0), demoParams: getParam('demoParams', '20,2').split(',').map(Number) }; } setStateFromParams(); // Utility function for creating value sliders. function makeSlider(container, name, min, max, start) { var dis = d3.select(container) dis.append(\"span\").classed(\"slider-label-\" + name, true) .text(name + ' ') var value = dis.append(\"span\").classed(\"slider-value-\" + name, true) .text(start) var slider = dis.append(\"input\") .attr(\"type\", \"range\") .attr(\"min\", min) .attr(\"max\", max) .attr(\"value\", start) .on(\"change\", updateParameters) .on(\"input\", function() { value.text(slider.node().value); }) return slider.node(); } // Create menu of possible demos. var menuDiv = d3.select(\"#data-menu\"); var dataMenus = menuDiv.selectAll(\".demo-data\") .data(demos) .enter().append(\"div\") .classed(\"demo-data\", true) .on(\"click\", function(d,i) { showDemo(i); }); dataMenus.append(\"canvas\") .attr(\"width\", 150) .attr(\"height\", 150) .each(function(d,i) { var demo = demos[i]; var params = [demo.options[0].start] if(demo.options[1]) params.push(demo.options[1].start) var points = demo.generator.apply(null, params); var canvas = d3.select(this).node() visualize(points, canvas, null, null) }); dataMenus.append(\"span\") .text(function(d) { return d.name}); // Set up t-SNE UI. var tsneUI = document.getElementById('tsne-options'); var perplexitySlider = makeSlider(tsneUI, 'Perplexity', 2, 100, GLOBALS.state.perplexity); var epsilonSlider = makeSlider(tsneUI, 'Epsilon', 1, 20, GLOBALS.state.epsilon); GLOBALS.perplexitySlider = perplexitySlider GLOBALS.epsilonSlider = epsilonSlider // Controls for data options. var optionControls; var demo; function updateParameters() { GLOBALS.state.demoParams = optionControls.map(function(s) {return s.value;}); GLOBALS.state.perplexity = perplexitySlider.value; GLOBALS.state.epsilon = epsilonSlider.value; d3.select(\"#share\").style(\"display\", \"\") .attr(\"href\", \"#\" + generateHash()) runState(); } function generateHash() { function stringify(map) { var s = ''; for (key in map) { s += '&' + key + '=' + map[key]; } return s.substring(1); } //window.location.hash = stringify(GLOBALS.state); return stringify(GLOBALS.state); } function runState() { // Set up t-SNE and start it running. var points = demo.generator.apply(null, GLOBALS.state.demoParams); var canvas = document.getElementById('output'); // if there was already a playground demo going, lets destroy it and make a new one if(GLOBALS.playgroundDemo) { GLOBALS.playgroundDemo.destroy(); delete GLOBALS.playgroundDemo; } //runPlayground(points, canvas, GLOBALS.state, function(step) { GLOBALS.playgroundDemo = demoMaker(points, canvas, GLOBALS.state, function(step) { d3.select(\"#step\").text(format(step)); if(step >= GLOBALS.stepLimit && !GLOBALS.unpausedBefore) { setRunning(false) } }) GLOBALS.unpausedBefore = false; setRunning(true); } var playPause = document.getElementById('play-pause'); function setRunning(r) { GLOBALS.running = r; GLOBALS.playgroundRunning = r; if (GLOBALS.running) { GLOBALS.playgroundDemo.unpause(); playPause.setAttribute(\"class\", \"playing\") } else { GLOBALS.playgroundDemo.pause(); playPause.setAttribute(\"class\", \"paused\") } } // Hook up play / pause / restart buttons. playPause.onclick = function() { GLOBALS.unpausedBefore = true; setRunning(!GLOBALS.running); }; document.getElementById('restart').onclick = updateParameters; // Show a given demo. GLOBALS.showDemo = showDemo; function showDemo(index, initializeFromState) { GLOBALS.state.demo = index; demo = demos[index]; // Show description of demo data. //document.querySelector('#data-description span').textContent = demo.description; d3.select(\"#data-description span\").text(demo.description) // Create UI for the demo data options. var dataOptionsArea = document.getElementById('data-options'); dataOptionsArea.innerHTML = ''; optionControls = demo.options.map(function(option, i) { var value = initializeFromState ? GLOBALS.state.demoParams[i] : option.start; return makeSlider(dataOptionsArea, option.name, option.min, option.max, value); }); menuDiv.selectAll(\".demo-data\") .classed(\"selected\", false) .filter(function(d,i) { return i === index }) .classed(\"selected\", true) updateParameters(); } // run initial demo; setTimeout(function() { showDemo(GLOBALS.state.demo, true); // hide the share link initially d3.select(\"#share\").style(\"display\", \"none\") },1); d3.select(window).on(\"popstate\", function() { setTimeout(function() { //updateParameters(); setStateFromParams(); showDemo(GLOBALS.state.demo, true) },1) }) d3.select(window).on(\"scroll.playground\", function() { if(scrollY > 1000) { if(GLOBALS.playgroundRunning) { setRunning(false); } } else { if(!GLOBALS.playgroundRunning) { // setRunning(true) } } }) }"},{"title":"","date":"2018-07-05T13:13:26.735Z","updated":"2018-07-05T13:06:24.856Z","comments":true,"path":"js/md+html_complex/tsne.js","permalink":"https://www.xunhanliu.top/js/md+html_complex/tsne.js","excerpt":"","text":"'use strict'; /** @license * The MIT License (MIT) * Copyright (c) 2015 Andrej Karpathy * Permission is hereby granted, free of charge, to any person obtaining a copy * of this software and associated documentation files (the \"Software\"), to deal * in the Software without restriction, including without limitation the rights * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell * copies of the Software, and to permit persons to whom the Software is * furnished to do so, subject to the following conditions: * * The above copyright notice and this permission notice shall be included in * all copies or substantial portions of the Software. * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN * THE SOFTWARE. */ //goog.provide('tsnejs'); /** * @type {string} */ //tsnejs.REVISION = 'ALPHA'; var tsnejs = {} // utility function var assert = function(condition, message) { if (!condition) { throw message || 'Assertion failed'; } }; // syntax sugar var getopt = function(opt, field, defaultval) { if (opt.hasOwnProperty(field)) { return opt[field]; } else { return defaultval; } }; // return 0 mean unit standard deviation random number var return_v = false; var v_val = 0.0; var gaussRandom = function(rng) { if (return_v) { return_v = false; return v_val; } var u = 2 * rng() - 1; var v = 2 * rng() - 1; var r = u * u + v * v; if (r == 0 || r > 1) return gaussRandom(rng); var c = Math.sqrt(-2 * Math.log(r) / r); v_val = v * c; // cache this for next function call for efficiency return_v = true; return u * c; }; // return random normal number var randn = function(rng, mu, std) { return mu + gaussRandom(rng) * std; }; // utilitity that creates contiguous vector of zeros of size n var zeros = function(n) { if (typeof(n) === 'undefined' || isNaN(n)) { return []; } if (typeof ArrayBuffer === 'undefined') { // lacking browser support var arr = new Array(n); for (var i = 0; i < n; i++) { arr[i] = 0; } return arr; } else { return new Float64Array(n); // typed arrays are faster } }; // utility that returns 2d array filled with random numbers from generator rng var randn2d = function(n, d, rng) { var x = []; for (var i = 0; i < n; i++) { var xhere = []; for (var j = 0; j < d; j++) { xhere.push(randn(rng, 0.0, 1e-4)); } x.push(xhere); } return x; }; // utility that returns 2d array filled with value s var arrayofs = function(n, d, s) { var x = []; for (var i = 0; i < n; i++) { var xhere = []; for (var j = 0; j < d; j++) { xhere.push(s); } x.push(xhere); } return x; }; // compute L2 distance between two vectors var L2 = function(x1, x2) { var D = x1.length; var d = 0; for (var i = 0; i < D; i++) { var x1i = x1[i]; var x2i = x2[i]; d += (x1i - x2i) * (x1i - x2i); } return d; }; // compute pairwise distance in all vectors in X var xtod = function(X) { var N = X.length; var dist = zeros(N * N); // allocate contiguous array for (var i = 0; i < N; i++) { for (var j = i + 1; j < N; j++) { var d = L2(X[i], X[j]); dist[i * N + j] = d; dist[j * N + i] = d; } } return dist; }; // compute (p_{i|j} + p_{j|i})/(2n) var d2p = function(D, perplexity, tol) { var Nf = Math.sqrt(D.length); // this better be an integer var N = Math.floor(Nf); assert(N === Nf, 'D should have square number of elements.'); var Htarget = Math.log(perplexity); // target entropy of distribution var P = zeros(N * N); // temporary probability matrix var prow = zeros(N); // a temporary storage compartment for (var i = 0; i < N; i++) { var betamin = -Infinity; var betamax = Infinity; var beta = 1; // initial value of precision var done = false; var maxtries = 50; // perform binary search to find a suitable precision beta // so that the entropy of the distribution is appropriate var num = 0; while (!done) { //debugger; // compute entropy and kernel row with beta precision var psum = 0.0; for (var j = 0; j < N; j++) { var pj = Math.exp(- D[i * N + j] * beta); if (i === j) { pj = 0; } // we dont care about diagonals prow[j] = pj; psum += pj; } // normalize p and compute entropy var Hhere = 0.0; for (var j = 0; j < N; j++) { var pj = prow[j] / psum; prow[j] = pj; if (pj > 1e-7) Hhere -= pj * Math.log(pj); } // adjust beta based on result if (Hhere > Htarget) { // entropy was too high (distribution too diffuse) // so we need to increase the precision for more peaky distribution betamin = beta; // move up the bounds if (betamax === Infinity) { beta = beta * 2; } else { beta = (beta + betamax) / 2; } } else { // converse case. make distrubtion less peaky betamax = beta; if (betamin === -Infinity) { beta = beta / 2; } else { beta = (beta + betamin) / 2; } } // stopping conditions: too many tries or got a good precision num++; if (Math.abs(Hhere - Htarget) < tol) { done = true; } if (num >= maxtries) { done = true; } } // copy over the final prow to P at row i for (var j = 0; j < N; j++) { P[i * N + j] = prow[j]; } } // end loop over examples i // symmetrize P and normalize it to sum to 1 over all ij var Pout = zeros(N * N); var N2 = N * 2; for (var i = 0; i < N; i++) { for (var j = 0; j < N; j++) { Pout[i * N + j] = Math.max((P[i * N + j] + P[j * N + i]) / N2, 1e-100); } } return Pout; }; // helper function function sign(x) { return x > 0 ? 1 : x < 0 ? -1 : 0; } /** * @param {?Object} opt Options. * @constructor */ var tSNE = function(opt) { opt = opt || {}; this.perplexity = getopt(opt, 'perplexity', 30); this.dim = getopt(opt, 'dim', 2); // by default 2-D tSNE this.epsilon = getopt(opt, 'epsilon', 10); // learning rate this.rng = getopt(opt, 'rng', Math.random); this.iter = 0; }; tSNE.prototype = { // this function takes a set of high-dimensional points // and creates matrix P from them using gaussian kernel initDataRaw: function(X) { var N = X.length; var D = X[0].length; assert(N > 0, ' X is empty? You must have some data!'); assert(D > 0, ' X[0] is empty? Where is the data?'); var dists = xtod(X); // convert X to distances using gaussian kernel this.P = d2p(dists, this.perplexity, 1e-4); // attach to object this.N = N; // back up the size of the dataset this.initSolution(); // refresh this }, // this function takes a fattened distance matrix and creates // matrix P from them. // D is assumed to be provided as an array of size N^2. initDataDist: function(D) { var N = Math.sqrt(D.length); this.P = d2p(D, this.perplexity, 1e-4); this.N = N; this.initSolution(); // refresh this }, // (re)initializes the solution to random initSolution: function() { // generate random solution to t-SNE this.Y = randn2d(this.N, this.dim, this.rng); // the solution this.gains = arrayofs(this.N, this.dim, 1.0); // step gains // to accelerate progress in unchanging directions this.ystep = arrayofs(this.N, this.dim, 0.0); // momentum accumulator this.iter = 0; }, // return pointer to current solution getSolution: function() { return this.Y; }, // perform a single step of optimization to improve the embedding step: function() { this.iter += 1; var N = this.N; var cg = this.costGrad(this.Y); // evaluate gradient var cost = cg.cost; var grad = cg.grad; // perform gradient step var ymean = zeros(this.dim); for (var i = 0; i < N; i++) { for (var d = 0; d < this.dim; d++) { var gid = grad[i][d]; var sid = this.ystep[i][d]; var gainid = this.gains[i][d]; // compute gain update var newgain = sign(gid) === sign(sid) ? gainid * 0.8 : gainid + 0.2; if (newgain < 0.01) newgain = 0.01; // clamp this.gains[i][d] = newgain; // store for next turn // compute momentum step direction var momval = this.iter < 250 ? 0.5 : 0.8; var newsid = momval * sid - this.epsilon * newgain * grad[i][d]; this.ystep[i][d] = newsid; // remember the step we took // step! this.Y[i][d] += newsid; ymean[d] += this.Y[i][d]; // accumulate mean so that we // can center later } } // reproject Y to be zero mean for (var i = 0; i < N; i++) { for (var d = 0; d < this.dim; d++) { this.Y[i][d] -= ymean[d] / N; } } //if(this.iter%100===0) console.log('iter ' + this.iter + ', //cost: ' + cost); return cost; // return current cost }, // for debugging: gradient check debugGrad: function() { var N = this.N; var cg = this.costGrad(this.Y); // evaluate gradient var cost = cg.cost; var grad = cg.grad; var e = 1e-5; for (var i = 0; i < N; i++) { for (var d = 0; d < this.dim; d++) { var yold = this.Y[i][d]; this.Y[i][d] = yold + e; var cg0 = this.costGrad(this.Y); this.Y[i][d] = yold - e; var cg1 = this.costGrad(this.Y); var analytic = grad[i][d]; var numerical = (cg0.cost - cg1.cost) / (2 * e); console.log(i + ',' + d + ': gradcheck analytic: ' + analytic + ' vs. numerical: ' + numerical); this.Y[i][d] = yold; } } }, // return cost and gradient, given an arrangement costGrad: function(Y) { var N = this.N; var dim = this.dim; // dim of output space var P = this.P; var pmul = this.iter < 100 ? 4 : 1; // trick that helps with local optima // compute current Q distribution, unnormalized first var Qu = zeros(N * N); var qsum = 0.0; for (var i = 0; i < N; i++) { for (var j = i + 1; j < N; j++) { var dsum = 0.0; for (var d = 0; d < dim; d++) { var dhere = Y[i][d] - Y[j][d]; dsum += dhere * dhere; } var qu = 1.0 / (1.0 + dsum); // Student t-distribution Qu[i * N + j] = qu; Qu[j * N + i] = qu; qsum += 2 * qu; } } var cost = 0.0; var grad = []; for (var i = 0; i < N; i++) { var gsum = new Array(dim); // init grad for point i for (var d = 0; d < dim; d++) { gsum[d] = 0.0; } for (var j = 0; j < N; j++) { var normedProb = Math.max(Qu[i * N + j] / qsum, 1e-100); cost += - P[i * N + j] * Math.log(normedProb); // accumulate cost var premult = 4 * (pmul * P[i * N + j] - normedProb) * Qu[i * N + j]; for (var d = 0; d < dim; d++) { gsum[d] += premult * (Y[i][d] - Y[j][d]); } } grad.push(gsum); } return {cost: cost, grad: grad}; } }; tsnejs.tSNE = tSNE; // export tSNE class if(typeof module != \"undefined\") module.exports = tsnejs"},{"title":"","date":"2018-07-05T13:13:26.799Z","updated":"2018-07-05T13:06:26.581Z","comments":true,"path":"js/md+html_complex/visualize.js","permalink":"https://www.xunhanliu.top/js/md+html_complex/visualize.js","excerpt":"","text":"// Copyright 2018 Google LLC // // Licensed under the Apache License, Version 2.0 (the \"License\"); // you may not use this file except in compliance with the License. // You may obtain a copy of the License at // // http://www.apache.org/licenses/LICENSE-2.0 // // Unless required by applicable law or agreed to in writing, software // distributed under the License is distributed on an \"AS IS\" BASIS, // WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. // See the License for the specific language governing permissions and // limitations under the License. if(typeof require != \"undefined\") { // hack for loading from generator var d3 = require('./d3.min.js') } // Helper function to draw a circle. // TODO: replace with canvas blitting for web rendering function circle(g, x, y, r) { g.beginPath(); g.arc(x, y, r, 0, 2 * Math.PI); g.fill(); g.stroke(); } // Visualize the given points with the given message. // If \"no3d\" is set, ignore the 3D cue for size. function visualize(points, canvas, message, no3d) { var width = canvas.width; var height = canvas.height; var g = canvas.getContext('2d'); g.fillStyle = 'white'; g.fillRect(0, 0, width, height); var xExtent = d3.extent(points, function(p) {return p.coords[0]}); var yExtent = d3.extent(points, function(p) {return p.coords[1]}); var zExtent = d3.extent(points, function(p) {return p.coords[2]}); var zScale = d3.scaleLinear().domain(zExtent).range([2, 10]); var centerX = (xExtent[0] + xExtent[1]) / 2; var centerY = (yExtent[0] + yExtent[1]) / 2; var scale = Math.min(width, height) / Math.max(xExtent[1] - xExtent[0], yExtent[1] - yExtent[0]); scale *= .9; // Leave a little margin. g.strokeStyle = 'rgba(255,255,255,.5)'; var is3d = !no3d && points[0].coords.length > 2; var index = []; var n = points.length; if (is3d) { for (var i = 0; i < n; i++) { index[i] = i; } index.sort(function(a, b) { return d3.ascending(points[a].coords[2], points[b].coords[2]); }); } for (var i = 0; i < n; i++) { var p = is3d ? points[index[i]] : points[i]; g.fillStyle = p.color; var x = (p.coords[0] - centerX) * scale + width / 2; var y = -(p.coords[1] - centerY) * scale + height / 2; var r = is3d ? zScale(p.coords[2]) : 4; circle(g, x, y, r); } if (message) { g.fillStyle = '#000'; g.font = '24pt Lato'; g.fillText(message, 8, 34); } } if(typeof module != \"undefined\") module.exports = { visualize: visualize }"},{"title":"","date":"2018-07-05T13:13:26.826Z","updated":"2018-07-05T13:06:25.663Z","comments":true,"path":"js/tsne-how_use/demo-configs.js","permalink":"https://www.xunhanliu.top/js/tsne-how_use/demo-configs.js","excerpt":"","text":"/** * @fileoverview Synthetic data sets for t-SNE demo and visualizations, * along with some utility functions. */ // Copyright 2018 Google LLC // // Licensed under the Apache License, Version 2.0 (the \"License\"); // you may not use this file except in compliance with the License. // You may obtain a copy of the License at // // http://www.apache.org/licenses/LICENSE-2.0 // // Unless required by applicable law or agreed to in writing, software // distributed under the License is distributed on an \"AS IS\" BASIS, // WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. // See the License for the specific language governing permissions and // limitations under the License. if(typeof require != \"undefined\") { // hack for loading from generator var d3 = require('./d3.min.js') } // Euclidean distance. function dist(a, b) { var d = 0; for (var i = 0; i < a.length; i++) { d += (a[i] - b[i]) * (a[i] - b[i]); } return Math.sqrt(d); } // Gaussian generator, mean = 0, std = 1. var normal = d3.randomNormal(); // Create random Gaussian vector. function normalVector(dim) { var p = []; for (var j = 0; j < dim; j++) { p[j] = normal(); } return p; } // Scale the given vector. function scale(vector, a) { for (var i = 0; i < vector.length; i++) { vector[i] *= a; } } // Add two vectors. function add(a, b) { var n = a.length; var c = []; for (var i = 0; i < n; i++) { c[i] = a[i] + b[i]; } return c; } // A point with color info. var Point = function(coords, color) { this.coords = coords; this.color = color || '#039'; }; // Adds colors to points depending on 2D location of original. function addSpatialColors(points) { var xExtent = d3.extent(points, function(p) {return p.coords[0]}); var yExtent = d3.extent(points, function(p) {return p.coords[1]}); var xScale = d3.scaleLinear().domain(xExtent).range([0, 255]); var yScale = d3.scaleLinear().domain(yExtent).range([0, 255]); points.forEach(function(p) { var c1 = ~~xScale(p.coords[0]); var c2 = ~~yScale(p.coords[1]); p.color = 'rgb(20,' + c1 + ',' + c2 + ')'; }); } // Convenience function to wrap 2d arrays as Points, using a default // color scheme. function makePoints(originals) { var points = originals.map(function(p) {return new Point(p);}); addSpatialColors(points); return points; } // Creates distance matrix for t-SNE input. function distanceMatrix(points) { var matrix = []; var n = points.length; for (var i = 0; i < n; i++) { for (var j = 0; j < n; j++) { matrix.push(dist(points[i].coords, points[j].coords)); } } return matrix; } // Data in shape of 2D grid. function gridData(size) { var points = []; for (var x = 0; x < size; x++) { for (var y = 0; y < size; y++) { points.push([x, y]); } } return makePoints(points); } // Gaussian cloud, symmetric, of given dimension. function gaussianData(n, dim) { var points = []; for (var i = 0; i < n; i++) { var p = normalVector(dim); points.push(new Point(p)); } return points; } // Elongated Gaussian ellipsoid. function longGaussianData(n, dim) { var points = []; for (var i = 0; i < n; i++) { var p = normalVector(dim); for (var j = 0; j < dim; j++) { p[j] /= (1 + j); } points.push(new Point(p)); } return points; } // Return a color for the given angle. function angleColor(t) { var hue = ~~(300 * t / (2 * Math.PI)); return 'hsl(' + hue + ',50%,50%)'; } // Data in a 2D circle, regularly spaced. function circleData(numPoints) { var points = []; for (var i = 0; i < numPoints; i++) { var t = 2 * Math.PI * i / numPoints; points.push(new Point([Math.cos(t), Math.sin(t)], angleColor(t))); } return points; } // Random points on a 2D circle. function randomCircleData(numPoints) { var points = []; for (var i = 0; i < numPoints; i++) { var t = 2 * Math.PI * Math.random(); points.push(new Point([Math.cos(t), Math.sin(t)], angleColor(t))); } return points; } // Clusters arranged in a circle. function randomCircleClusterData(numPoints) { var points = []; for (var i = 0; i < numPoints; i++) { var t = 2 * Math.PI * i / numPoints;//Math.random(); var color = angleColor(t); for (var j = 0; j < 20; j++) { var x = Math.cos(t) + .01 * normal(); var y = Math.sin(t) + .01 * normal(); points.push(new Point([x, y], color)); } } return points; } // Two 2D clusters of different sizes. function twoDifferentClustersData2D(n) { var points = []; for (var i = 0; i < n; i++) { points.push(new Point([10 * normal(), 10 * normal()], '#039')); points.push(new Point([100 + normal(), normal()], '#f90')); } return points; } // Two clusters of the same size. function twoClustersData(n, dim) { dim = dim || 50; var points = []; for (var i = 0; i < n; i++) { points.push(new Point(normalVector(dim), '#039')); var v = normalVector(dim); v[0] += 10; points.push(new Point(v, '#f90')); } return points; } // Two differently sized clusters, of arbitrary dimensions. function twoDifferentClustersData(n, dim, scale) { dim = dim || 50; scale = scale || 10; var points = []; for (var i = 0; i < n; i++) { points.push(new Point(normalVector(dim), '#039')); var v = normalVector(dim); for (var j = 0; j < dim; j++) { v[j] /= scale; } v[0] += 20; points.push(new Point(v, '#f90')); } return points; } // Three clusters, at different distances from each other, in 2D function threeClustersData2d(n) { var points = []; for (var i = 0; i < n; i++) { points.push(new Point([normal(), normal()], '#039')); points.push(new Point([10 + normal(), normal()], '#f90')); points.push(new Point([50 + normal(), normal()], '#6a3')); } return points; } // Three clusters, at different distances from each other, in any dimension. function threeClustersData(n, dim) { dim = dim || 50; var points = []; for (var i = 0; i < n; i++) { var p1 = normalVector(dim); points.push(new Point(p1, '#039')); var p2 = normalVector(dim); p2[0] += 10; points.push(new Point(p2, '#f90')); var p3 = normalVector(dim); p3[0] += 50; points.push(new Point(p3, '#6a3')); } return points; } // One tiny cluster inside of a big cluster. function subsetClustersData(n, dim) { dim = dim || 2; var points = []; for (var i = 0; i < n; i++) { var p1 = normalVector(dim); points.push(new Point(p1, '#039')); var p2 = normalVector(dim); scale(p2, 50); points.push(new Point(p2, '#f90')); } return points; } // Data in a rough simplex. function simplexData(n, noise) { noise = noise || 0.5; var points = []; for (var i = 0; i < n; i++) { var p = []; for (var j = 0; j < n; j++) { p[j] = i == j ? 1 + noise * normal() : 0; } points.push(new Point(p)); } return points; } // Uniform points from a cube. function cubeData(n, dim) { var points = []; for (var i = 0; i < n; i++) { var p = []; for (var j = 0; j < dim; j++) { p[j] = Math.random(); } points.push(new Point(p)); } return points; } // Points in two unlinked rings. function unlinkData(n) { var points = []; function rotate(x, y, z) { var u = x; var cos = Math.cos(.4); var sin = Math.sin(.4); var v = cos * y + sin * z; var w = -sin * y + cos * z; return [u, v, w]; } for (var i = 0; i < n; i++) { var t = 2 * Math.PI * i / n; var sin = Math.sin(t); var cos = Math.cos(t); // Ring 1. points.push(new Point(rotate(cos, sin, 0), '#f90')); // Ring 2. points.push(new Point(rotate(3 + cos, 0, sin), '#039')); } return points; } // Points in linked rings. function linkData(n) { var points = []; function rotate(x, y, z) { var u = x; var cos = Math.cos(.4); var sin = Math.sin(.4); var v = cos * y + sin * z; var w = -sin * y + cos * z; return [u, v, w]; } for (var i = 0; i < n; i++) { var t = 2 * Math.PI * i / n; var sin = Math.sin(t); var cos = Math.cos(t); // Ring 1. points.push(new Point(rotate(cos, sin, 0), '#f90')); // Ring 2. points.push(new Point(rotate(1 + cos, 0, sin), '#039')); } return points; } // Points in a trefoil knot. function trefoilData(n) { var points = []; for (var i = 0; i < n; i++) { var t = 2 * Math.PI * i / n; var x = Math.sin(t) + 2 * Math.sin(2 * t); var y = Math.cos(t) - 2 * Math.cos(2 * t); var z = -Math.sin(3 * t); points.push(new Point([x, y, z], angleColor(t))); } return points; } // Two long, linear clusters in 2D. function longClusterData(n) { var points = []; var s = .03 * n; for (var i = 0; i < n; i++) { var x1 = i + s * normal(); var y1 = i + s * normal(); points.push(new Point([x1, y1], '#039')); var x2 = i + s * normal() + n / 5; var y2 = i + s * normal() - n / 5; points.push(new Point([x2, y2], '#f90')); } return points; } // Mutually orthogonal steps. function orthoCurve(n) { var points = []; for (var i = 0; i < n; i++) { var coords = []; for (var j = 0; j < n; j++) { coords[j] = j < i ? 1 : 0; } var t = 1.5 * Math.PI * i / n; points.push(new Point(coords, angleColor(t))); } return points; } // Random walk function randomWalk(n, dim) { var points = []; var current = []; for (var i = 0; i < dim; i++) { current[i] = 0; } for (var i = 0; i < n; i++) { var step = normalVector(dim); var next = current.slice(); for (var j = 0; j < dim; j++) { next[j] = current[j] + step[j]; } var t = 1.5 * Math.PI * i / n; points.push(new Point(next, angleColor(t))); current = next; } return points; } // Random jump: a random walk with // additional noise added at each step. function randomJump(n, dim) { var points = []; var current = []; for (var i = 0; i < dim; i++) { current[i] = 0; } for (var i = 0; i < n; i++) { var step = normalVector(dim); var next = add(step, current.slice()); var r = normalVector(dim); scale(r, Math.sqrt(dim)); var t = 1.5 * Math.PI * i / n; var coords = add(r, next); points.push(new Point(coords, angleColor(t))); current = next; } return points; } /** * @fileoverview Demo configuration for t-SNE playground. */ var demos = [ { name: 'Grid', description: 'A square grid with equal spacing between points. ' + 'Try convergence at different sizes.', options: [ { name: 'Points Per Side', min: 2, max: 20, start: 10, } ], generator: gridData }, { name: 'Two Clusters', description: 'Two clusters with equal numbers of points.', options: [ { name: 'Points Per Cluster', min: 1, max: 100, start: 50, }, { name: 'Dimensions', min: 1, max: 100, start: 2, } ], generator: twoClustersData }, { name: 'Three Clusters', description: 'Three clusters with equal numbers of points, but at ' + 'different distances from each other. Cluster distances are ' + 'only apparent at certain perplexities', options: [ { name: 'Points Per Cluster', min: 1, max: 100, start: 50, }, { name: 'Dimensions', min: 1, max: 100, start: 2, } ], generator: threeClustersData }, { name: 'Two Different-Sized Clusters', description: 'Two clusters with equal numbers of points, but different ' + 'variances within the clusters. Cluster separation depends on perplexity.', options: [ { name: 'Points Per Cluster', min: 1, max: 100, start: 50, }, { name: 'Dimensions', min: 1, max: 100, start: 2, }, { name: 'Scale', min: 1, max: 10, start: 5, } ], generator: twoDifferentClustersData }, { name: 'Two Long Linear Clusters', description: 'Two sets of points, arranged in parallel lines that ' + 'are close to each other. Note curvature of lines.', options: [ { name: 'Points Per Cluster', min: 1, max: 100, start: 50, } ], generator: longClusterData }, { name: 'Cluster In Cluster', description: 'A dense, tight cluster inside of a wide, sparse cluster. ' + 'Perplexity makes a big difference here.', options: [ { name: 'Points Per Cluster', min: 1, max: 100, start: 50, }, { name: 'Dimensions', min: 1, max: 100, start: 2, } ], generator: subsetClustersData }, { name: 'Circle (Evenly Spaced)', description: 'Points evenly distributed in a circle. ' + 'Hue corresponds to angle in the circle.', options: [ { name: 'Number Of Points', min: 1, max: 100, start: 50, } ], generator: circleData }, { name: 'Circle (Randomly Spaced)', description: 'Points randomly distributed in a circle. ' + 'Hue corresponds to angle in the circle.', options: [ { name: 'Number Of Points', min: 1, max: 100, start: 50, } ], generator: randomCircleData }, { name: 'Gaussian Cloud', description: 'Points in a unit Gaussian distribution. ' + 'Data is entirely random, so any visible subclusters are ' + 'not statistically significant', options: [ { name: 'Number Of Points', min: 1, max: 500, start: 50, }, { name: 'Dimensions', min: 1, max: 100, start: 2, } ], generator: gaussianData }, { name: 'Ellipsoidal Gaussian Cloud', description: 'Points in an ellipsoidal Gaussian distribution. ' + ' Dimension n has variance 1/n. Elongation is visible in plot.', options: [ { name: 'Number Of Points', min: 1, max: 500, start: 50, }, { name: 'Dimensions', min: 1, max: 100, start: 2, } ], generator: longGaussianData }, { name: 'Trefoil Knot', description: 'Points arranged in 3D, following a trefoil knot. ' + 'Different runs may give different results.', options: [ { name: 'Number Of Points', min: 1, max: 200, start: 50, } ], generator: trefoilData }, { name: 'Linked Rings', description: 'Points arranged in 3D, on two linked circles. ' + 'Different runs may give different results.', options: [ { name: 'Number Of Points', min: 1, max: 200, start: 50, } ], generator: linkData }, { name: 'Unlinked Rings', description: 'Points arranged in 3D, on two unlinked circles', options: [ { name: 'Number Of Points', min: 1, max: 200, start: 50, } ], generator: unlinkData }, { name: 'Orthogonal Steps', description: 'Points related by mutually orthogonal steps. ' + 'Very similar to a random walk.', options: [ { name: 'Number Of Points', min: 1, max: 500, start: 50, } ], generator: orthoCurve }, { name: 'Random Walk', description: 'Random (Gaussian) walk. ' + 'Smoother than you might think.', options: [{ name: 'Number Of Points', min: 1, max: 1000, start: 100, }, { name: 'Dimension', min: 1, max: 1000, start: 100, } ], generator: randomWalk }, { name: 'Random Jump', description: 'Random (Gaussian) Jump', options: [ { name: 'Number Of Points', min: 1, max: 1000, start: 100, }, { name: 'Dimension', min: 1, max: 1000, start: 100, } ], generator: randomJump }, { name: 'Equally Spaced', description: 'A set of points, where distances between all pairs of ' + 'points are the same in the original space.', options: [ { name: 'Number Of Points', min: 2, max: 100, start: 50, } ], generator: simplexData }, { name: 'Uniform Distribution', description: 'Points uniformly distributed in a unit cube.', options: [ { name: 'Number Of Points', min: 2, max: 200, start: 50, }, { name: 'Dimensions', min: 1, max: 10, start: 3, } ], generator: cubeData } ]; var demosByName = {} demos.forEach(function(d, i) { d.index = i; demosByName[d.name] = d; }) if(typeof module != \"undefined\") module.exports = { demos: demos, demosByName: demosByName, distanceMatrix: distanceMatrix, Point: Point };"},{"title":"","date":"2018-07-05T13:13:33.697Z","updated":"2018-07-05T13:06:26.122Z","comments":true,"path":"js/tsne-how_use/figure-configs.js","permalink":"https://www.xunhanliu.top/js/tsne-how_use/figure-configs.js","excerpt":"","text":"var figures = [ { id: \"01\", params: [50, 2], dataset: \"Two Clusters\", no3d: true, examples: [ { id: \"01\", perplexity: 2, epsilon: 10, dim: 2, step: 5000 }, { id: \"02\", perplexity: 5, epsilon: 10, dim: 2, step: 5000 }, { id: \"03\", perplexity: 30, epsilon: 10, dim: 2, step: 5000 }, { id: \"04\", perplexity: 50, epsilon: 10, dim: 2, step: 5000 }, { id: \"05\", perplexity: 100, epsilon: 10, dim: 2, step: 5000 }, ] }, { id: \"02\", params: [50, 2], dataset: \"Two Clusters\", no3d: true, examples: [ { id: \"01\", perplexity: 30, epsilon: 10, dim: 2, step: 10 }, { id: \"02\", perplexity: 30, epsilon: 10, dim: 2, step: 20 }, { id: \"03\", perplexity: 30, epsilon: 10, dim: 2, step: 60}, { id: \"04\", perplexity: 30, epsilon: 10, dim: 2, step: 120 }, { id: \"05\", perplexity: 30, epsilon: 10, dim: 2, step: 1000 }, ] }, { id: \"03\", params: [75, 2], dataset: 'Two Different-Sized Clusters', no3d: true, examples: [ { id: \"01\", perplexity: 2, epsilon: 10, dim: 2, step: 5000 }, { id: \"02\", perplexity: 5, epsilon: 10, dim: 2, step: 5000 }, { id: \"03\", perplexity: 30, epsilon: 10, dim: 2, step: 5000 }, { id: \"04\", perplexity: 50, epsilon: 10, dim: 2, step: 5000 }, { id: \"05\", perplexity: 100, epsilon: 10, dim: 2, step: 5000 }, ] }, { id: \"04\", params: [50, 2], dataset: 'Three Clusters', no3d: true, examples: [ { id: \"01\", perplexity: 2, epsilon: 10, dim: 2, step: 5000 }, { id: \"02\", perplexity: 5, epsilon: 10, dim: 2, step: 5000 }, { id: \"03\", perplexity: 30, epsilon: 10, dim: 2, step: 5000 }, { id: \"04\", perplexity: 50, epsilon: 10, dim: 2, step: 5000 }, { id: \"05\", perplexity: 100, epsilon: 10, dim: 2, step: 5000 }, ] }, { id: \"05\", params: [200, 2], dataset: 'Three Clusters', no3d: true, examples: [ { id: \"01\", perplexity: 2, epsilon: 10, dim: 2, step: 5000 }, { id: \"02\", perplexity: 5, epsilon: 10, dim: 2, step: 5000 }, { id: \"03\", perplexity: 30, epsilon: 10, dim: 2, step: 5000 }, { id: \"04\", perplexity: 50, epsilon: 10, dim: 2, step: 5000 }, { id: \"05\", perplexity: 100, epsilon: 10, dim: 2, step: 5000 }, ] }, { id: \"06\", params: [500, 100], dataset: 'Gaussian Cloud', no3d: true, examples: [ { id: \"01\", perplexity: 2, epsilon: 10, dim: 2, step: 5000 }, { id: \"02\", perplexity: 5, epsilon: 10, dim: 2, step: 5000 }, { id: \"03\", perplexity: 30, epsilon: 10, dim: 2, step: 5000 }, { id: \"04\", perplexity: 50, epsilon: 10, dim: 2, step: 5000 }, { id: \"05\", perplexity: 100, epsilon: 10, dim: 2, step: 5000 }, ] }, { id: \"07\", params: [100, 50], dataset: 'Ellipsoidal Gaussian Cloud', no3d: true, examples: [ { id: \"01\", perplexity: 2, epsilon: 10, dim: 2, step: 5000 }, { id: \"02\", perplexity: 5, epsilon: 10, dim: 2, step: 5000 }, { id: \"03\", perplexity: 30, epsilon: 10, dim: 2, step: 5000 }, { id: \"04\", perplexity: 50, epsilon: 10, dim: 2, step: 5000 }, { id: \"05\", perplexity: 100, epsilon: 10, dim: 2, step: 5000 }, ] }, { id: \"08\", params: [75, 2], dataset: 'Two Long Linear Clusters', no3d: true, examples: [ { id: \"01\", perplexity: 2, epsilon: 10, dim: 2, step: 5000 }, { id: \"02\", perplexity: 5, epsilon: 10, dim: 2, step: 5000 }, { id: \"03\", perplexity: 30, epsilon: 10, dim: 2, step: 5000 }, { id: \"04\", perplexity: 50, epsilon: 10, dim: 2, step: 5000 }, { id: \"05\", perplexity: 100, epsilon: 10, dim: 2, step: 5000 }, ] }, { id: \"09\", params: [75, 50], dataset: 'Cluster In Cluster', no3d: true, examples: [ { id: \"01\", perplexity: 2, epsilon: 10, dim: 2, step: 5000 }, { id: \"02\", perplexity: 5, epsilon: 10, dim: 2, step: 5000 }, { id: \"03\", perplexity: 30, epsilon: 10, dim: 2, step: 5000 }, { id: \"04\", perplexity: 50, epsilon: 10, dim: 2, step: 5000 }, { id: \"05\", perplexity: 100, epsilon: 10, dim: 2, step: 5000 }, ] }, { id: \"10\", params: [100], dataset: 'Linked Rings', no3d: false, examples: [ { id: \"01\", perplexity: 2, epsilon: 10, dim: 2, step: 5000 }, { id: \"02\", perplexity: 5, epsilon: 10, dim: 2, step: 5000 }, { id: \"03\", perplexity: 30, epsilon: 10, dim: 2, step: 5000 }, { id: \"04\", perplexity: 50, epsilon: 10, dim: 2, step: 5000 }, { id: \"05\", perplexity: 100, epsilon: 10, dim: 2, step: 5000 }, ] }, { id: \"11\", params: [150], dataset: 'Trefoil Knot', no3d: false, examples: [ { id: \"01\", perplexity: 2, epsilon: 10, dim: 2, step: 5000 }, { id: \"02\", perplexity: 5, epsilon: 10, dim: 2, step: 5000 }, { id: \"03\", perplexity: 30, epsilon: 10, dim: 2, step: 5000 }, { id: \"04\", perplexity: 50, epsilon: 10, dim: 2, step: 5000 }, { id: \"05\", perplexity: 100, epsilon: 10, dim: 2, step: 5000 }, ] }, { id: \"12\", params: [100], dataset: 'Trefoil Knot', no3d: false, examples: [ { id: \"01\", perplexity: 2, epsilon: 10, dim: 2, step: 5000 }, { id: \"02\", perplexity: 2, epsilon: 10, dim: 2, step: 5000 }, { id: \"03\", perplexity: 2, epsilon: 10, dim: 2, step: 5000 }, { id: \"04\", perplexity: 2, epsilon: 10, dim: 2, step: 5000 }, { id: \"05\", perplexity: 2, epsilon: 10, dim: 2, step: 5000 }, ] }, { id: \"13\", params: [100], dataset: 'Trefoil Knot', no3d: false, examples: [ { id: \"01\", perplexity: 50, epsilon: 10, dim: 2, step: 5000 }, { id: \"02\", perplexity: 50, epsilon: 10, dim: 2, step: 5000 }, { id: \"03\", perplexity: 50, epsilon: 10, dim: 2, step: 5000 }, { id: \"04\", perplexity: 50, epsilon: 10, dim: 2, step: 5000 }, { id: \"05\", perplexity: 50, epsilon: 10, dim: 2, step: 5000 }, ] }, ] if(typeof module != \"undefined\") module.exports = figures;"},{"title":"","date":"2018-07-05T13:13:26.775Z","updated":"2018-07-05T13:06:26.594Z","comments":true,"path":"js/tsne-how_use/figures.js","permalink":"https://www.xunhanliu.top/js/tsne-how_use/figures.js","excerpt":"","text":"/* Configurations and utility functions for figures */ // Copyright 2018 Google LLC // // Licensed under the Apache License, Version 2.0 (the \"License\"); // you may not use this file except in compliance with the License. // You may obtain a copy of the License at // // http://www.apache.org/licenses/LICENSE-2.0 // // Unless required by applicable law or agreed to in writing, software // distributed under the License is distributed on an \"AS IS\" BASIS, // WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. // See the License for the specific language governing permissions and // limitations under the License. if(typeof require != \"undefined\") { // hack for loading from generator var d3 = require('./d3.min.js') var visualize = require('./visualize.js').visualize var tsnejs = require('./tsne.js') var demoConfigs = require('./demo-configs.js') var distanceMatrix = demoConfigs.distanceMatrix var Point = demoConfigs.Point } var FIGURES = { width: 150, height: 150, downscaleWidth: 300, downscaleHeight: 300, } function getPoints(demo, params) { if(!params) { params = [demo.options[0].start] if(demo.options[1]) params.push(demo.options[1].start) } var points = demo.generator.apply(null, params); return points; } function renderDemoInitial(demo, params, canvas) { visualize(points, canvas, null, null) } /* var demoTimescale = d3.scaleLinear() .domain([0, 200, 6000]) .range([20, 10, 0]) */ var timescale = d3.scaleLinear() .domain([0, 20, 50, 100, 200, 6000]) .range([60, 30, 20, 10, 0]); function demoMaker(points, canvas, options, stepCb) { var demo = {}; var paused = false; var step = 0; var chunk = 1; var frameId; var tsne = new tsnejs.tSNE(options); var dists = distanceMatrix(points); tsne.initDataDist(dists); function iterate() { if(paused) return; // control speed at which we iterate if(step >= 200) chunk = 10; for(var k = 0; k < chunk; k++) { tsne.step(); ++step; } //inform the caller about the current step stepCb(step) // update the solution and render var solution = tsne.getSolution().map(function(coords, i) { return new Point(coords, points[i].color); }); visualize(solution, canvas, \"\"); //removed message //control the loop. var timeout = timescale(step) setTimeout(function() { frameId = window.requestAnimationFrame(iterate); }, timeout) } demo.pause = function() { if(paused) return; // already paused paused = true; window.cancelAnimationFrame(frameId) } demo.unpause = function() { if(!paused) return; // already unpaused paused = false; iterate(); } demo.paused = function() { return paused; } demo.destroy = function() { demo.pause(); delete demo; } iterate(); return demo; } function runDemoSync(points, canvas, options, stepLimit, no3d) { var tsne = new tsnejs.tSNE(options); var dists = distanceMatrix(points); tsne.initDataDist(dists); var step = 0; for(var k = 0; k < stepLimit; k++) { if(k % 100 === 0) console.log(\"step\", step) tsne.step(); ++step; } var solution = tsne.getSolution().map(function(coords, i) { return new Point(coords, points[i].color); }); visualize(solution, canvas, \"\", no3d); //removed message return step; } if(typeof module != \"undefined\") module.exports = { demoMaker: demoMaker, runDemoSync: runDemoSync, getPoints: getPoints, FIGURES: FIGURES }"},{"title":"","date":"2018-07-05T13:13:26.814Z","updated":"2018-07-05T13:06:27.132Z","comments":true,"path":"js/tsne-how_use/playground.js","permalink":"https://www.xunhanliu.top/js/tsne-how_use/playground.js","excerpt":"","text":"/** * @fileoverview Demo that helps explain what t-SNE is doing. * In particular, shows how various geometries translate to a 2D map, * and lets you play with the perplexity hyperparameter. * * None of this is optimized code, because it doesn't seem necessary * for the small cases we're considering. */ // Copyright 2018 Google LLC // // Licensed under the Apache License, Version 2.0 (the \"License\"); // you may not use this file except in compliance with the License. // You may obtain a copy of the License at // // http://www.apache.org/licenses/LICENSE-2.0 // // Unless required by applicable law or agreed to in writing, software // distributed under the License is distributed on an \"AS IS\" BASIS, // WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. // See the License for the specific language governing permissions and // limitations under the License. // Global variable for whether we should keep optimizing. var playgroundThread = 0; var GLOBALS = { playgroundDemo: null, // the object to control running the playground simulation trayDemo: null, // the object to control running the tray simulation running: true, unpausedBefore: false, stepLimit: 5000, state: {}, showDemo: null, perplexitySlider: null, epsilonSlider: null, } main(); // Main entry point. function main() { // Set state from hash. var format = d3.format(\",\"); function setStateFromParams() { var params = {}; window.location.hash.substring(1).split('&').forEach(function(p) { var tokens = p.split('='); params[tokens[0]] = tokens[1]; }); function getParam(key, fallback) { return params[key] === undefined ? fallback : params[key]; } GLOBALS.state = { perplexity: +getParam('perplexity', 10), epsilon: +getParam('epsilon', 5), demo: +getParam('demo', 0), demoParams: getParam('demoParams', '20,2').split(',').map(Number) }; } setStateFromParams(); // Utility function for creating value sliders. function makeSlider(container, name, min, max, start) { var dis = d3.select(container) dis.append(\"span\").classed(\"slider-label-\" + name, true) .text(name + ' ') var value = dis.append(\"span\").classed(\"slider-value-\" + name, true) .text(start) var slider = dis.append(\"input\") .attr(\"type\", \"range\") .attr(\"min\", min) .attr(\"max\", max) .attr(\"value\", start) .on(\"change\", updateParameters) .on(\"input\", function() { value.text(slider.node().value); }) return slider.node(); } // Create menu of possible demos. var menuDiv = d3.select(\"#data-menu\"); var dataMenus = menuDiv.selectAll(\".demo-data\") .data(demos) .enter().append(\"div\") .classed(\"demo-data\", true) .on(\"click\", function(d,i) { showDemo(i); }); dataMenus.append(\"canvas\") .attr(\"width\", 150) .attr(\"height\", 150) .each(function(d,i) { var demo = demos[i]; var params = [demo.options[0].start] if(demo.options[1]) params.push(demo.options[1].start) var points = demo.generator.apply(null, params); var canvas = d3.select(this).node() visualize(points, canvas, null, null) }); dataMenus.append(\"span\") .text(function(d) { return d.name}); // Set up t-SNE UI. var tsneUI = document.getElementById('tsne-options'); var perplexitySlider = makeSlider(tsneUI, 'Perplexity', 2, 100, GLOBALS.state.perplexity); var epsilonSlider = makeSlider(tsneUI, 'Epsilon', 1, 20, GLOBALS.state.epsilon); GLOBALS.perplexitySlider = perplexitySlider GLOBALS.epsilonSlider = epsilonSlider // Controls for data options. var optionControls; var demo; function updateParameters() { GLOBALS.state.demoParams = optionControls.map(function(s) {return s.value;}); GLOBALS.state.perplexity = perplexitySlider.value; GLOBALS.state.epsilon = epsilonSlider.value; d3.select(\"#share\").style(\"display\", \"\") .attr(\"href\", \"#\" + generateHash()) runState(); } function generateHash() { function stringify(map) { var s = ''; for (key in map) { s += '&' + key + '=' + map[key]; } return s.substring(1); } //window.location.hash = stringify(GLOBALS.state); return stringify(GLOBALS.state); } function runState() { // Set up t-SNE and start it running. var points = demo.generator.apply(null, GLOBALS.state.demoParams); var canvas = document.getElementById('output'); // if there was already a playground demo going, lets destroy it and make a new one if(GLOBALS.playgroundDemo) { GLOBALS.playgroundDemo.destroy(); delete GLOBALS.playgroundDemo; } //runPlayground(points, canvas, GLOBALS.state, function(step) { GLOBALS.playgroundDemo = demoMaker(points, canvas, GLOBALS.state, function(step) { d3.select(\"#step\").text(format(step)); if(step >= GLOBALS.stepLimit && !GLOBALS.unpausedBefore) { setRunning(false) } }) GLOBALS.unpausedBefore = false; setRunning(true); } var playPause = document.getElementById('play-pause'); function setRunning(r) { GLOBALS.running = r; GLOBALS.playgroundRunning = r; if (GLOBALS.running) { GLOBALS.playgroundDemo.unpause(); playPause.setAttribute(\"class\", \"playing\") } else { GLOBALS.playgroundDemo.pause(); playPause.setAttribute(\"class\", \"paused\") } } // Hook up play / pause / restart buttons. playPause.onclick = function() { GLOBALS.unpausedBefore = true; setRunning(!GLOBALS.running); }; document.getElementById('restart').onclick = updateParameters; // Show a given demo. GLOBALS.showDemo = showDemo; function showDemo(index, initializeFromState) { GLOBALS.state.demo = index; demo = demos[index]; // Show description of demo data. //document.querySelector('#data-description span').textContent = demo.description; d3.select(\"#data-description span\").text(demo.description) // Create UI for the demo data options. var dataOptionsArea = document.getElementById('data-options'); dataOptionsArea.innerHTML = ''; optionControls = demo.options.map(function(option, i) { var value = initializeFromState ? GLOBALS.state.demoParams[i] : option.start; return makeSlider(dataOptionsArea, option.name, option.min, option.max, value); }); menuDiv.selectAll(\".demo-data\") .classed(\"selected\", false) .filter(function(d,i) { return i === index }) .classed(\"selected\", true) updateParameters(); } // run initial demo; setTimeout(function() { showDemo(GLOBALS.state.demo, true); // hide the share link initially d3.select(\"#share\").style(\"display\", \"none\") },1); d3.select(window).on(\"popstate\", function() { setTimeout(function() { //updateParameters(); setStateFromParams(); showDemo(GLOBALS.state.demo, true) },1) }) d3.select(window).on(\"scroll.playground\", function() { if(scrollY > 1000) { if(GLOBALS.playgroundRunning) { setRunning(false); } } else { if(!GLOBALS.playgroundRunning) { // setRunning(true) } } }) }"},{"title":"","date":"2018-07-05T13:13:26.735Z","updated":"2018-07-05T13:06:24.856Z","comments":true,"path":"js/tsne-how_use/tsne.js","permalink":"https://www.xunhanliu.top/js/tsne-how_use/tsne.js","excerpt":"","text":"'use strict'; /** @license * The MIT License (MIT) * Copyright (c) 2015 Andrej Karpathy * Permission is hereby granted, free of charge, to any person obtaining a copy * of this software and associated documentation files (the \"Software\"), to deal * in the Software without restriction, including without limitation the rights * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell * copies of the Software, and to permit persons to whom the Software is * furnished to do so, subject to the following conditions: * * The above copyright notice and this permission notice shall be included in * all copies or substantial portions of the Software. * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN * THE SOFTWARE. */ //goog.provide('tsnejs'); /** * @type {string} */ //tsnejs.REVISION = 'ALPHA'; var tsnejs = {} // utility function var assert = function(condition, message) { if (!condition) { throw message || 'Assertion failed'; } }; // syntax sugar var getopt = function(opt, field, defaultval) { if (opt.hasOwnProperty(field)) { return opt[field]; } else { return defaultval; } }; // return 0 mean unit standard deviation random number var return_v = false; var v_val = 0.0; var gaussRandom = function(rng) { if (return_v) { return_v = false; return v_val; } var u = 2 * rng() - 1; var v = 2 * rng() - 1; var r = u * u + v * v; if (r == 0 || r > 1) return gaussRandom(rng); var c = Math.sqrt(-2 * Math.log(r) / r); v_val = v * c; // cache this for next function call for efficiency return_v = true; return u * c; }; // return random normal number var randn = function(rng, mu, std) { return mu + gaussRandom(rng) * std; }; // utilitity that creates contiguous vector of zeros of size n var zeros = function(n) { if (typeof(n) === 'undefined' || isNaN(n)) { return []; } if (typeof ArrayBuffer === 'undefined') { // lacking browser support var arr = new Array(n); for (var i = 0; i < n; i++) { arr[i] = 0; } return arr; } else { return new Float64Array(n); // typed arrays are faster } }; // utility that returns 2d array filled with random numbers from generator rng var randn2d = function(n, d, rng) { var x = []; for (var i = 0; i < n; i++) { var xhere = []; for (var j = 0; j < d; j++) { xhere.push(randn(rng, 0.0, 1e-4)); } x.push(xhere); } return x; }; // utility that returns 2d array filled with value s var arrayofs = function(n, d, s) { var x = []; for (var i = 0; i < n; i++) { var xhere = []; for (var j = 0; j < d; j++) { xhere.push(s); } x.push(xhere); } return x; }; // compute L2 distance between two vectors var L2 = function(x1, x2) { var D = x1.length; var d = 0; for (var i = 0; i < D; i++) { var x1i = x1[i]; var x2i = x2[i]; d += (x1i - x2i) * (x1i - x2i); } return d; }; // compute pairwise distance in all vectors in X var xtod = function(X) { var N = X.length; var dist = zeros(N * N); // allocate contiguous array for (var i = 0; i < N; i++) { for (var j = i + 1; j < N; j++) { var d = L2(X[i], X[j]); dist[i * N + j] = d; dist[j * N + i] = d; } } return dist; }; // compute (p_{i|j} + p_{j|i})/(2n) var d2p = function(D, perplexity, tol) { var Nf = Math.sqrt(D.length); // this better be an integer var N = Math.floor(Nf); assert(N === Nf, 'D should have square number of elements.'); var Htarget = Math.log(perplexity); // target entropy of distribution var P = zeros(N * N); // temporary probability matrix var prow = zeros(N); // a temporary storage compartment for (var i = 0; i < N; i++) { var betamin = -Infinity; var betamax = Infinity; var beta = 1; // initial value of precision var done = false; var maxtries = 50; // perform binary search to find a suitable precision beta // so that the entropy of the distribution is appropriate var num = 0; while (!done) { //debugger; // compute entropy and kernel row with beta precision var psum = 0.0; for (var j = 0; j < N; j++) { var pj = Math.exp(- D[i * N + j] * beta); if (i === j) { pj = 0; } // we dont care about diagonals prow[j] = pj; psum += pj; } // normalize p and compute entropy var Hhere = 0.0; for (var j = 0; j < N; j++) { var pj = prow[j] / psum; prow[j] = pj; if (pj > 1e-7) Hhere -= pj * Math.log(pj); } // adjust beta based on result if (Hhere > Htarget) { // entropy was too high (distribution too diffuse) // so we need to increase the precision for more peaky distribution betamin = beta; // move up the bounds if (betamax === Infinity) { beta = beta * 2; } else { beta = (beta + betamax) / 2; } } else { // converse case. make distrubtion less peaky betamax = beta; if (betamin === -Infinity) { beta = beta / 2; } else { beta = (beta + betamin) / 2; } } // stopping conditions: too many tries or got a good precision num++; if (Math.abs(Hhere - Htarget) < tol) { done = true; } if (num >= maxtries) { done = true; } } // copy over the final prow to P at row i for (var j = 0; j < N; j++) { P[i * N + j] = prow[j]; } } // end loop over examples i // symmetrize P and normalize it to sum to 1 over all ij var Pout = zeros(N * N); var N2 = N * 2; for (var i = 0; i < N; i++) { for (var j = 0; j < N; j++) { Pout[i * N + j] = Math.max((P[i * N + j] + P[j * N + i]) / N2, 1e-100); } } return Pout; }; // helper function function sign(x) { return x > 0 ? 1 : x < 0 ? -1 : 0; } /** * @param {?Object} opt Options. * @constructor */ var tSNE = function(opt) { opt = opt || {}; this.perplexity = getopt(opt, 'perplexity', 30); this.dim = getopt(opt, 'dim', 2); // by default 2-D tSNE this.epsilon = getopt(opt, 'epsilon', 10); // learning rate this.rng = getopt(opt, 'rng', Math.random); this.iter = 0; }; tSNE.prototype = { // this function takes a set of high-dimensional points // and creates matrix P from them using gaussian kernel initDataRaw: function(X) { var N = X.length; var D = X[0].length; assert(N > 0, ' X is empty? You must have some data!'); assert(D > 0, ' X[0] is empty? Where is the data?'); var dists = xtod(X); // convert X to distances using gaussian kernel this.P = d2p(dists, this.perplexity, 1e-4); // attach to object this.N = N; // back up the size of the dataset this.initSolution(); // refresh this }, // this function takes a fattened distance matrix and creates // matrix P from them. // D is assumed to be provided as an array of size N^2. initDataDist: function(D) { var N = Math.sqrt(D.length); this.P = d2p(D, this.perplexity, 1e-4); this.N = N; this.initSolution(); // refresh this }, // (re)initializes the solution to random initSolution: function() { // generate random solution to t-SNE this.Y = randn2d(this.N, this.dim, this.rng); // the solution this.gains = arrayofs(this.N, this.dim, 1.0); // step gains // to accelerate progress in unchanging directions this.ystep = arrayofs(this.N, this.dim, 0.0); // momentum accumulator this.iter = 0; }, // return pointer to current solution getSolution: function() { return this.Y; }, // perform a single step of optimization to improve the embedding step: function() { this.iter += 1; var N = this.N; var cg = this.costGrad(this.Y); // evaluate gradient var cost = cg.cost; var grad = cg.grad; // perform gradient step var ymean = zeros(this.dim); for (var i = 0; i < N; i++) { for (var d = 0; d < this.dim; d++) { var gid = grad[i][d]; var sid = this.ystep[i][d]; var gainid = this.gains[i][d]; // compute gain update var newgain = sign(gid) === sign(sid) ? gainid * 0.8 : gainid + 0.2; if (newgain < 0.01) newgain = 0.01; // clamp this.gains[i][d] = newgain; // store for next turn // compute momentum step direction var momval = this.iter < 250 ? 0.5 : 0.8; var newsid = momval * sid - this.epsilon * newgain * grad[i][d]; this.ystep[i][d] = newsid; // remember the step we took // step! this.Y[i][d] += newsid; ymean[d] += this.Y[i][d]; // accumulate mean so that we // can center later } } // reproject Y to be zero mean for (var i = 0; i < N; i++) { for (var d = 0; d < this.dim; d++) { this.Y[i][d] -= ymean[d] / N; } } //if(this.iter%100===0) console.log('iter ' + this.iter + ', //cost: ' + cost); return cost; // return current cost }, // for debugging: gradient check debugGrad: function() { var N = this.N; var cg = this.costGrad(this.Y); // evaluate gradient var cost = cg.cost; var grad = cg.grad; var e = 1e-5; for (var i = 0; i < N; i++) { for (var d = 0; d < this.dim; d++) { var yold = this.Y[i][d]; this.Y[i][d] = yold + e; var cg0 = this.costGrad(this.Y); this.Y[i][d] = yold - e; var cg1 = this.costGrad(this.Y); var analytic = grad[i][d]; var numerical = (cg0.cost - cg1.cost) / (2 * e); console.log(i + ',' + d + ': gradcheck analytic: ' + analytic + ' vs. numerical: ' + numerical); this.Y[i][d] = yold; } } }, // return cost and gradient, given an arrangement costGrad: function(Y) { var N = this.N; var dim = this.dim; // dim of output space var P = this.P; var pmul = this.iter < 100 ? 4 : 1; // trick that helps with local optima // compute current Q distribution, unnormalized first var Qu = zeros(N * N); var qsum = 0.0; for (var i = 0; i < N; i++) { for (var j = i + 1; j < N; j++) { var dsum = 0.0; for (var d = 0; d < dim; d++) { var dhere = Y[i][d] - Y[j][d]; dsum += dhere * dhere; } var qu = 1.0 / (1.0 + dsum); // Student t-distribution Qu[i * N + j] = qu; Qu[j * N + i] = qu; qsum += 2 * qu; } } var cost = 0.0; var grad = []; for (var i = 0; i < N; i++) { var gsum = new Array(dim); // init grad for point i for (var d = 0; d < dim; d++) { gsum[d] = 0.0; } for (var j = 0; j < N; j++) { var normedProb = Math.max(Qu[i * N + j] / qsum, 1e-100); cost += - P[i * N + j] * Math.log(normedProb); // accumulate cost var premult = 4 * (pmul * P[i * N + j] - normedProb) * Qu[i * N + j]; for (var d = 0; d < dim; d++) { gsum[d] += premult * (Y[i][d] - Y[j][d]); } } grad.push(gsum); } return {cost: cost, grad: grad}; } }; tsnejs.tSNE = tSNE; // export tSNE class if(typeof module != \"undefined\") module.exports = tsnejs"},{"title":"","date":"2018-07-05T13:13:26.799Z","updated":"2018-07-05T13:06:26.581Z","comments":true,"path":"js/tsne-how_use/visualize.js","permalink":"https://www.xunhanliu.top/js/tsne-how_use/visualize.js","excerpt":"","text":"// Copyright 2018 Google LLC // // Licensed under the Apache License, Version 2.0 (the \"License\"); // you may not use this file except in compliance with the License. // You may obtain a copy of the License at // // http://www.apache.org/licenses/LICENSE-2.0 // // Unless required by applicable law or agreed to in writing, software // distributed under the License is distributed on an \"AS IS\" BASIS, // WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. // See the License for the specific language governing permissions and // limitations under the License. if(typeof require != \"undefined\") { // hack for loading from generator var d3 = require('./d3.min.js') } // Helper function to draw a circle. // TODO: replace with canvas blitting for web rendering function circle(g, x, y, r) { g.beginPath(); g.arc(x, y, r, 0, 2 * Math.PI); g.fill(); g.stroke(); } // Visualize the given points with the given message. // If \"no3d\" is set, ignore the 3D cue for size. function visualize(points, canvas, message, no3d) { var width = canvas.width; var height = canvas.height; var g = canvas.getContext('2d'); g.fillStyle = 'white'; g.fillRect(0, 0, width, height); var xExtent = d3.extent(points, function(p) {return p.coords[0]}); var yExtent = d3.extent(points, function(p) {return p.coords[1]}); var zExtent = d3.extent(points, function(p) {return p.coords[2]}); var zScale = d3.scaleLinear().domain(zExtent).range([2, 10]); var centerX = (xExtent[0] + xExtent[1]) / 2; var centerY = (yExtent[0] + yExtent[1]) / 2; var scale = Math.min(width, height) / Math.max(xExtent[1] - xExtent[0], yExtent[1] - yExtent[0]); scale *= .9; // Leave a little margin. g.strokeStyle = 'rgba(255,255,255,.5)'; var is3d = !no3d && points[0].coords.length > 2; var index = []; var n = points.length; if (is3d) { for (var i = 0; i < n; i++) { index[i] = i; } index.sort(function(a, b) { return d3.ascending(points[a].coords[2], points[b].coords[2]); }); } for (var i = 0; i < n; i++) { var p = is3d ? points[index[i]] : points[i]; g.fillStyle = p.color; var x = (p.coords[0] - centerX) * scale + width / 2; var y = -(p.coords[1] - centerY) * scale + height / 2; var r = is3d ? zScale(p.coords[2]) : 4; circle(g, x, y, r); } if (message) { g.fillStyle = '#000'; g.font = '24pt Lato'; g.fillText(message, 8, 34); } } if(typeof module != \"undefined\") module.exports = { visualize: visualize }"},{"title":"","date":"2018-07-05T13:13:26.764Z","updated":"2018-07-05T13:06:25.959Z","comments":true,"path":"js/md+html_complex/d3.min.js","permalink":"https://www.xunhanliu.top/js/md+html_complex/d3.min.js","excerpt":"","text":"// https://d3js.org Version 4.2.2. Copyright 2016 Mike Bostock. !function(t,n){\"object\"==typeof exports&&\"undefined\"!=typeof module?n(exports):\"function\"==typeof define&&define.amd?define([\"exports\"],n):n(t.d3=t.d3||{})}(this,function(t){\"use strict\";function n(t,n){return tn?1:t>=n?0:NaN}function e(t){return 1===t.length&&(t=r(t)),{left:function(n,e,r,i){for(null==r&&(r=0),null==i&&(i=n.length);r>>1;t(n[o],e)>>1;t(n[o],e)>0?i=o:r=o+1}return r}}}function r(t){return function(e,r){return n(t(e),r)}}function i(t,n){return nt?1:n>=t?0:NaN}function o(t){return null===t?NaN:+t}function u(t,n){var e,r,i=t.length,u=0,a=0,c=-1,s=0;if(null==n)for(;++cmv){var E=un(k/f*Math.sin(T)),C=un(k/l*Math.sin(T));(w-=2*E)>mv?(E*=v?1:-1,x+=E,b-=E):(w=0,x=b=(h+p)/2),(M-=2*C)>mv?(C*=v?1:-1,g+=C,m-=C):(M=0,g=m=(h+p)/2)}var z=l*Math.cos(g),P=l*Math.sin(g),q=f*Math.cos(b),L=f*Math.sin(b);if(S>mv){var R=l*Math.cos(m),U=l*Math.sin(m),D=f*Math.cos(x),O=f*Math.sin(x);if(dmv?an(z,P,D,O,R,U,q,L):[q,L],I=z-F[0],Y=P-F[1],B=R-F[0],j=U-F[1],H=1/Math.sin(Math.acos((I*B+Y*j)/(Math.sqrt(I*I+Y*Y)*Math.sqrt(B*B+j*j)))/2),X=Math.sqrt(F[0]*F[0]+F[1]*F[1]);N=Math.min(S,(f-X)/(H-1)),A=Math.min(S,(l-X)/(H+1))}}M>mv?A>mv?(_=cn(D,O,z,P,l,A,v),y=cn(R,U,q,L,l,A,v),c.moveTo(_.cx+_.x01,_.cy+_.y01),Amv&&w>mv?N>mv?(_=cn(q,L,R,U,f,-N,v),y=cn(z,P,D,O,f,-N,v),c.lineTo(_.cx+_.x01,_.cy+_.y01),N=f;--l)s.point(_[l],y[l]);s.lineEnd(),s.areaEnd()}v&&(_[n]=+e(h,n,t),y[n]=+i(h,n,t),s.point(r?+r(h,n,t):_[n],o?+o(h,n,t):y[n]))}if(p)return s=null,p+\"\"||null}function n(){return dn().defined(u).curve(c).context(a)}var e=hn,r=null,i=Kt(0),o=pn,u=Kt(!0),a=null,c=ln,s=null;return t.x=function(n){return arguments.length?(e=\"function\"==typeof n?n:Kt(+n),r=null,t):e},t.x0=function(n){return arguments.length?(e=\"function\"==typeof n?n:Kt(+n),t):e},t.x1=function(n){return arguments.length?(r=null==n?null:\"function\"==typeof n?n:Kt(+n),t):r},t.y=function(n){return arguments.length?(i=\"function\"==typeof n?n:Kt(+n),o=null,t):i},t.y0=function(n){return arguments.length?(i=\"function\"==typeof n?n:Kt(+n),t):i},t.y1=function(n){return arguments.length?(o=null==n?null:\"function\"==typeof n?n:Kt(+n),t):o},t.lineX0=t.lineY0=function(){return n().x(e).y(i)},t.lineY1=function(){return n().x(e).y(o)},t.lineX1=function(){return n().x(r).y(i)},t.defined=function(n){return arguments.length?(u=\"function\"==typeof n?n:Kt(!!n),t):u},t.curve=function(n){return arguments.length?(c=n,null!=a&&(s=c(a)),t):c},t.context=function(n){return arguments.length?(null==n?a=s=null:s=c(a=n),t):a},t}function _n(t,n){return nt?1:n>=t?0:NaN}function yn(t){return t}function gn(){function t(t){var a,c,s,f,l,h=t.length,p=0,d=new Array(h),v=new Array(h),_=+i.apply(this,arguments),y=Math.min(wv,Math.max(-wv,o.apply(this,arguments)-_)),g=Math.min(Math.abs(y)/h,u.apply(this,arguments)),m=g*(ymv){var a=2*t._l01_2a+3*t._l01_a*t._l12_a+t._l12_2a,c=3*t._l01_a*(t._l01_a+t._l12_a);r=(r*a-t._x0*t._l12_2a+t._x2*t._l01_2a)/c,i=(i*a-t._y0*t._l12_2a+t._y2*t._l01_2a)/c}if(t._l23_a>mv){var s=2*t._l23_2a+3*t._l23_a*t._l12_a+t._l12_2a,f=3*t._l23_a*(t._l23_a+t._l12_a);o=(o*s+t._x1*t._l23_2a-n*t._l12_2a)/f,u=(u*s+t._y1*t._l23_2a-e*t._l12_2a)/f}t._context.bezierCurveTo(r,i,o,u,t._x2,t._y2)}function Fn(t,n){this._context=t,this._alpha=n}function In(t,n){this._context=t,this._alpha=n}function Yn(t,n){this._context=t,this._alpha=n}function Bn(t){this._context=t}function jn(t){return new Bn(t)}function Hn(t){return t=0;--n)i[n]=(u[n]-i[n+1])/o[n];for(o[r-1]=(t[r]+i[r-1])/2,n=0;n1)for(var e,r,i=1,o=t[n[0]],u=o.length;i=0;)e[n]=n;return e}function ce(t,n){return t[n]}function se(){function t(t){var o,u,a=n.apply(this,arguments),c=t.length,s=a.length,f=new Array(s);for(o=0;o0){for(var e,r,i,o=0,u=t[0].length;o8&15|n>>4&240,n>>4&15|240&n,(15&n)16&255,t>>8&255,255&t,1)}function Me(t,n,e,r){return r\",i=n[3]||\"-\",o=n[4]||\"\",u=!!n[5],a=n[6]&&+n[6],c=!!n[7],s=n[8]&&+n[8].slice(1),f=n[9]||\"\";\"n\"===f?(c=!0,f=\"g\"):Eg[f]||(f=\"\"),(u||\"0\"===e&&\"=\"===r)&&(u=!0,e=\"0\",r=\"=\"),this.fill=e,this.align=r,this.sign=i,this.symbol=o,this.zero=u,this.width=a,this.comma=c,this.precision=s,this.type=f}function ui(t){return t}function ai(t){function n(t){function n(t){var n,i,c,g=d,m=v;if(\"c\"===p)m=_(t)+m,t=\"\";else{t=+t;var x=(t57){m=(46===c?o+t.slice(n+1):t.slice(n))+m,t=t.slice(0,n);break}}l&&!s&&(t=r(t,1/0));var b=g.length+t.length+m.length,w=b1)+g+t+m+w.slice(b)}return w+g+t+m}t=ii(t);var e=t.fill,u=t.align,a=t.sign,c=t.symbol,s=t.zero,f=t.width,l=t.comma,h=t.precision,p=t.type,d=\"$\"===c?i[0]:\"#\"===c&&/[boxX]/.test(p)?\"0\"+p.toLowerCase():\"\",v=\"$\"===c?i[1]:/[%p]/.test(p)?\"%\":\"\",_=Eg[p],y=!p||/[defgprs%]/.test(p);return h=null==h?p?6:12:/[gprs]/.test(p)?Math.max(1,Math.min(21,h)):Math.max(0,Math.min(20,h)),n.toString=function(){return t+\"\"},n}function e(t,e){var r=n((t=ii(t),t.type=\"f\",t)),i=3*Math.max(-8,Math.min(8,Math.floor(Kr(e)/3))),o=Math.pow(10,-i),u=Pg[8+i/3];return function(t){return r(o*t)+u}}var r=t.grouping&&t.thousands?ti(t.grouping,t.thousands):ui,i=t.currency,o=t.decimal;return{format:n,formatPrefix:e}}function ci(n){return zg=ai(n),t.format=zg.format,t.formatPrefix=zg.formatPrefix,zg}function si(t){return Math.max(0,-Kr(Math.abs(t)))}function fi(t,n){return Math.max(0,3*Math.max(-8,Math.min(8,Math.floor(Kr(n)/3)))-Kr(Math.abs(t)))}function li(t,n){return t=Math.abs(t),n=Math.abs(n)-t,Math.max(0,Kr(n)-Kr(t))+1}function hi(t){if(0E||r===E&&(N[0]||N[1]))&&(u+=k^w>=0?1:-1)}}return(ovv?this._.push(\"A\",e,\",\",e,\",0,1,\",f,\",\",t-u,\",\",n-a,\"A\",e,\",\",e,\",0,1,\",f,\",\",this._x1=c,\",\",this._y1=s):(l=hv),\",\",f,\",\",this._x1=t+e*Math.cos(i),\",\",this._y1=n+e*Math.sin(i))))},rect:function(t,n,e,r){this._.push(\"M\",this._x0=this._x1=+t,\",\",this._y0=this._y1=+n,\"h\",+e,\"v\",+r,\"h\",-e,\"Z\")},toString:function(){return this._.join(\"\")}};var _v=jt.prototype=Ht.prototype;_v.copy=function(){var t,n,e=new Ht(this._x,this._y,this._x0,this._y0,this._x1,this._y1),r=this._root;if(!r)return e;if(!r.length)return e._root=Xt(r),e;for(t=[{source:r,target:e._root=new Array(4)}];r=t.pop();)for(var i=0;i0)for(var r,i=t[0],o=n[0],u=t[e]-i,a=n[e]-o,c=-1;++c=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(t,n){switch(t=+t,n=+n,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,n):this._context.moveTo(t,n);break;case 1:this._point=2;default:if(this._t1?Zr(function(n){n.setTime(Math.floor(n/t)*t)},function(n,e){n.setTime(+n+e*t)},function(n,e){return(e-n)/t}):ky:null};var Sy=ky.range,Ny=1e3,Ay=6e4,Ey=36e5,Cy=864e5,zy=6048e5,Py=Zr(function(t){t.setTime(Math.floor(t/Ny)*Ny)},function(t,n){t.setTime(+t+n*Ny)},function(t,n){return(n-t)/Ny},function(t){return t.getUTCSeconds()}),qy=Py.range,Ly=Zr(function(t){t.setTime(Math.floor(t/Ay)*Ay)},function(t,n){t.setTime(+t+n*Ay)},function(t,n){return(n-t)/Ay},function(t){return t.getMinutes()}),Ry=Ly.range,Uy=Zr(function(t){var n=t.getTimezoneOffset()*Ay%Ey;n0?Zr(function(n){n.setFullYear(Math.floor(n.getFullYear()/t)*t),n.setMonth(0,1),n.setHours(0,0,0,0)},function(n,e){n.setFullYear(n.getFullYear()+e*t)}):null};var rg=eg.range,ig=Zr(function(t){t.setUTCSeconds(0,0)},function(t,n){t.setTime(+t+n*Ay)},function(t,n){return(n-t)/Ay},function(t){return t.getUTCMinutes()}),og=ig.range,ug=Zr(function(t){t.setUTCMinutes(0,0,0)},function(t,n){t.setTime(+t+n*Ey)},function(t,n){return(n-t)/Ey},function(t){return t.getUTCHours()}),ag=ug.range,cg=Zr(function(t){t.setUTCHours(0,0,0,0)},function(t,n){t.setUTCDate(t.getUTCDate()+n)},function(t,n){return(n-t)/Cy},function(t){return t.getUTCDate()-1}),sg=cg.range,fg=Jr(0),lg=Jr(1),hg=Jr(2),pg=Jr(3),dg=Jr(4),vg=Jr(5),_g=Jr(6),yg=fg.range,gg=lg.range,mg=hg.range,xg=pg.range,bg=dg.range,wg=vg.range,Mg=_g.range,Tg=Zr(function(t){t.setUTCDate(1),t.setUTCHours(0,0,0,0)},function(t,n){t.setUTCMonth(t.getUTCMonth()+n)},function(t,n){return n.getUTCMonth()-t.getUTCMonth()+12*(n.getUTCFullYear()-t.getUTCFullYear())},function(t){return t.getUTCMonth()}),kg=Tg.range,Sg=Zr(function(t){t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},function(t,n){t.setUTCFullYear(t.getUTCFullYear()+n)},function(t,n){return n.getUTCFullYear()-t.getUTCFullYear()},function(t){return t.getUTCFullYear()});Sg.every=function(t){return isFinite(t=Math.floor(t))&&t>0?Zr(function(n){n.setUTCFullYear(Math.floor(n.getUTCFullYear()/t)*t),n.setUTCMonth(0,1),n.setUTCHours(0,0,0,0)},function(n,e){n.setUTCFullYear(n.getUTCFullYear()+e*t)}):null};var Ng,Ag=Sg.range,Eg={\"\":ni,\"%\":function(t,n){return(100*t).toFixed(n)},b:function(t){return Math.round(t).toString(2)},c:function(t){return t+\"\"},d:function(t){return Math.round(t).toString(10)},e:function(t,n){return t.toExponential(n)},f:function(t,n){return t.toFixed(n)},g:function(t,n){return t.toPrecision(n)},o:function(t){return Math.round(t).toString(8)},p:function(t,n){return ri(100*t,n)},r:ri,s:ei,X:function(t){return Math.round(t).toString(16).toUpperCase()},x:function(t){return Math.round(t).toString(16)}},Cg=/^(?:(.)?([=^]))?([+\\-\\( ])?([$#])?(0)?(\\d+)?(,)?(\\.\\d+)?([a-z%])?$/i;oi.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?\"0\":\"\")+(null==this.width?\"\":Math.max(1,0|this.width))+(this.comma?\",\":\"\")+(null==this.precision?\"\":\".\"+Math.max(0,0|this.precision))+this.type};var zg,Pg=[\"y\",\"z\",\"a\",\"f\",\"p\",\"n\",\"µ\",\"m\",\"\",\"k\",\"M\",\"G\",\"T\",\"P\",\"E\",\"Z\",\"Y\"];ci({decimal:\".\",thousands:\",\",grouping:[3],currency:[\"$\",\"\"]});var qg,Lg={\"-\":\"\",_:\" \",0:\"0\"},Rg=/^\\s*\\d+/,Ug=/^%/,Dg=/[\\\\\\^\\$\\*\\+\\?\\|\\[\\]\\(\\)\\.\\{\\}]/g;so({dateTime:\"%x, %X\",date:\"%-m/%-d/%Y\",time:\"%-I:%M:%S %p\",periods:[\"AM\",\"PM\"],days:[\"Sunday\",\"Monday\",\"Tuesday\",\"Wednesday\",\"Thursday\",\"Friday\",\"Saturday\"],shortDays:[\"Sun\",\"Mon\",\"Tue\",\"Wed\",\"Thu\",\"Fri\",\"Sat\"],months:[\"January\",\"February\",\"March\",\"April\",\"May\",\"June\",\"July\",\"August\",\"September\",\"October\",\"November\",\"December\"],shortMonths:[\"Jan\",\"Feb\",\"Mar\",\"Apr\",\"May\",\"Jun\",\"Jul\",\"Aug\",\"Sep\",\"Oct\",\"Nov\",\"Dec\"]});var Og=\"%Y-%m-%dT%H:%M:%S.%LZ\",Fg=Date.prototype.toISOString?fo:t.utcFormat(Og),Ig=+new Date(\"2000-01-01T00:00:00.000Z\")?lo:t.utcParse(Og),Yg=Array.prototype,Bg=Yg.map,jg=Yg.slice,Hg={name:\"implicit\"},Xg=[0,1],Vg=1e3,Wg=60*Vg,$g=60*Wg,Zg=24*$g,Gg=7*Zg,Jg=30*Zg,Qg=365*Zg,Kg=Zo(\"1f77b4ff7f0e2ca02cd627289467bd8c564be377c27f7f7fbcbd2217becf\"),tm=Zo(\"393b795254a36b6ecf9c9ede6379398ca252b5cf6bcedb9c8c6d31bd9e39e7ba52e7cb94843c39ad494ad6616be7969c7b4173a55194ce6dbdde9ed6\"),nm=Zo(\"3182bd6baed69ecae1c6dbefe6550dfd8d3cfdae6bfdd0a231a35474c476a1d99bc7e9c0756bb19e9ac8bcbddcdadaeb636363969696bdbdbdd9d9d9\"),em=Zo(\"1f77b4aec7e8ff7f0effbb782ca02c98df8ad62728ff98969467bdc5b0d58c564bc49c94e377c2f7b6d27f7f7fc7c7c7bcbd22dbdb8d17becf9edae5\"),rm=$_(je(300,.5,0),je(-240,.5,1)),im=$_(je(-100,.75,.35),je(80,1.5,.8)),om=$_(je(260,.75,.35),je(80,1.5,.8)),um=je(),am=Jo(Zo(\"44015444025645045745055946075a46085c460a5d460b5e470d60470e6147106347116447136548146748166848176948186a481a6c481b6d481c6e481d6f481f70482071482173482374482475482576482677482878482979472a7a472c7a472d7b472e7c472f7d46307e46327e46337f463480453581453781453882443983443a83443b84433d84433e85423f854240864241864142874144874045884046883f47883f48893e49893e4a893e4c8a3d4d8a3d4e8a3c4f8a3c508b3b518b3b528b3a538b3a548c39558c39568c38588c38598c375a8c375b8d365c8d365d8d355e8d355f8d34608d34618d33628d33638d32648e32658e31668e31678e31688e30698e306a8e2f6b8e2f6c8e2e6d8e2e6e8e2e6f8e2d708e2d718e2c718e2c728e2c738e2b748e2b758e2a768e2a778e2a788e29798e297a8e297b8e287c8e287d8e277e8e277f8e27808e26818e26828e26828e25838e25848e25858e24868e24878e23888e23898e238a8d228b8d228c8d228d8d218e8d218f8d21908d21918c20928c20928c20938c1f948c1f958b1f968b1f978b1f988b1f998a1f9a8a1e9b8a1e9c891e9d891f9e891f9f881fa0881fa1881fa1871fa28720a38620a48621a58521a68522a78522a88423a98324aa8325ab8225ac8226ad8127ad8128ae8029af7f2ab07f2cb17e2db27d2eb37c2fb47c31b57b32b67a34b67935b77937b87838b9773aba763bbb753dbc743fbc7340bd7242be7144bf7046c06f48c16e4ac16d4cc26c4ec36b50c46a52c56954c56856c66758c7655ac8645cc8635ec96260ca6063cb5f65cb5e67cc5c69cd5b6ccd5a6ece5870cf5773d05675d05477d1537ad1517cd2507fd34e81d34d84d44b86d54989d5488bd6468ed64590d74393d74195d84098d83e9bd93c9dd93ba0da39a2da37a5db36a8db34aadc32addc30b0dd2fb2dd2db5de2bb8de29bade28bddf26c0df25c2df23c5e021c8e020cae11fcde11dd0e11cd2e21bd5e21ad8e219dae319dde318dfe318e2e418e5e419e7e419eae51aece51befe51cf1e51df4e61ef6e620f8e621fbe723fde725\")),cm=Jo(Zo(\"00000401000501010601010802010902020b02020d03030f03031204041405041606051806051a07061c08071e0907200a08220b09240c09260d0a290e0b2b100b2d110c2f120d31130d34140e36150e38160f3b180f3d19103f1a10421c10441d11471e114920114b21114e22115024125325125527125829115a2a115c2c115f2d11612f116331116533106734106936106b38106c390f6e3b0f703d0f713f0f72400f74420f75440f764510774710784910784a10794c117a4e117b4f127b51127c52137c54137d56147d57157e59157e5a167e5c167f5d177f5f187f601880621980641a80651a80671b80681c816a1c816b1d816d1d816e1e81701f81721f817320817521817621817822817922827b23827c23827e24828025828125818326818426818627818827818928818b29818c29818e2a81902a81912b81932b80942c80962c80982d80992d809b2e7f9c2e7f9e2f7fa02f7fa1307ea3307ea5317ea6317da8327daa337dab337cad347cae347bb0357bb2357bb3367ab5367ab73779b83779ba3878bc3978bd3977bf3a77c03a76c23b75c43c75c53c74c73d73c83e73ca3e72cc3f71cd4071cf4070d0416fd2426fd3436ed5446dd6456cd8456cd9466bdb476adc4869de4968df4a68e04c67e24d66e34e65e44f64e55064e75263e85362e95462ea5661eb5760ec5860ed5a5fee5b5eef5d5ef05f5ef1605df2625df2645cf3655cf4675cf4695cf56b5cf66c5cf66e5cf7705cf7725cf8745cf8765cf9785df9795df97b5dfa7d5efa7f5efa815ffb835ffb8560fb8761fc8961fc8a62fc8c63fc8e64fc9065fd9266fd9467fd9668fd9869fd9a6afd9b6bfe9d6cfe9f6dfea16efea36ffea571fea772fea973feaa74feac76feae77feb078feb27afeb47bfeb67cfeb77efeb97ffebb81febd82febf84fec185fec287fec488fec68afec88cfeca8dfecc8ffecd90fecf92fed194fed395fed597fed799fed89afdda9cfddc9efddea0fde0a1fde2a3fde3a5fde5a7fde7a9fde9aafdebacfcecaefceeb0fcf0b2fcf2b4fcf4b6fcf6b8fcf7b9fcf9bbfcfbbdfcfdbf\")),sm=Jo(Zo(\"00000401000501010601010802010a02020c02020e03021004031204031405041706041907051b08051d09061f0a07220b07240c08260d08290e092b10092d110a30120a32140b34150b37160b39180c3c190c3e1b0c411c0c431e0c451f0c48210c4a230c4c240c4f260c51280b53290b552b0b572d0b592f0a5b310a5c320a5e340a5f3609613809623909633b09643d09653e0966400a67420a68440a68450a69470b6a490b6a4a0c6b4c0c6b4d0d6c4f0d6c510e6c520e6d540f6d550f6d57106e59106e5a116e5c126e5d126e5f136e61136e62146e64156e65156e67166e69166e6a176e6c186e6d186e6f196e71196e721a6e741a6e751b6e771c6d781c6d7a1d6d7c1d6d7d1e6d7f1e6c801f6c82206c84206b85216b87216b88226a8a226a8c23698d23698f24699025689225689326679526679727669827669a28659b29649d29649f2a63a02a63a22b62a32c61a52c60a62d60a82e5fa92e5eab2f5ead305dae305cb0315bb1325ab3325ab43359b63458b73557b93556ba3655bc3754bd3853bf3952c03a51c13a50c33b4fc43c4ec63d4dc73e4cc83f4bca404acb4149cc4248ce4347cf4446d04545d24644d34743d44842d54a41d74b3fd84c3ed94d3dda4e3cdb503bdd513ade5238df5337e05536e15635e25734e35933e45a31e55c30e65d2fe75e2ee8602de9612bea632aeb6429eb6628ec6726ed6925ee6a24ef6c23ef6e21f06f20f1711ff1731df2741cf3761bf37819f47918f57b17f57d15f67e14f68013f78212f78410f8850ff8870ef8890cf98b0bf98c0af98e09fa9008fa9207fa9407fb9606fb9706fb9906fb9b06fb9d07fc9f07fca108fca309fca50afca60cfca80dfcaa0ffcac11fcae12fcb014fcb216fcb418fbb61afbb81dfbba1ffbbc21fbbe23fac026fac228fac42afac62df9c72ff9c932f9cb35f8cd37f8cf3af7d13df7d340f6d543f6d746f5d949f5db4cf4dd4ff4df53f4e156f3e35af3e55df2e661f2e865f2ea69f1ec6df1ed71f1ef75f1f179f2f27df2f482f3f586f3f68af4f88ef5f992f6fa96f8fb9af9fc9dfafda1fcffa4\")),fm=Jo(Zo(\"0d088710078813078916078a19068c1b068d1d068e20068f2206902406912605912805922a05932c05942e05952f059631059733059735049837049938049a3a049a3c049b3e049c3f049c41049d43039e44039e46039f48039f4903a04b03a14c02a14e02a25002a25102a35302a35502a45601a45801a45901a55b01a55c01a65e01a66001a66100a76300a76400a76600a76700a86900a86a00a86c00a86e00a86f00a87100a87201a87401a87501a87701a87801a87a02a87b02a87d03a87e03a88004a88104a78305a78405a78606a68707a68808a68a09a58b0aa58d0ba58e0ca48f0da4910ea3920fa39410a29511a19613a19814a099159f9a169f9c179e9d189d9e199da01a9ca11b9ba21d9aa31e9aa51f99a62098a72197a82296aa2395ab2494ac2694ad2793ae2892b02991b12a90b22b8fb32c8eb42e8db52f8cb6308bb7318ab83289ba3388bb3488bc3587bd3786be3885bf3984c03a83c13b82c23c81c33d80c43e7fc5407ec6417dc7427cc8437bc9447aca457acb4679cc4778cc4977cd4a76ce4b75cf4c74d04d73d14e72d24f71d35171d45270d5536fd5546ed6556dd7566cd8576bd9586ada5a6ada5b69db5c68dc5d67dd5e66de5f65de6164df6263e06363e16462e26561e26660e3685fe4695ee56a5de56b5de66c5ce76e5be76f5ae87059e97158e97257ea7457eb7556eb7655ec7754ed7953ed7a52ee7b51ef7c51ef7e50f07f4ff0804ef1814df1834cf2844bf3854bf3874af48849f48948f58b47f58c46f68d45f68f44f79044f79143f79342f89441f89540f9973ff9983ef99a3efa9b3dfa9c3cfa9e3bfb9f3afba139fba238fca338fca537fca636fca835fca934fdab33fdac33fdae32fdaf31fdb130fdb22ffdb42ffdb52efeb72dfeb82cfeba2cfebb2bfebd2afebe2afec029fdc229fdc328fdc527fdc627fdc827fdca26fdcb26fccd25fcce25fcd025fcd225fbd324fbd524fbd724fad824fada24f9dc24f9dd25f8df25f8e125f7e225f7e425f6e626f6e826f5e926f5eb27f4ed27f3ee27f3f027f2f227f1f426f1f525f0f724f0f921\")),lm=\"http://www.w3.org/1999/xhtml\",hm={ svg:\"http://www.w3.org/2000/svg\",xhtml:lm,xlink:\"http://www.w3.org/1999/xlink\",xml:\"http://www.w3.org/XML/1998/namespace\",xmlns:\"http://www.w3.org/2000/xmlns/\"},pm=0;iu.prototype=ru.prototype={constructor:iu,get:function(t){for(var n=this._;!(n in t);)if(!(t=t.parentNode))return;return t[n]},set:function(t,n){return t[this._]=n},remove:function(t){return this._ in t&&delete t[this._]},toString:function(){return this._}};var dm=function(t){return function(){return this.matches(t)}};if(\"undefined\"!=typeof document){var vm=document.documentElement;if(!vm.matches){var _m=vm.webkitMatchesSelector||vm.msMatchesSelector||vm.mozMatchesSelector||vm.oMatchesSelector;dm=function(t){return function(){return _m.call(this,t)}}}}var ym=dm,gm={};if(t.event=null,\"undefined\"!=typeof document){var mm=document.documentElement;\"onmouseenter\"in mm||(gm={mouseenter:\"mouseover\",mouseleave:\"mouseout\"})}Tu.prototype={constructor:Tu,appendChild:function(t){return this._parent.insertBefore(t,this._next)},insertBefore:function(t,n){return this._parent.insertBefore(t,n)},querySelector:function(t){return this._parent.querySelector(t)},querySelectorAll:function(t){return this._parent.querySelectorAll(t)}};var xm=\"$\";ia.prototype={add:function(t){var n=this._names.indexOf(t);n=0&&(this._names.splice(n,1),this._node.setAttribute(\"class\",this._names.join(\" \")))},contains:function(t){return this._names.indexOf(t)>=0}};var bm=[null];qa.prototype=La.prototype={constructor:qa,select:yu,selectAll:xu,filter:bu,data:Au,enter:Mu,exit:Eu,merge:Cu,order:zu,sort:Pu,call:Lu,nodes:Ru,node:Uu,size:Du,empty:Ou,each:Fu,attr:Vu,style:Ju,property:na,classed:fa,text:da,html:ga,raise:xa,lower:wa,append:Ma,insert:ka,remove:Na,datum:Aa,on:fu,dispatch:Pa};var wm=Mr(\"start\",\"end\",\"interrupt\"),Mm=[],Tm=0,km=1,Sm=2,Nm=3,Am=4,Em=5,Cm=La.prototype.constructor,zm=0,Pm=La.prototype;Uc.prototype=Dc.prototype={constructor:Uc,select:wc,selectAll:Mc,filter:vc,merge:_c,selection:Tc,transition:Rc,call:Pm.call,nodes:Pm.nodes,node:Pm.node,size:Pm.size,empty:Pm.empty,each:Pm.each,on:mc,attr:rc,attrTween:uc,style:Ec,styleTween:zc,text:Lc,remove:bc,tween:$a,delay:sc,duration:hc,ease:dc};var qm={time:null,delay:0,duration:250,ease:et};La.prototype.interrupt=Xa,La.prototype.transition=Ic;var Lm=[null],Rm=Array.prototype.slice,Um=1,Dm=2,Om=3,Fm=4,Im=1e-6;ws.prototype=ys.prototype={constructor:ws,each:us,eachAfter:cs,eachBefore:as,sum:ss,sort:fs,path:ls,ancestors:ps,descendants:ds,leaves:vs,links:_s,copy:gs};var Ym=\"$\",Bm={depth:-1},jm={};of.prototype=Object.create(ws.prototype);var Hm=(1+Math.sqrt(5))/2,Xm=function t(n){function e(t,e,r,i,o){sf(n,t,e,r,i,o)}return e.ratio=function(n){return t((n=+n)>1?n:1)},e}(Hm),Vm=function t(n){function e(t,e,r,i,o){if((u=t._squarify)&&u.ratio===n)for(var u,a,c,s,f,l=-1,h=u.length,p=t.value;++l"},{"title":"","date":"2018-07-05T13:13:26.764Z","updated":"2018-07-05T13:06:25.959Z","comments":true,"path":"js/tsne-how_use/d3.min.js","permalink":"https://www.xunhanliu.top/js/tsne-how_use/d3.min.js","excerpt":"","text":"// https://d3js.org Version 4.2.2. Copyright 2016 Mike Bostock. !function(t,n){\"object\"==typeof exports&&\"undefined\"!=typeof module?n(exports):\"function\"==typeof define&&define.amd?define([\"exports\"],n):n(t.d3=t.d3||{})}(this,function(t){\"use strict\";function n(t,n){return tn?1:t>=n?0:NaN}function e(t){return 1===t.length&&(t=r(t)),{left:function(n,e,r,i){for(null==r&&(r=0),null==i&&(i=n.length);r>>1;t(n[o],e)>>1;t(n[o],e)>0?i=o:r=o+1}return r}}}function r(t){return function(e,r){return n(t(e),r)}}function i(t,n){return nt?1:n>=t?0:NaN}function o(t){return null===t?NaN:+t}function u(t,n){var e,r,i=t.length,u=0,a=0,c=-1,s=0;if(null==n)for(;++cmv){var E=un(k/f*Math.sin(T)),C=un(k/l*Math.sin(T));(w-=2*E)>mv?(E*=v?1:-1,x+=E,b-=E):(w=0,x=b=(h+p)/2),(M-=2*C)>mv?(C*=v?1:-1,g+=C,m-=C):(M=0,g=m=(h+p)/2)}var z=l*Math.cos(g),P=l*Math.sin(g),q=f*Math.cos(b),L=f*Math.sin(b);if(S>mv){var R=l*Math.cos(m),U=l*Math.sin(m),D=f*Math.cos(x),O=f*Math.sin(x);if(dmv?an(z,P,D,O,R,U,q,L):[q,L],I=z-F[0],Y=P-F[1],B=R-F[0],j=U-F[1],H=1/Math.sin(Math.acos((I*B+Y*j)/(Math.sqrt(I*I+Y*Y)*Math.sqrt(B*B+j*j)))/2),X=Math.sqrt(F[0]*F[0]+F[1]*F[1]);N=Math.min(S,(f-X)/(H-1)),A=Math.min(S,(l-X)/(H+1))}}M>mv?A>mv?(_=cn(D,O,z,P,l,A,v),y=cn(R,U,q,L,l,A,v),c.moveTo(_.cx+_.x01,_.cy+_.y01),Amv&&w>mv?N>mv?(_=cn(q,L,R,U,f,-N,v),y=cn(z,P,D,O,f,-N,v),c.lineTo(_.cx+_.x01,_.cy+_.y01),N=f;--l)s.point(_[l],y[l]);s.lineEnd(),s.areaEnd()}v&&(_[n]=+e(h,n,t),y[n]=+i(h,n,t),s.point(r?+r(h,n,t):_[n],o?+o(h,n,t):y[n]))}if(p)return s=null,p+\"\"||null}function n(){return dn().defined(u).curve(c).context(a)}var e=hn,r=null,i=Kt(0),o=pn,u=Kt(!0),a=null,c=ln,s=null;return t.x=function(n){return arguments.length?(e=\"function\"==typeof n?n:Kt(+n),r=null,t):e},t.x0=function(n){return arguments.length?(e=\"function\"==typeof n?n:Kt(+n),t):e},t.x1=function(n){return arguments.length?(r=null==n?null:\"function\"==typeof n?n:Kt(+n),t):r},t.y=function(n){return arguments.length?(i=\"function\"==typeof n?n:Kt(+n),o=null,t):i},t.y0=function(n){return arguments.length?(i=\"function\"==typeof n?n:Kt(+n),t):i},t.y1=function(n){return arguments.length?(o=null==n?null:\"function\"==typeof n?n:Kt(+n),t):o},t.lineX0=t.lineY0=function(){return n().x(e).y(i)},t.lineY1=function(){return n().x(e).y(o)},t.lineX1=function(){return n().x(r).y(i)},t.defined=function(n){return arguments.length?(u=\"function\"==typeof n?n:Kt(!!n),t):u},t.curve=function(n){return arguments.length?(c=n,null!=a&&(s=c(a)),t):c},t.context=function(n){return arguments.length?(null==n?a=s=null:s=c(a=n),t):a},t}function _n(t,n){return nt?1:n>=t?0:NaN}function yn(t){return t}function gn(){function t(t){var a,c,s,f,l,h=t.length,p=0,d=new Array(h),v=new Array(h),_=+i.apply(this,arguments),y=Math.min(wv,Math.max(-wv,o.apply(this,arguments)-_)),g=Math.min(Math.abs(y)/h,u.apply(this,arguments)),m=g*(ymv){var a=2*t._l01_2a+3*t._l01_a*t._l12_a+t._l12_2a,c=3*t._l01_a*(t._l01_a+t._l12_a);r=(r*a-t._x0*t._l12_2a+t._x2*t._l01_2a)/c,i=(i*a-t._y0*t._l12_2a+t._y2*t._l01_2a)/c}if(t._l23_a>mv){var s=2*t._l23_2a+3*t._l23_a*t._l12_a+t._l12_2a,f=3*t._l23_a*(t._l23_a+t._l12_a);o=(o*s+t._x1*t._l23_2a-n*t._l12_2a)/f,u=(u*s+t._y1*t._l23_2a-e*t._l12_2a)/f}t._context.bezierCurveTo(r,i,o,u,t._x2,t._y2)}function Fn(t,n){this._context=t,this._alpha=n}function In(t,n){this._context=t,this._alpha=n}function Yn(t,n){this._context=t,this._alpha=n}function Bn(t){this._context=t}function jn(t){return new Bn(t)}function Hn(t){return t=0;--n)i[n]=(u[n]-i[n+1])/o[n];for(o[r-1]=(t[r]+i[r-1])/2,n=0;n1)for(var e,r,i=1,o=t[n[0]],u=o.length;i=0;)e[n]=n;return e}function ce(t,n){return t[n]}function se(){function t(t){var o,u,a=n.apply(this,arguments),c=t.length,s=a.length,f=new Array(s);for(o=0;o0){for(var e,r,i,o=0,u=t[0].length;o8&15|n>>4&240,n>>4&15|240&n,(15&n)16&255,t>>8&255,255&t,1)}function Me(t,n,e,r){return r\",i=n[3]||\"-\",o=n[4]||\"\",u=!!n[5],a=n[6]&&+n[6],c=!!n[7],s=n[8]&&+n[8].slice(1),f=n[9]||\"\";\"n\"===f?(c=!0,f=\"g\"):Eg[f]||(f=\"\"),(u||\"0\"===e&&\"=\"===r)&&(u=!0,e=\"0\",r=\"=\"),this.fill=e,this.align=r,this.sign=i,this.symbol=o,this.zero=u,this.width=a,this.comma=c,this.precision=s,this.type=f}function ui(t){return t}function ai(t){function n(t){function n(t){var n,i,c,g=d,m=v;if(\"c\"===p)m=_(t)+m,t=\"\";else{t=+t;var x=(t57){m=(46===c?o+t.slice(n+1):t.slice(n))+m,t=t.slice(0,n);break}}l&&!s&&(t=r(t,1/0));var b=g.length+t.length+m.length,w=b1)+g+t+m+w.slice(b)}return w+g+t+m}t=ii(t);var e=t.fill,u=t.align,a=t.sign,c=t.symbol,s=t.zero,f=t.width,l=t.comma,h=t.precision,p=t.type,d=\"$\"===c?i[0]:\"#\"===c&&/[boxX]/.test(p)?\"0\"+p.toLowerCase():\"\",v=\"$\"===c?i[1]:/[%p]/.test(p)?\"%\":\"\",_=Eg[p],y=!p||/[defgprs%]/.test(p);return h=null==h?p?6:12:/[gprs]/.test(p)?Math.max(1,Math.min(21,h)):Math.max(0,Math.min(20,h)),n.toString=function(){return t+\"\"},n}function e(t,e){var r=n((t=ii(t),t.type=\"f\",t)),i=3*Math.max(-8,Math.min(8,Math.floor(Kr(e)/3))),o=Math.pow(10,-i),u=Pg[8+i/3];return function(t){return r(o*t)+u}}var r=t.grouping&&t.thousands?ti(t.grouping,t.thousands):ui,i=t.currency,o=t.decimal;return{format:n,formatPrefix:e}}function ci(n){return zg=ai(n),t.format=zg.format,t.formatPrefix=zg.formatPrefix,zg}function si(t){return Math.max(0,-Kr(Math.abs(t)))}function fi(t,n){return Math.max(0,3*Math.max(-8,Math.min(8,Math.floor(Kr(n)/3)))-Kr(Math.abs(t)))}function li(t,n){return t=Math.abs(t),n=Math.abs(n)-t,Math.max(0,Kr(n)-Kr(t))+1}function hi(t){if(0E||r===E&&(N[0]||N[1]))&&(u+=k^w>=0?1:-1)}}return(ovv?this._.push(\"A\",e,\",\",e,\",0,1,\",f,\",\",t-u,\",\",n-a,\"A\",e,\",\",e,\",0,1,\",f,\",\",this._x1=c,\",\",this._y1=s):(l=hv),\",\",f,\",\",this._x1=t+e*Math.cos(i),\",\",this._y1=n+e*Math.sin(i))))},rect:function(t,n,e,r){this._.push(\"M\",this._x0=this._x1=+t,\",\",this._y0=this._y1=+n,\"h\",+e,\"v\",+r,\"h\",-e,\"Z\")},toString:function(){return this._.join(\"\")}};var _v=jt.prototype=Ht.prototype;_v.copy=function(){var t,n,e=new Ht(this._x,this._y,this._x0,this._y0,this._x1,this._y1),r=this._root;if(!r)return e;if(!r.length)return e._root=Xt(r),e;for(t=[{source:r,target:e._root=new Array(4)}];r=t.pop();)for(var i=0;i0)for(var r,i=t[0],o=n[0],u=t[e]-i,a=n[e]-o,c=-1;++c=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(t,n){switch(t=+t,n=+n,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,n):this._context.moveTo(t,n);break;case 1:this._point=2;default:if(this._t1?Zr(function(n){n.setTime(Math.floor(n/t)*t)},function(n,e){n.setTime(+n+e*t)},function(n,e){return(e-n)/t}):ky:null};var Sy=ky.range,Ny=1e3,Ay=6e4,Ey=36e5,Cy=864e5,zy=6048e5,Py=Zr(function(t){t.setTime(Math.floor(t/Ny)*Ny)},function(t,n){t.setTime(+t+n*Ny)},function(t,n){return(n-t)/Ny},function(t){return t.getUTCSeconds()}),qy=Py.range,Ly=Zr(function(t){t.setTime(Math.floor(t/Ay)*Ay)},function(t,n){t.setTime(+t+n*Ay)},function(t,n){return(n-t)/Ay},function(t){return t.getMinutes()}),Ry=Ly.range,Uy=Zr(function(t){var n=t.getTimezoneOffset()*Ay%Ey;n0?Zr(function(n){n.setFullYear(Math.floor(n.getFullYear()/t)*t),n.setMonth(0,1),n.setHours(0,0,0,0)},function(n,e){n.setFullYear(n.getFullYear()+e*t)}):null};var rg=eg.range,ig=Zr(function(t){t.setUTCSeconds(0,0)},function(t,n){t.setTime(+t+n*Ay)},function(t,n){return(n-t)/Ay},function(t){return t.getUTCMinutes()}),og=ig.range,ug=Zr(function(t){t.setUTCMinutes(0,0,0)},function(t,n){t.setTime(+t+n*Ey)},function(t,n){return(n-t)/Ey},function(t){return t.getUTCHours()}),ag=ug.range,cg=Zr(function(t){t.setUTCHours(0,0,0,0)},function(t,n){t.setUTCDate(t.getUTCDate()+n)},function(t,n){return(n-t)/Cy},function(t){return t.getUTCDate()-1}),sg=cg.range,fg=Jr(0),lg=Jr(1),hg=Jr(2),pg=Jr(3),dg=Jr(4),vg=Jr(5),_g=Jr(6),yg=fg.range,gg=lg.range,mg=hg.range,xg=pg.range,bg=dg.range,wg=vg.range,Mg=_g.range,Tg=Zr(function(t){t.setUTCDate(1),t.setUTCHours(0,0,0,0)},function(t,n){t.setUTCMonth(t.getUTCMonth()+n)},function(t,n){return n.getUTCMonth()-t.getUTCMonth()+12*(n.getUTCFullYear()-t.getUTCFullYear())},function(t){return t.getUTCMonth()}),kg=Tg.range,Sg=Zr(function(t){t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},function(t,n){t.setUTCFullYear(t.getUTCFullYear()+n)},function(t,n){return n.getUTCFullYear()-t.getUTCFullYear()},function(t){return t.getUTCFullYear()});Sg.every=function(t){return isFinite(t=Math.floor(t))&&t>0?Zr(function(n){n.setUTCFullYear(Math.floor(n.getUTCFullYear()/t)*t),n.setUTCMonth(0,1),n.setUTCHours(0,0,0,0)},function(n,e){n.setUTCFullYear(n.getUTCFullYear()+e*t)}):null};var Ng,Ag=Sg.range,Eg={\"\":ni,\"%\":function(t,n){return(100*t).toFixed(n)},b:function(t){return Math.round(t).toString(2)},c:function(t){return t+\"\"},d:function(t){return Math.round(t).toString(10)},e:function(t,n){return t.toExponential(n)},f:function(t,n){return t.toFixed(n)},g:function(t,n){return t.toPrecision(n)},o:function(t){return Math.round(t).toString(8)},p:function(t,n){return ri(100*t,n)},r:ri,s:ei,X:function(t){return Math.round(t).toString(16).toUpperCase()},x:function(t){return Math.round(t).toString(16)}},Cg=/^(?:(.)?([=^]))?([+\\-\\( ])?([$#])?(0)?(\\d+)?(,)?(\\.\\d+)?([a-z%])?$/i;oi.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?\"0\":\"\")+(null==this.width?\"\":Math.max(1,0|this.width))+(this.comma?\",\":\"\")+(null==this.precision?\"\":\".\"+Math.max(0,0|this.precision))+this.type};var zg,Pg=[\"y\",\"z\",\"a\",\"f\",\"p\",\"n\",\"µ\",\"m\",\"\",\"k\",\"M\",\"G\",\"T\",\"P\",\"E\",\"Z\",\"Y\"];ci({decimal:\".\",thousands:\",\",grouping:[3],currency:[\"$\",\"\"]});var qg,Lg={\"-\":\"\",_:\" \",0:\"0\"},Rg=/^\\s*\\d+/,Ug=/^%/,Dg=/[\\\\\\^\\$\\*\\+\\?\\|\\[\\]\\(\\)\\.\\{\\}]/g;so({dateTime:\"%x, %X\",date:\"%-m/%-d/%Y\",time:\"%-I:%M:%S %p\",periods:[\"AM\",\"PM\"],days:[\"Sunday\",\"Monday\",\"Tuesday\",\"Wednesday\",\"Thursday\",\"Friday\",\"Saturday\"],shortDays:[\"Sun\",\"Mon\",\"Tue\",\"Wed\",\"Thu\",\"Fri\",\"Sat\"],months:[\"January\",\"February\",\"March\",\"April\",\"May\",\"June\",\"July\",\"August\",\"September\",\"October\",\"November\",\"December\"],shortMonths:[\"Jan\",\"Feb\",\"Mar\",\"Apr\",\"May\",\"Jun\",\"Jul\",\"Aug\",\"Sep\",\"Oct\",\"Nov\",\"Dec\"]});var Og=\"%Y-%m-%dT%H:%M:%S.%LZ\",Fg=Date.prototype.toISOString?fo:t.utcFormat(Og),Ig=+new Date(\"2000-01-01T00:00:00.000Z\")?lo:t.utcParse(Og),Yg=Array.prototype,Bg=Yg.map,jg=Yg.slice,Hg={name:\"implicit\"},Xg=[0,1],Vg=1e3,Wg=60*Vg,$g=60*Wg,Zg=24*$g,Gg=7*Zg,Jg=30*Zg,Qg=365*Zg,Kg=Zo(\"1f77b4ff7f0e2ca02cd627289467bd8c564be377c27f7f7fbcbd2217becf\"),tm=Zo(\"393b795254a36b6ecf9c9ede6379398ca252b5cf6bcedb9c8c6d31bd9e39e7ba52e7cb94843c39ad494ad6616be7969c7b4173a55194ce6dbdde9ed6\"),nm=Zo(\"3182bd6baed69ecae1c6dbefe6550dfd8d3cfdae6bfdd0a231a35474c476a1d99bc7e9c0756bb19e9ac8bcbddcdadaeb636363969696bdbdbdd9d9d9\"),em=Zo(\"1f77b4aec7e8ff7f0effbb782ca02c98df8ad62728ff98969467bdc5b0d58c564bc49c94e377c2f7b6d27f7f7fc7c7c7bcbd22dbdb8d17becf9edae5\"),rm=$_(je(300,.5,0),je(-240,.5,1)),im=$_(je(-100,.75,.35),je(80,1.5,.8)),om=$_(je(260,.75,.35),je(80,1.5,.8)),um=je(),am=Jo(Zo(\"44015444025645045745055946075a46085c460a5d460b5e470d60470e6147106347116447136548146748166848176948186a481a6c481b6d481c6e481d6f481f70482071482173482374482475482576482677482878482979472a7a472c7a472d7b472e7c472f7d46307e46327e46337f463480453581453781453882443983443a83443b84433d84433e85423f854240864241864142874144874045884046883f47883f48893e49893e4a893e4c8a3d4d8a3d4e8a3c4f8a3c508b3b518b3b528b3a538b3a548c39558c39568c38588c38598c375a8c375b8d365c8d365d8d355e8d355f8d34608d34618d33628d33638d32648e32658e31668e31678e31688e30698e306a8e2f6b8e2f6c8e2e6d8e2e6e8e2e6f8e2d708e2d718e2c718e2c728e2c738e2b748e2b758e2a768e2a778e2a788e29798e297a8e297b8e287c8e287d8e277e8e277f8e27808e26818e26828e26828e25838e25848e25858e24868e24878e23888e23898e238a8d228b8d228c8d228d8d218e8d218f8d21908d21918c20928c20928c20938c1f948c1f958b1f968b1f978b1f988b1f998a1f9a8a1e9b8a1e9c891e9d891f9e891f9f881fa0881fa1881fa1871fa28720a38620a48621a58521a68522a78522a88423a98324aa8325ab8225ac8226ad8127ad8128ae8029af7f2ab07f2cb17e2db27d2eb37c2fb47c31b57b32b67a34b67935b77937b87838b9773aba763bbb753dbc743fbc7340bd7242be7144bf7046c06f48c16e4ac16d4cc26c4ec36b50c46a52c56954c56856c66758c7655ac8645cc8635ec96260ca6063cb5f65cb5e67cc5c69cd5b6ccd5a6ece5870cf5773d05675d05477d1537ad1517cd2507fd34e81d34d84d44b86d54989d5488bd6468ed64590d74393d74195d84098d83e9bd93c9dd93ba0da39a2da37a5db36a8db34aadc32addc30b0dd2fb2dd2db5de2bb8de29bade28bddf26c0df25c2df23c5e021c8e020cae11fcde11dd0e11cd2e21bd5e21ad8e219dae319dde318dfe318e2e418e5e419e7e419eae51aece51befe51cf1e51df4e61ef6e620f8e621fbe723fde725\")),cm=Jo(Zo(\"00000401000501010601010802010902020b02020d03030f03031204041405041606051806051a07061c08071e0907200a08220b09240c09260d0a290e0b2b100b2d110c2f120d31130d34140e36150e38160f3b180f3d19103f1a10421c10441d11471e114920114b21114e22115024125325125527125829115a2a115c2c115f2d11612f116331116533106734106936106b38106c390f6e3b0f703d0f713f0f72400f74420f75440f764510774710784910784a10794c117a4e117b4f127b51127c52137c54137d56147d57157e59157e5a167e5c167f5d177f5f187f601880621980641a80651a80671b80681c816a1c816b1d816d1d816e1e81701f81721f817320817521817621817822817922827b23827c23827e24828025828125818326818426818627818827818928818b29818c29818e2a81902a81912b81932b80942c80962c80982d80992d809b2e7f9c2e7f9e2f7fa02f7fa1307ea3307ea5317ea6317da8327daa337dab337cad347cae347bb0357bb2357bb3367ab5367ab73779b83779ba3878bc3978bd3977bf3a77c03a76c23b75c43c75c53c74c73d73c83e73ca3e72cc3f71cd4071cf4070d0416fd2426fd3436ed5446dd6456cd8456cd9466bdb476adc4869de4968df4a68e04c67e24d66e34e65e44f64e55064e75263e85362e95462ea5661eb5760ec5860ed5a5fee5b5eef5d5ef05f5ef1605df2625df2645cf3655cf4675cf4695cf56b5cf66c5cf66e5cf7705cf7725cf8745cf8765cf9785df9795df97b5dfa7d5efa7f5efa815ffb835ffb8560fb8761fc8961fc8a62fc8c63fc8e64fc9065fd9266fd9467fd9668fd9869fd9a6afd9b6bfe9d6cfe9f6dfea16efea36ffea571fea772fea973feaa74feac76feae77feb078feb27afeb47bfeb67cfeb77efeb97ffebb81febd82febf84fec185fec287fec488fec68afec88cfeca8dfecc8ffecd90fecf92fed194fed395fed597fed799fed89afdda9cfddc9efddea0fde0a1fde2a3fde3a5fde5a7fde7a9fde9aafdebacfcecaefceeb0fcf0b2fcf2b4fcf4b6fcf6b8fcf7b9fcf9bbfcfbbdfcfdbf\")),sm=Jo(Zo(\"00000401000501010601010802010a02020c02020e03021004031204031405041706041907051b08051d09061f0a07220b07240c08260d08290e092b10092d110a30120a32140b34150b37160b39180c3c190c3e1b0c411c0c431e0c451f0c48210c4a230c4c240c4f260c51280b53290b552b0b572d0b592f0a5b310a5c320a5e340a5f3609613809623909633b09643d09653e0966400a67420a68440a68450a69470b6a490b6a4a0c6b4c0c6b4d0d6c4f0d6c510e6c520e6d540f6d550f6d57106e59106e5a116e5c126e5d126e5f136e61136e62146e64156e65156e67166e69166e6a176e6c186e6d186e6f196e71196e721a6e741a6e751b6e771c6d781c6d7a1d6d7c1d6d7d1e6d7f1e6c801f6c82206c84206b85216b87216b88226a8a226a8c23698d23698f24699025689225689326679526679727669827669a28659b29649d29649f2a63a02a63a22b62a32c61a52c60a62d60a82e5fa92e5eab2f5ead305dae305cb0315bb1325ab3325ab43359b63458b73557b93556ba3655bc3754bd3853bf3952c03a51c13a50c33b4fc43c4ec63d4dc73e4cc83f4bca404acb4149cc4248ce4347cf4446d04545d24644d34743d44842d54a41d74b3fd84c3ed94d3dda4e3cdb503bdd513ade5238df5337e05536e15635e25734e35933e45a31e55c30e65d2fe75e2ee8602de9612bea632aeb6429eb6628ec6726ed6925ee6a24ef6c23ef6e21f06f20f1711ff1731df2741cf3761bf37819f47918f57b17f57d15f67e14f68013f78212f78410f8850ff8870ef8890cf98b0bf98c0af98e09fa9008fa9207fa9407fb9606fb9706fb9906fb9b06fb9d07fc9f07fca108fca309fca50afca60cfca80dfcaa0ffcac11fcae12fcb014fcb216fcb418fbb61afbb81dfbba1ffbbc21fbbe23fac026fac228fac42afac62df9c72ff9c932f9cb35f8cd37f8cf3af7d13df7d340f6d543f6d746f5d949f5db4cf4dd4ff4df53f4e156f3e35af3e55df2e661f2e865f2ea69f1ec6df1ed71f1ef75f1f179f2f27df2f482f3f586f3f68af4f88ef5f992f6fa96f8fb9af9fc9dfafda1fcffa4\")),fm=Jo(Zo(\"0d088710078813078916078a19068c1b068d1d068e20068f2206902406912605912805922a05932c05942e05952f059631059733059735049837049938049a3a049a3c049b3e049c3f049c41049d43039e44039e46039f48039f4903a04b03a14c02a14e02a25002a25102a35302a35502a45601a45801a45901a55b01a55c01a65e01a66001a66100a76300a76400a76600a76700a86900a86a00a86c00a86e00a86f00a87100a87201a87401a87501a87701a87801a87a02a87b02a87d03a87e03a88004a88104a78305a78405a78606a68707a68808a68a09a58b0aa58d0ba58e0ca48f0da4910ea3920fa39410a29511a19613a19814a099159f9a169f9c179e9d189d9e199da01a9ca11b9ba21d9aa31e9aa51f99a62098a72197a82296aa2395ab2494ac2694ad2793ae2892b02991b12a90b22b8fb32c8eb42e8db52f8cb6308bb7318ab83289ba3388bb3488bc3587bd3786be3885bf3984c03a83c13b82c23c81c33d80c43e7fc5407ec6417dc7427cc8437bc9447aca457acb4679cc4778cc4977cd4a76ce4b75cf4c74d04d73d14e72d24f71d35171d45270d5536fd5546ed6556dd7566cd8576bd9586ada5a6ada5b69db5c68dc5d67dd5e66de5f65de6164df6263e06363e16462e26561e26660e3685fe4695ee56a5de56b5de66c5ce76e5be76f5ae87059e97158e97257ea7457eb7556eb7655ec7754ed7953ed7a52ee7b51ef7c51ef7e50f07f4ff0804ef1814df1834cf2844bf3854bf3874af48849f48948f58b47f58c46f68d45f68f44f79044f79143f79342f89441f89540f9973ff9983ef99a3efa9b3dfa9c3cfa9e3bfb9f3afba139fba238fca338fca537fca636fca835fca934fdab33fdac33fdae32fdaf31fdb130fdb22ffdb42ffdb52efeb72dfeb82cfeba2cfebb2bfebd2afebe2afec029fdc229fdc328fdc527fdc627fdc827fdca26fdcb26fccd25fcce25fcd025fcd225fbd324fbd524fbd724fad824fada24f9dc24f9dd25f8df25f8e125f7e225f7e425f6e626f6e826f5e926f5eb27f4ed27f3ee27f3f027f2f227f1f426f1f525f0f724f0f921\")),lm=\"http://www.w3.org/1999/xhtml\",hm={ svg:\"http://www.w3.org/2000/svg\",xhtml:lm,xlink:\"http://www.w3.org/1999/xlink\",xml:\"http://www.w3.org/XML/1998/namespace\",xmlns:\"http://www.w3.org/2000/xmlns/\"},pm=0;iu.prototype=ru.prototype={constructor:iu,get:function(t){for(var n=this._;!(n in t);)if(!(t=t.parentNode))return;return t[n]},set:function(t,n){return t[this._]=n},remove:function(t){return this._ in t&&delete t[this._]},toString:function(){return this._}};var dm=function(t){return function(){return this.matches(t)}};if(\"undefined\"!=typeof document){var vm=document.documentElement;if(!vm.matches){var _m=vm.webkitMatchesSelector||vm.msMatchesSelector||vm.mozMatchesSelector||vm.oMatchesSelector;dm=function(t){return function(){return _m.call(this,t)}}}}var ym=dm,gm={};if(t.event=null,\"undefined\"!=typeof document){var mm=document.documentElement;\"onmouseenter\"in mm||(gm={mouseenter:\"mouseover\",mouseleave:\"mouseout\"})}Tu.prototype={constructor:Tu,appendChild:function(t){return this._parent.insertBefore(t,this._next)},insertBefore:function(t,n){return this._parent.insertBefore(t,n)},querySelector:function(t){return this._parent.querySelector(t)},querySelectorAll:function(t){return this._parent.querySelectorAll(t)}};var xm=\"$\";ia.prototype={add:function(t){var n=this._names.indexOf(t);n=0&&(this._names.splice(n,1),this._node.setAttribute(\"class\",this._names.join(\" \")))},contains:function(t){return this._names.indexOf(t)>=0}};var bm=[null];qa.prototype=La.prototype={constructor:qa,select:yu,selectAll:xu,filter:bu,data:Au,enter:Mu,exit:Eu,merge:Cu,order:zu,sort:Pu,call:Lu,nodes:Ru,node:Uu,size:Du,empty:Ou,each:Fu,attr:Vu,style:Ju,property:na,classed:fa,text:da,html:ga,raise:xa,lower:wa,append:Ma,insert:ka,remove:Na,datum:Aa,on:fu,dispatch:Pa};var wm=Mr(\"start\",\"end\",\"interrupt\"),Mm=[],Tm=0,km=1,Sm=2,Nm=3,Am=4,Em=5,Cm=La.prototype.constructor,zm=0,Pm=La.prototype;Uc.prototype=Dc.prototype={constructor:Uc,select:wc,selectAll:Mc,filter:vc,merge:_c,selection:Tc,transition:Rc,call:Pm.call,nodes:Pm.nodes,node:Pm.node,size:Pm.size,empty:Pm.empty,each:Pm.each,on:mc,attr:rc,attrTween:uc,style:Ec,styleTween:zc,text:Lc,remove:bc,tween:$a,delay:sc,duration:hc,ease:dc};var qm={time:null,delay:0,duration:250,ease:et};La.prototype.interrupt=Xa,La.prototype.transition=Ic;var Lm=[null],Rm=Array.prototype.slice,Um=1,Dm=2,Om=3,Fm=4,Im=1e-6;ws.prototype=ys.prototype={constructor:ws,each:us,eachAfter:cs,eachBefore:as,sum:ss,sort:fs,path:ls,ancestors:ps,descendants:ds,leaves:vs,links:_s,copy:gs};var Ym=\"$\",Bm={depth:-1},jm={};of.prototype=Object.create(ws.prototype);var Hm=(1+Math.sqrt(5))/2,Xm=function t(n){function e(t,e,r,i,o){sf(n,t,e,r,i,o)}return e.ratio=function(n){return t((n=+n)>1?n:1)},e}(Hm),Vm=function t(n){function e(t,e,r,i,o){if((u=t._squarify)&&u.ratio===n)for(var u,a,c,s,f,l=-1,h=u.length,p=t.value;++l"}],"posts":[{"title":"(转)一个基于Angular4+Bootstrap4+Scss的后台管理系统界面","slug":"angular4-example","date":"2018-07-07T06:37:36.000Z","updated":"2018-07-07T06:50:03.703Z","comments":true,"path":"2018/07/07/angular4-example/","link":"","permalink":"https://www.xunhanliu.top/2018/07/07/angular4-example/","excerpt":"","text":"原文链接系统演示链接源码链接","categories":[{"name":"project","slug":"project","permalink":"https://www.xunhanliu.top/categories/project/"}],"tags":[{"name":"angular4","slug":"angular4","permalink":"https://www.xunhanliu.top/tags/angular4/"}]},{"title":"如何在hexo上编写高级markdown","slug":"advanced-markdown","date":"2018-07-06T18:17:00.000Z","updated":"2018-07-06T20:46:27.049Z","comments":true,"path":"2018/07/07/advanced-markdown/","link":"","permalink":"https://www.xunhanliu.top/2018/07/07/advanced-markdown/","excerpt":"","text":"附上一个优秀的博客链接 钻石&emsp;&emsp;我们都知道markdown可以嵌入html代码的。比如想把一段文字加个背景色。可以这样写（直接写就行）：1&lt;p style=\"background-color: #f00;\"&gt;一段文字&lt;p&gt; 效果：一段文字。可见，它完全按照自己的想法执行。这是高级一点的用法。&emsp;&emsp;下图是一个例子1&lt;p style=\"color: #0f0;\"&gt;外联style&lt;p&gt; 而前面的标题使用markdown语法写的。结果理想。不过左侧有点问题，就是标题的问题。就是我们使用标题的时候，一定要先出现高级标题，然后才能出现低级标题（正常的思路，类似文章的章节一样）。文档使用的模板是MIHO。&emsp;&emsp;下图是高级用法的一个例子：你没有看错，所有的标签与markdown的标志都正确的解析了！！相关部分源码如下：123456789101112131415161718More info: [Generating](https://hexo.io/docs/generating.html)### Deploy to remote sites*** bash$ hexo deploy***More info: [Deployment](https://hexo.io/docs/deployment.html)&lt;div style=\"background-color: #f00;\"&gt;内联style&lt;/div&gt;---# 又一个title---&lt;h2 class=\"headerlink\"&gt;h2标签&lt;/h2&gt;&lt;link href=\"../../../../css/test.css\" rel=\"stylesheet\" /&gt;&lt;div id=\"outCSS\"&gt;外联style&lt;/div&gt;# 再来一个title &emsp;&emsp;至此，你可能会觉得，哦，原来混合编辑这么简单！对钻石就这么简单。&emsp;&emsp;再看一个例子:下图中的点图都是可以交互的！所以他们肯定是一个大的div。我们可以看到，最左侧的标题5，是没有正确解析的，不止如此，我又在div的两头各加了一个&lt;br&gt;。经检查发现，文档中某些地方出现非标准的标签比如&lt;dt-div&gt;&lt;/dt-div&gt; 。但是可以肯定的是下图中的几个标签都是div。 王者&emsp;&emsp;我把这些非标准的标签都换成div后，网页形式就变成了这样https://www.xunhanliu.top/2018/07/07/md+html_complex/ 。不像我们一开始想的那样。第一个大div后的markdown标签都没有正确解析，而像把它们放在了p标签里了一样。不过这已经很接近我们的布局了：加几个&lt;br&gt; ,把标题手动更改成h标签。&emsp;&emsp;所以结论是，简单的标签直接写就能完美解析，像div这种高级标签，此标签后面的内容，一般不会得到markdown编译。 附：不一定是.md后缀，也可以是.html后缀&emsp;&emsp;对于复杂的笔记，不一定要用markdown语法去写，我可以全部使用html。不过有些人可能觉得有点麻烦。这里提供一个新的思路：先用markdown写出大体的框架来，把写div标签的空间留下来。然后编译，找到编译后的文件，复制粘贴。笔记后缀名不一定是.md，也可以是html！见：https://www.xunhanliu.top/2018/07/06/t-sne_how_use .不过你可以使用前面的方法编写，更加简单！说明：这一篇我用了大概3个小时去找bug，前面那一篇我只用了两分钟。可能是有做完第一篇的基础吧。不过使用先编译，再复制粘贴的方法，容易在标签开闭、漏写上犯错（me too!），况且使用hexo编译后也不报错（可能觉得，大不了我把你这全部便签都看成普通文本）。然后访问网址，出现了一个奇葩的错误，浏览器竟然改了我某个js文件。。。各种心酸历程！ 附2：爬网页文件：webzip ，绝对良心软件！","categories":[{"name":"markdown","slug":"markdown","permalink":"https://www.xunhanliu.top/categories/markdown/"}],"tags":[{"name":"markdown","slug":"markdown","permalink":"https://www.xunhanliu.top/tags/markdown/"}]},{"title":"md+html_complex","slug":"md+html_complex","date":"2018-07-06T18:16:24.000Z","updated":"2018-07-06T19:01:31.410Z","comments":true,"path":"2018/07/07/md+html_complex/","link":"","permalink":"https://www.xunhanliu.top/2018/07/07/md+html_complex/","excerpt":"","text":"t-sen第一贱开锋1、简介原文链接&emsp;&emsp;t-sen（非线性）在2008年首次被 Maaten and Hinton引入(PDF)，在机器学习领域应用很广泛。它能把多维数据映射到2维数据，从而在二维平面上显示（分别对应直角坐标系的x,y。此时横纵坐标是无意义的。例如，x不是某几个维度的线性组合，所以没法解释x轴表示什么意义。其他的降维方法，降维至2维平面上也可以这样显示）。当参数调整不合适的时候，整个图像容易被误读。&emsp;&emsp;这里主要关注它的参数：“perplexity”。这个参数从某种意义上来说，是对邻居点的猜测。一般取55到50。注：t-sen每次输出的图像都是不固定。 #tray-container { width: 100%; position: fixed; top: 0; left: 0; z-index: 100; top: -410px; transition: top 0.3s; } #tray { position: relative; border: 2px solid steelblue; background: white; padding: 24px 24px 60px 24px; box-shadow: 0px 2px 24px rgba(0, 0, 0, 0.2); box-sizing: border-box; margin: 0 auto; height: 380px; display: flex; justify-content: center; max-width: 700px; border-radius: 4px; } #tray-container.modal { top: -4px; } #tray-content { width: 55%; height: 100%; font-size: 12px; position: relative; top: -12px; } #tray-content canvas { width: 100%; } #tray-options { padding-left: 36px; font-size: 13px; line-height: 1.5em; height: 100%; width: 45%; } #tray-options #tray-controls { margin-bottom: 24px; display: flex; align-items: center; } #tray-controls button { cursor: pointer; outline: none; border-radius: 50%; background: steelblue; color: white; width: 48px; height: 48px; border: none; margin-right: 12px; } #tray-controls .play-pause i { display: none; font-size: 30px; } #tray-controls .play-pause.paused i:nth-child(1) { display: block; } #tray-controls .play-pause.playing i:nth-child(2) { display: block; } #tray-steps-display { text-align: center; width: 48px; font-size: 15px; } #tray input { margin-bottom: 12px; margin-left: -2px; } #tray-data-sliders { } #tray-tsne-sliders { } #tray-close { cursor: pointer; outline: none; background: white; border: none; text-align: center; position: absolute; bottom: 0; width: 100%; padding: 6px 0; background: #f0f4f5; opacity: 0.6; color: steelblue; left: 0; } #tray-close:hover { opacity: 1; } play_arrow pause refresh Step: expand_less // This depends on playground.js having setup the GLOBAL object function runTrayState() { // Set up t-SNE and start it running. var state = GLOBALS.trayState; var points = state.demo.generator.apply(null, state.demoParams); var canvas = d3.select(\"#tray-content canvas\").node() // if there was already a playground demo going, lets destroy it and make a new one if(GLOBALS.trayDemo) { GLOBALS.trayDemo.destroy(); delete GLOBALS.trayDemo; } GLOBALS.trayDemo = demoMaker(points, canvas, state, function(step) { d3.select(\"#tray-controls .step\").text(step); if(step >= state.stepLimit && !GLOBALS.trayUnpausedBefore) { setTrayRunning(false) } }) GLOBALS.trayUnpausedBefore = false; setTrayRunning(true); } function updateTraySliders() { // we regenerate all the sliders from scratch // we modify the global tray state when a slider is modified var state = GLOBALS.trayState; var dataSliders = d3.select('#tray-data-sliders'); dataSliders.html(''); state.demo.options.map(function(option, i) { var value = state.demoParams[i]; var slider = makeTraySlider(dataSliders.node(), option.name, option.min, option.max, value, function() { // when this one updates we change the appropriate state GLOBALS.trayState.demoParams[i] = +slider.value runTrayState(); }); }); var tsneSliders = d3.select('#tray-tsne-sliders'); tsneSliders.html(''); var perpSlider = makeTraySlider(tsneSliders.node(), \"Perplexity\", 1, 100, state.perplexity, function() { GLOBALS.trayState.perplexity = perpSlider.value runTrayState(); }); var epsSlider = makeTraySlider(tsneSliders.node(), \"Epsilon\", 1, 20, state.epsilon, function() { GLOBALS.trayState.epsilon = epsSlider.value runTrayState(); }); } function makeTraySlider(container, name, min, max, start, changeCallback) { var dis = d3.select(container) dis.append(\"span\").classed(\"slider-label-\" + name, true) .text(name + ' ') var value = dis.append(\"span\").classed(\"slider-value-\" + name, true) .text(start) var slider = dis.append(\"input\") .attr(\"type\", \"range\") .attr(\"min\", min) .attr(\"max\", max) .attr(\"value\", start) .on(\"change\", changeCallback) .on(\"input\", function() { value.text(slider.node().value); }) return slider.node(); } /* Activate the tray */ function updateStateFromFigure(figure, example, el) { var y = el.getBoundingClientRect().top; var demo = demosByName[figure.dataset]; var state = { demo: demos[demo.index], demoParams: figure.params.map(function(d) { return d}), perplexity: example.perplexity, epsilon: example.epsilon, stepLimit: example.step } GLOBALS.trayState = state; runTrayState() updateTraySliders() d3.select(\"#tray-container\").classed(\"modal\", true) GLOBALS.trayOpen = true; } d3.select(\"body\").on(\"keydown\", function() { if(d3.event.keyCode === 27) { setTrayRunning(false) d3.select(\"#tray-container\").classed(\"modal\", false); d3.selectAll(\".runner\").classed(\"selected\", false); } }) d3.select(\"#tray-close\").on(\"click\", function() { setTrayRunning(false); GLOBALS.trayOpen = false; d3.select(\"#tray-container\").classed(\"modal\", false) d3.selectAll(\".runner\").classed(\"selected\", false); }) /* Tray Controls */ var trayPlay = d3.select(\"#tray-controls .play-pause\") function setTrayRunning(r) { GLOBALS.running = r; if (GLOBALS.running) { GLOBALS.trayDemo.unpause(); trayPlay .classed(\"playing\", true) .classed(\"paused\", false); } else { GLOBALS.trayDemo.pause(); trayPlay .classed(\"playing\", false) .classed(\"paused\", true); } } // Hook up play / pause / restart buttons. trayPlay.on(\"click\", function() { GLOBALS.trayUnpausedBefore = true; setTrayRunning(!GLOBALS.running); }); var trayRestart = d3.select(\"#tray-controls .restart\") .on(\"click\", function() { runTrayState(); }) d3.select(window).on(\"scroll.tray\", function() { if(GLOBALS.trayOpen) { if(scrollY < 1000) { setTrayRunning(false); GLOBALS.trayOpen = false; d3.select(\"#tray-container\").classed(\"modal\", false); d3.selectAll(\".runner\").classed(\"selected\", false); } } }); /* Tray sliders */ #playground { overflow: hidden; font-family: 'Open Sans', sans-serif; border-top: 1px solid rgba(0, 0, 0, 0.1); /*border-bottom: 1px solid rgba(0, 0, 0, 0.1);*/ margin-top: 36px; padding: 36px 0 0 0; /*background: #fcfcfc;*/ z-index: 1000; } #playground * { box-sizing: border-box; } #playground.modal { position: fixed; left: 10px; right: 10px; top: 50px; } /* Playground Canvas */ #playground-canvas { float: left; width: 55%; } #playground-canvas canvas { width: 100%; } /* Data Menu */ #data-menu { /*float: left;*/ /*width: 25%*/ width: 40%; float: left; margin-bottom: 24px; overflow: hidden; margin-left: 5%; } #data-menu .demo-data { cursor: pointer; position: relative; font-size: 10px; line-height: 1.2em; box-sizing: border-box; float: left; margin: 2px; padding: 4px; width: calc(33% - 4px); background: white; border: 1px solid rgba(0, 0, 0, 0.1); border-radius: 4px; box-shadow: 0 0 3px rgba(0, 0, 0, 0.08); } @media(min-width: 480px) { #data-menu .demo-data { width: calc(25% - 8px); padding: 8px; margin: 4px; } } @media(min-width: 768px) { #data-menu .demo-data { width: calc(16.5% - 8px); padding: 8px; margin: 4px; } } #data-menu .demo-data:hover { border: 1px solid rgba(0, 0, 0, 0.2); } #data-menu .demo-data.selected::after { content: \"\"; border: 2px solid rgba(70, 130, 180, 0.8); width: 100%; height: 100%; position: absolute; top: 0; left: 0; box-sizing: border-box; border-radius: 4px; } #data-menu .demo-data span { display: none; } #data-menu .demo-data:hover canvas { opacity: 1; } #data-menu .demo-data canvas { width: 100%; opacity: 0.3; } #data-menu .demo-data.selected canvas { opacity: 1; } /* Data Details */ #data-details { position: relative; } @media(min-width: 768px) { #data-details { width: 40%; float: right; } } #data-details #data-controls { width: 40%; float: right; position: relative; overflow: hidden; font-size: 13px; } @media(min-width: 768px) { #data-details #data-controls { width: 50%; margin-right: 10%; float: left; } } #data-details #play-controls { margin-bottom: 18px; overflow: hidden; position: relative; } #data-details #play-controls button { cursor: pointer; outline: none; border-radius: 50%; background: steelblue; color: white; width: 25%; margin-right: 5%; padding-top: 25%; padding-bottom: 0; border: none; float: left; position: relative; } #play-controls i { display: block; position: absolute; top: 50%; left: 0; width: 100%; height: 36px; font-size: 24px; line-height: 0; } @media(min-width: 768px) { #play-controls i { font-size: 30px; } } #play-controls #play-pause i { display: none; position: absolute; } #play-controls #play-pause.paused i:nth-child(1) { display: block; } #play-controls #play-pause.playing i:nth-child(2) { display: block; } #steps-display { float: left; text-align: center; width: 25%; line-height: 1.5em; font-size: 13px; } @media(min-width: 1024px) { #steps-display { font-size: 16px; line-height: 1.6em; } } #data-details #data-description { width: 50%; margin-right: 10%; float: right; font-size: 14px; line-height: 1.6em; } @media(min-width: 768px) { #data-details #data-description { width: 40%; float: left; margin-right: 0; } } /* Options */ #data-details #options { float: left; padding-left: 36px; font-size: 13px; line-height: 1.5em; width: 45%; } #data-details input { display: block; width: 100%; margin: 8px 0 16px 0; } #options #data-options { width: 45%; margin-left: 4px; } #options #tsne-options { width: 45%; margin-left: 4px; } #data-details #share { margin-top: 8px; display: block; color: rgba(0, 0, 0, 0.4); text-decoration: none; font-size: 12px; } #data-details #share:hover { text-decoration: underline; } #data-details #share i { line-height: 0px; position: relative; top: 7px; } play_arrowpause refresh Step link Share this view ### 2、初步体验perplexity参数和step参数 &emsp;&emsp;上图由于perplexity参数的不同，呈现出不同的结果（每个图都执行了5000次迭代）。最重要的是在它们达到稳定状态的时候，如何解释！ &emsp;&emsp;上图的perplexity都是 30，而step分别是：10、20、60、120、1000。没有固定的步数，不同的数据集需要不同的迭代次数来收敛。不同的数据集可能聚合成相似的结果。 ### 3、簇的大小无意义 &emsp;&emsp;想一下这个问题：有两簇数据，它们的标准差不一样，是不是意味着标准差越小，簇越小？ &emsp;&emsp;上图中，一个簇的分散程度是另一个簇的10倍（点数应该是一样的）。调整perplexity，结果如上。结论是：簇的大小无意义。 ### 4、簇之间的距离可能无意义 &emsp;&emsp;问题：距离越近是不是关系越强？ &emsp;&emsp;上图中初始点是3簇，它们均有50点，均满足高斯分布。一对的距离是另一对的5倍。 &emsp;&emsp;上图实验结果如下：perplexity=50的时候，几何结构非常好。","categories":[{"name":"test","slug":"test","permalink":"https://www.xunhanliu.top/categories/test/"}],"tags":[{"name":"test","slug":"test","permalink":"https://www.xunhanliu.top/tags/test/"}]},{"title":"t-sne之初体验","slug":"t-sne_how_use","date":"2018-07-05T17:00:00.000Z","updated":"2018-07-06T18:49:56.854Z","comments":true,"path":"2018/07/06/t-sne_how_use/","link":"","permalink":"https://www.xunhanliu.top/2018/07/06/t-sne_how_use/","excerpt":"","text":"t-sen第一贱开锋1、简介 原文链接&emsp;&emsp;t-sen（非线性）在2008年首次被 van der Maaten and Hinton in 2008 [1] 引入，在机器学习领域应用很广泛。它能把多维数据映射到2维数据，从而在二维平面上显示（分别对应直角坐标系的x,y。此时横纵坐标是无意义的。例如，x不是某几个维度的线性组合，所以没法解释x轴表示什么意义。其他的降维方法，降维至2维平面上也可以这样显示）。当参数调整不合适的时候，整个图像容易被误读。&emsp;&emsp;这里主要关注它的参数：“perplexity”。这个参数从某种意义上来说，是对邻居点的猜测。一般取55到50。注：t-sen每次输出的图像都是不固定。 #tray-container { width: 100%; position: fixed; top: 0; left: 0; z-index: 100; top: -410px; transition: top 0.3s; } #tray { position: relative; border: 2px solid steelblue; background: white; padding: 24px 24px 60px 24px; box-shadow: 0px 2px 24px rgba(0, 0, 0, 0.2); box-sizing: border-box; margin: 0 auto; height: 380px; display: flex; justify-content: center; max-width: 700px; border-radius: 4px; } #tray-container.modal { top: -4px; } #tray-content { width: 55%; height: 100%; font-size: 12px; position: relative; top: -12px; } #tray-content canvas { width: 100%; } #tray-options { padding-left: 36px; font-size: 13px; line-height: 1.5em; height: 100%; width: 45%; } #tray-options #tray-controls { margin-bottom: 24px; display: flex; align-items: center; } #tray-controls button { cursor: pointer; outline: none; border-radius: 50%; background: steelblue; color: white; width: 48px; height: 48px; border: none; margin-right: 12px; } #tray-controls .play-pause i { display: none; font-size: 30px; } #tray-controls .play-pause.paused i:nth-child(1) { display: block; } #tray-controls .play-pause.playing i:nth-child(2) { display: block; } #tray-steps-display { text-align: center; width: 48px; font-size: 15px; } #tray input { margin-bottom: 12px; margin-left: -2px; } #tray-data-sliders { } #tray-tsne-sliders { } #tray-close { cursor: pointer; outline: none; background: white; border: none; text-align: center; position: absolute; bottom: 0; width: 100%; padding: 6px 0; background: #f0f4f5; opacity: 0.6; color: steelblue; left: 0; } #tray-close:hover { opacity: 1; } play_arrow pause refresh Step: expand_less // This depends on playground.js having setup the GLOBAL object function runTrayState() { // Set up t-SNE and start it running. var state = GLOBALS.trayState; var points = state.demo.generator.apply(null, state.demoParams); var canvas = d3.select(\"#tray-content canvas\").node() // if there was already a playground demo going, lets destroy it and make a new one if(GLOBALS.trayDemo) { GLOBALS.trayDemo.destroy(); delete GLOBALS.trayDemo; } GLOBALS.trayDemo = demoMaker(points, canvas, state, function(step) { d3.select(\"#tray-controls .step\").text(step); if(step >= state.stepLimit && !GLOBALS.trayUnpausedBefore) { setTrayRunning(false) } }) GLOBALS.trayUnpausedBefore = false; setTrayRunning(true); } function updateTraySliders() { // we regenerate all the sliders from scratch // we modify the global tray state when a slider is modified var state = GLOBALS.trayState; var dataSliders = d3.select('#tray-data-sliders'); dataSliders.html(''); state.demo.options.map(function(option, i) { var value = state.demoParams[i]; var slider = makeTraySlider(dataSliders.node(), option.name, option.min, option.max, value, function() { // when this one updates we change the appropriate state GLOBALS.trayState.demoParams[i] = +slider.value runTrayState(); }); }); var tsneSliders = d3.select('#tray-tsne-sliders'); tsneSliders.html(''); var perpSlider = makeTraySlider(tsneSliders.node(), \"Perplexity\", 1, 100, state.perplexity, function() { GLOBALS.trayState.perplexity = perpSlider.value runTrayState(); }); var epsSlider = makeTraySlider(tsneSliders.node(), \"Epsilon\", 1, 20, state.epsilon, function() { GLOBALS.trayState.epsilon = epsSlider.value runTrayState(); }); } function makeTraySlider(container, name, min, max, start, changeCallback) { var dis = d3.select(container) dis.append(\"span\").classed(\"slider-label-\" + name, true) .text(name + ' ') var value = dis.append(\"span\").classed(\"slider-value-\" + name, true) .text(start) var slider = dis.append(\"input\") .attr(\"type\", \"range\") .attr(\"min\", min) .attr(\"max\", max) .attr(\"value\", start) .on(\"change\", changeCallback) .on(\"input\", function() { value.text(slider.node().value); }) return slider.node(); } /* Activate the tray */ function updateStateFromFigure(figure, example, el) { var y = el.getBoundingClientRect().top; var demo = demosByName[figure.dataset]; var state = { demo: demos[demo.index], demoParams: figure.params.map(function(d) { return d}), perplexity: example.perplexity, epsilon: example.epsilon, stepLimit: example.step } GLOBALS.trayState = state; runTrayState() updateTraySliders() d3.select(\"#tray-container\").classed(\"modal\", true) GLOBALS.trayOpen = true; } d3.select(\"body\").on(\"keydown\", function() { if(d3.event.keyCode === 27) { setTrayRunning(false) d3.select(\"#tray-container\").classed(\"modal\", false); d3.selectAll(\".runner\").classed(\"selected\", false); } }) d3.select(\"#tray-close\").on(\"click\", function() { setTrayRunning(false); GLOBALS.trayOpen = false; d3.select(\"#tray-container\").classed(\"modal\", false) d3.selectAll(\".runner\").classed(\"selected\", false); }) /* Tray Controls */ var trayPlay = d3.select(\"#tray-controls .play-pause\") function setTrayRunning(r) { GLOBALS.running = r; if (GLOBALS.running) { GLOBALS.trayDemo.unpause(); trayPlay .classed(\"playing\", true) .classed(\"paused\", false); } else { GLOBALS.trayDemo.pause(); trayPlay .classed(\"playing\", false) .classed(\"paused\", true); } } // Hook up play / pause / restart buttons. trayPlay.on(\"click\", function() { GLOBALS.trayUnpausedBefore = true; setTrayRunning(!GLOBALS.running); }); var trayRestart = d3.select(\"#tray-controls .restart\") .on(\"click\", function() { runTrayState(); }) d3.select(window).on(\"scroll.tray\", function() { if(GLOBALS.trayOpen) { if(scrollY < 1000) { setTrayRunning(false); GLOBALS.trayOpen = false; d3.select(\"#tray-container\").classed(\"modal\", false); d3.selectAll(\".runner\").classed(\"selected\", false); } } }); /* Tray sliders */ #playground { overflow: hidden; font-family: 'Open Sans', sans-serif; border-top: 1px solid rgba(0, 0, 0, 0.1); /*border-bottom: 1px solid rgba(0, 0, 0, 0.1);*/ margin-top: 36px; padding: 36px 0 0 0; /*background: #fcfcfc;*/ z-index: 1000; } #playground * { box-sizing: border-box; } #playground.modal { position: fixed; left: 10px; right: 10px; top: 50px; } /* Playground Canvas */ #playground-canvas { float: left; width: 55%; } #playground-canvas canvas { width: 100%; } /* Data Menu */ #data-menu { /*float: left;*/ /*width: 25%*/ width: 40%; float: left; margin-bottom: 24px; overflow: hidden; margin-left: 5%; } #data-menu .demo-data { cursor: pointer; position: relative; font-size: 10px; line-height: 1.2em; box-sizing: border-box; float: left; margin: 2px; padding: 4px; width: calc(33% - 4px); background: white; border: 1px solid rgba(0, 0, 0, 0.1); border-radius: 4px; box-shadow: 0 0 3px rgba(0, 0, 0, 0.08); } @media(min-width: 480px) { #data-menu .demo-data { width: calc(25% - 8px); padding: 8px; margin: 4px; } } @media(min-width: 768px) { #data-menu .demo-data { width: calc(16.5% - 8px); padding: 8px; margin: 4px; } } #data-menu .demo-data:hover { border: 1px solid rgba(0, 0, 0, 0.2); } #data-menu .demo-data.selected::after { content: \"\"; border: 2px solid rgba(70, 130, 180, 0.8); width: 100%; height: 100%; position: absolute; top: 0; left: 0; box-sizing: border-box; border-radius: 4px; } #data-menu .demo-data span { display: none; } #data-menu .demo-data:hover canvas { opacity: 1; } #data-menu .demo-data canvas { width: 100%; opacity: 0.3; } #data-menu .demo-data.selected canvas { opacity: 1; } /* Data Details */ #data-details { position: relative; } @media(min-width: 768px) { #data-details { width: 40%; float: right; } } #data-details #data-controls { width: 40%; float: right; position: relative; overflow: hidden; font-size: 13px; } @media(min-width: 768px) { #data-details #data-controls { width: 50%; margin-right: 10%; float: left; } } #data-details #play-controls { margin-bottom: 18px; overflow: hidden; position: relative; } #data-details #play-controls button { cursor: pointer; outline: none; border-radius: 50%; background: steelblue; color: white; width: 25%; margin-right: 5%; padding-top: 25%; padding-bottom: 0; border: none; float: left; position: relative; } #play-controls i { display: block; position: absolute; top: 50%; left: 0; width: 100%; height: 36px; font-size: 24px; line-height: 0; } @media(min-width: 768px) { #play-controls i { font-size: 30px; } } #play-controls #play-pause i { display: none; position: absolute; } #play-controls #play-pause.paused i:nth-child(1) { display: block; } #play-controls #play-pause.playing i:nth-child(2) { display: block; } #steps-display { float: left; text-align: center; width: 25%; line-height: 1.5em; font-size: 13px; } @media(min-width: 1024px) { #steps-display { font-size: 16px; line-height: 1.6em; } } #data-details #data-description { width: 50%; margin-right: 10%; float: right; font-size: 14px; line-height: 1.6em; } @media(min-width: 768px) { #data-details #data-description { width: 40%; float: left; margin-right: 0; } } /* Options */ #data-details #options { float: left; padding-left: 36px; font-size: 13px; line-height: 1.5em; width: 45%; } #data-details input { display: block; width: 100%; margin: 8px 0 16px 0; } #options #data-options { width: 45%; margin-left: 4px; } #options #tsne-options { width: 45%; margin-left: 4px; } #data-details #share { margin-top: 8px; display: block; color: rgba(0, 0, 0, 0.4); text-decoration: none; font-size: 12px; } #data-details #share:hover { text-decoration: underline; } #data-details #share i { line-height: 0px; position: relative; top: 7px; } play_arrowpause refresh Step link Share this view 2、初步体验perplexity参数和step参数 &emsp;&emsp;上图由于perplexity参数的不同，呈现出不同的结果（每个图都执行了5000次迭代）。最重要的是在它们达到稳定状态的时候，如何解释！ &emsp;&emsp;上图的perplexity都是 30，而step分别是：10、20、60、120、1000。没有固定的步数，不同的数据集需要不同的迭代次数来收敛。不同的数据集可能聚合成相似的结果。 3、簇的大小无意义 &emsp;&emsp;想一下这个问题：有两簇数据，它们的标准差不一样，是不是意味着标准差越小，簇越小？ &emsp;&emsp;上图中，一个簇的分散程度是另一个簇的10倍（点数应该是一样的）。调整perplexity，结果如上。结论是：簇的大小无意义。 4、簇之间的距离可能无意义 &emsp;&emsp;问题：距离越近是不是关系越强？ &emsp;&emsp;上图中初始点是3簇，它们均有50点，均满足高斯分布。一对的距离是另一对的5倍。&emsp;&emsp;上图实验结果如下：perplexity=50的时候，几何结构非常好。&lt;50的时候，它们间距都差不多。=100的时候，其中一个簇非常小。=50的时候，结果非常“理想”，是不是意味着设置成50，我们总能看到好的结果？&emsp;&emsp;Sadly,no！如果我们增加了点数，就需要增加perplexity进行补偿。下面这个实验吧点数增加到200。 5、随机点的结果并不总是随机的 &emsp;&emsp;一个典型的陷阱是，你在真正的随机数据中看到了模式。下面一个实验是：500个服从单位高斯分布的点，数据集是100维的。下面的original图是前两维数据的映射。 &emsp;&emsp;perplexity=2的时候，呈现戏剧性的聚类，如果就此发现了数据结构，你可能认为自己中了头彩！&emsp;&emsp;从上面所有的实验可以看出perplexity比较低的时候可能会导致这类的分布。识别这些欺骗性的块是识别t-SNE图的一项重要部分。事实上，上图这些特征非常接近于球面上的均匀分布：均匀分布，在点之间的空间大致相等。看到这，t-sne可能比所有线性映射都更精确。 6、有时，你会看到一些形状 &emsp;&emsp;让我们看一下在50维空间中与轴对齐的高斯分布，在这里，坐标i的标准偏差是1/i。也就是说，我们看到的是一个稍长的椭球点云。 &emsp;&emsp;从上图的结果可以看到，perplexity足够大的时候，稍长的形状很容易看到。但=2的时候，无意义的簇开始占主导。有时候，在特定的perplexity，可以看到特定的形状。&emsp;&emsp;下图的数据是2维平面上75点的两簇数据。平行线排列，有一点噪声。 &emsp;&emsp;线条弯曲解释：t-sne尝试扩大数据的密集区域。因为簇的中间区域比边缘区域有更大的密度，t-sne会放大这个特征。 7、拓扑数据，你可能需要更多的图 &emsp;&emsp;一个典型的拓扑特征是包含。下图的数据源是：两组50维的数据，各有70点。它们都是从关于原点对称的高斯分布中取样的。但是，一个数据点的分布是另一个的50倍。“小”分布实际上包含在大的分布中。 &emsp;&emsp;perplexity=30的时候，内群的大小被过分夸大。perplexity=50的时候，外群变成了一个圆一样的结构，这个图试图描述所有的点都与内群的距离相同的事实（实际不是如此）。如果单独看外群，可能会认为它是一个一维的结构。但是更复杂的拓扑结构呢？&emsp;&emsp;下图原始结构是一个俩环相互嵌套的结构。perplexity比较小的时候，两环分离了！ &emsp;&emsp;下图是一个三叶草结构的数据。 &emsp;&emsp;下图是三叶草结构perplexity=2的5次运行结果。（正如前面所说，t-sne每次运行，可能得到的结果都不一样，即使设置的参数一样） &emsp;&emsp;下图是三叶草结构perplexity=50的5次运行结果。（可以看到，perplexity不能设置得太小） 8、结论 &emsp;&emsp;tsen灵活性强，能经常发现其他降维方法发现不了的特征。 .tsne-group { overflow: visible; display: -webkit-flex; display: flex; flex-direction: column; margin-top: 36px; margin-bottom: 36px; } @media(min-width: 640px) { .tsne-group { -webkit-flex-direction: row; flex-direction: row; } } .tsne-group .original, .tsne-group .runner { box-sizing: border-box; -webkit-flex-grow: 1; flex-grow: 1; position: relative; display: -webkit-flex; display: flex; margin-bottom: 12px; } .tsne-group .original { position: relative; border-bottom: 1px solid rgba(0, 0, 0, 0.1); padding-bottom: 12px; } @media(min-width: 640px) { .tsne-group .original, .tsne-group .runner { display: block; width: 100%; margin-bottom: 0; } .tsne-group .original { margin-left: 0; padding-right: 12px; border-right: 1px solid rgba(0, 0, 0, 0.1); border-bottom: none; padding-bottom: 0; } .tsne-group .runner { margin-left: 12px; } } .tsne-group .runner.no-click { cursor: default; } .runner.clickable { cursor: pointer; } .runner.clickable:hover .image { box-shadow: 0 2px 12px rgba(0, 0, 0, 0.08); } .runner:hover i { opacity: 1; } .runner.selected i { opacity: 1; } .runner i { font-size: 30px; position: absolute; top: 1px; left: 1px; background-color: hsla(207, 44%, 79%, 0.8); color: steelblue; border-radius: 4px; opacity: 0; transition: opacity 0.3s; line-height: 0; width: 150px; padding: 75px 0; text-align: center; } @media(min-width: 640px) { .runner i { width: 100%; padding: 50% 0; } } .runner.selected .image::after { content: \"\"; border: 2px solid rgba(70, 130, 180, 1); width: 100%; height: 100%; position: absolute; top: 0; box-sizing: border-box; border-radius: 4px; z-index: 10; } .tsne-group .image { border: 1px solid rgba(0, 0, 0, 0.1); border-radius: 4px; box-shadow: 0 0 6px rgba(0, 0, 0, 0.08); width: 150px; padding-top: 150px; background: white; position: relative; transition: border-color 0.3s, box-shadow 0.3s; margin-right: 12px; } @media(min-width: 640px) { .tsne-group .image { width: 100%; padding-top: 100%; margin-right: 0; } } .tsne-group .original .image { box-shadow: none; } .tsne-group .image img { position: absolute; top: 5%; left: 5%; width: 90%; } .tsne-group h3.caption { font-size: 15px; margin-top: 12px; } .tsne-group .caption { font-size: 12px; line-height: 1.6em; margin-top: 12px; width: 100px; } @media(min-width: 640px) { .tsne-group .caption, .tsne-group h3.caption { margin-top: 8px; width: 100%; } } (function() { var format = d3.format(\",\"); d3.selectAll(\".tsne-group\").data(figures, function(d) { if(!d) return this.dataset.id; return d.id }) .each(generateFigure) function generateFigure(figure) { var FIGURE = figure.id var dis = d3.select(this) var original = dis.append(\"div\").classed(\"original\", true) original.append(\"div\") .classed(\"image\", true) .append(\"img\") .classed(\"tsne-plot\", true) .attr(\"src\", \"./figure_\" + FIGURE + \"_\" + \"original.png\"); original.append(\"h3\").classed(\"caption\", true).text(\"Original\") // examples var runners = dis.selectAll(\".runner\").data(figure.examples) .enter().append(\"div\").classed(\"runner\", true) if(!figure.noclick) { runners .classed(\"clickable\", true) .on(\"click\", function(d) { d3.selectAll(\".runner\").classed(\"selected\", false) updateStateFromFigure(figure, d, this); d3.select(this).classed(\"selected\", true) }); } else { runners.classed(\"no-click\", true) } runners.append(\"div\") .classed(\"image\", true) .append(\"img\") .attr(\"src\", function(d,i) { return \"./figure_\" + FIGURE + \"_\" + d.id + \".png\" }); if(!figure.noclick) { runners.append(\"i\") .classed(\"material-icons\", true) .text(\"open_in_browser\") } var caption = runners.append(\"div\").classed(\"caption\", true); caption.append(\"div\").text(function(d) { return \"Perplexity: \" + format(d.perplexity); }) caption.append(\"div\").text(function(d) { return \"Step: \" + format(d.step); }) } })() dt-cite { color: hsla(206, 90%, 20%, 0.7); } dt-cite .citation-number { cursor: default; white-space: nowrap; font-family: -apple-system, BlinkMacSystemFont, \"Roboto\", Helvetica, sans-serif; font-size: 75%; color: hsla(206, 90%, 20%, 0.7); display: inline-block; line-height: 1.1em; text-align: center; position: relative; top: -2px; margin: 0 2px; } dt-cite .citation-number { font-size: 11px; font-weight: normal; top: -2px; line-height: 1em; } Visualizing data using t-SNE[PDF]L.v.d. Maaten, G. Hinton.Journal of Machine Learning Research, Vol 9(Nov), pp. 2579—2605. 2008. function nodeFromString(str) { var div = document.createElement(\"div\"); div.innerHTML = str; return div.firstChild; } function make_hover_css(pos) { var pretty = window.innerWidth > 600; var padding = pretty? 18 : 12; var outer_padding = pretty ? 18 : 0; var bbox = document.querySelector(\"body\").getBoundingClientRect(); var left = pos[0] - bbox.left, top = pos[1] - bbox.top; var width = Math.min(window.innerWidth-2*outer_padding, 648); left = Math.min(left, window.innerWidth-width-outer_padding); width = width - 2*padding; return (`position: absolute; background-color: #FFF; opacity: 0.95; max-width: ${width}px; top: ${top}px; left: ${left}px; border: 1px solid rgba(0, 0, 0, 0.25); padding: ${padding}px; border-radius: ${pretty? 3 : 0}px; box-shadow: 0px 2px 10px 2px rgba(0, 0, 0, 0.2); z-index: ${1e6};`); } function DtHoverBox(div_id) { this.div = document.querySelector(\"#\"+div_id); this.visible = false; this.bindDivEvents(); DtHoverBox.box_map[div_id] = this; } DtHoverBox.box_map = {}; DtHoverBox.get_box = function get_box(div_id) { if (div_id in DtHoverBox.box_map) { return DtHoverBox.box_map[div_id]; } else { return new DtHoverBox(div_id); } } DtHoverBox.prototype.show = function show(pos){ this.visible = true; this.div.setAttribute(\"style\", make_hover_css(pos) ); for (var box_id in DtHoverBox.box_map) { var box = DtHoverBox.box_map[box_id]; if (box != this) box.hide(); } } DtHoverBox.prototype.showAtNode = function showAtNode(node){ var bbox = node.getBoundingClientRect(); this.show([bbox.right, bbox.bottom]); } DtHoverBox.prototype.hide = function hide(){ this.visible = false; if (this.div) this.div.setAttribute(\"style\", \"display:none\"); if (this.timeout) clearTimeout(this.timeout); } DtHoverBox.prototype.stopTimeout = function stopTimeout() { if (this.timeout) clearTimeout(this.timeout); } DtHoverBox.prototype.extendTimeout = function extendTimeout(T) { //console.log(\"extend\", T) var this_ = this; this.stopTimeout(); this.timeout = setTimeout(function(){this_.hide();}.bind(this), T); } // Bind events to a link to open this box DtHoverBox.prototype.bind = function bind(node) { if (typeof node == \"string\"){ node = document.querySelector(node); } node.addEventListener(\"mouseover\", function(){ if (!this.visible) this.showAtNode(node); this.stopTimeout(); }.bind(this)); node.addEventListener(\"mouseout\", function(){this.extendTimeout(250);}.bind(this)); node.addEventListener(\"touchstart\", function(e) { if (this.visible) { this.hide(); } else { this.showAtNode(node); } // Don't trigger body touchstart event when touching link e.stopPropagation(); }.bind(this)); } DtHoverBox.prototype.bindDivEvents = function bindDivEvents(){ // For mice, same behavior as hovering on links this.div.addEventListener(\"mouseover\", function(){ if (!this.visible) this.showAtNode(node); this.stopTimeout(); }.bind(this)); this.div.addEventListener(\"mouseout\", function(){this.extendTimeout(250);}.bind(this)); // Don't trigger body touchstart event when touching within box this.div.addEventListener(\"touchstart\", function(e){e.stopPropagation();}); // Close box when touching outside box document.body.addEventListener(\"touchstart\", function(){this.hide();}.bind(this)); } var hover_es = document.querySelectorAll(\"span[data-hover-ref]\"); hover_es = [].slice.apply(hover_es); hover_es.forEach(function(e,n){ var ref_id = e.getAttribute(\"data-hover-ref\"); DtHoverBox.get_box(ref_id).bind(e); })","categories":[{"name":"test","slug":"test","permalink":"https://www.xunhanliu.top/categories/test/"}],"tags":[{"name":"test","slug":"test","permalink":"https://www.xunhanliu.top/tags/test/"}]},{"title":"Hello World","slug":"hello-world","date":"2017-07-31T16:00:00.000Z","updated":"2018-07-03T19:05:09.545Z","comments":true,"path":"2017/08/01/hello-world/","link":"","permalink":"https://www.xunhanliu.top/2017/08/01/hello-world/","excerpt":"","text":"Welcome to Hexo! This is your very first post. Check documentation for more info. If you get any problems when using Hexo, you can find the answer in troubleshooting or you can ask me on GitHub. Quick StartCreate a new post1$ hexo new \"My New Post\" More info: Writing Run server1$ hexo server More info: Server Generate static files1$ hexo generate More info: Generating Deploy to remote sites1$ hexo deploy More info: Deployment","categories":[{"name":"开源项目","slug":"开源项目","permalink":"https://www.xunhanliu.top/categories/开源项目/"}],"tags":[{"name":"博客","slug":"博客","permalink":"https://www.xunhanliu.top/tags/博客/"},{"name":"开源项目","slug":"开源项目","permalink":"https://www.xunhanliu.top/tags/开源项目/"}]},{"title":"MiHo-主题安装和配置详情","slug":"installation-configuration","date":"2017-07-31T16:00:00.000Z","updated":"2018-07-05T03:07:16.441Z","comments":true,"path":"2017/08/01/installation-configuration/","link":"","permalink":"https://www.xunhanliu.top/2017/08/01/installation-configuration/","excerpt":"","text":"一. 主题简介&emsp;&emsp;MiHo 是一款单栏响应式的Hexo主题；基于 Hexo 3.0+ 制作，兼容移动端浏览；主题的代码托管在GitHub上，欢迎Star和Fork；如遇到问题或发表建议，可以提Issues，也可以在博客中留言给我，另外,喜欢的话不妨给个 Star。 二. 安装2.1 安装主题1$ git clone https://github.com/WongMinHo/hexo-theme-miho.git themes/miho MiHo 主题需要Hexo 3.0或以上版本，请先升级。 2.2 更新12cd themes/mihogit pull 2.3 依赖安装如下依赖如果已经安装，请看配置介绍。 Json-content生成站点文章静态数据，用于站内搜索。1npm install hexo-generator-json-content --save 三. 站点配置站点配置文件_config.yml在hexo根目录下。 3.1 启用主题1`theme: miho` 3.2 网站基本配置以下配置是站点的全局配置，更多配置，请查看123456title: MinHow's Blogsubtitle: 网站副标题description: 专注 WEB 开发的技术博客author: MinHowlanguage: 网站使用的语言timezone: 网站时区 3.3 jsonContent配置详细的配置请查看hexo-generator-json-content123456789101112131415161718jsonContent: meta: false pages: false posts: title: true date: true path: true text: false raw: false content: false slug: false updated: false comments: false link: false permalink: false excerpt: false categories: false tags: false 四. 主题配置编辑主题配置文件，themes/miho/_config.yml。 4.1 属性下面将介绍几个比较重要的配置。123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122# hexo-theme-miho# https://github.com/wongminho/hexo-theme-miho# Favicon of your site | 网站iconfavicon: /favicon.ico# Header# Keywords of your site | 网站关键字keywords: MinHow,MinHow's Blog# Head headline | 头部标题header_title: MinHow's Blog# Head description | 头部描述header_description: 一个专注 WEB 开发的技术博客# Link to your logo | logo地址logo: images/logo.png# Link to your banner_img | 首页banner图地址banner_img: images/banner.jpg# Menu setting | 菜单设置# name: Font Awesome icon | Font Awesome 图标# title: Home Title | 标题# url: //minhow.com Url, absolute or relative path | 链接，绝对或相对路径# target: true Whether to jump out | 是否跳出menu: home: title: Home url: / target: false archive: title: Archives url: /archives target: false user: title: About url: /about target: false# Social setting, use to display social information | 社交设置，用来展示社交信息# name: Font Awesome icon | Font Awesome 图标# title: Home Icon title | 图标标题# url: //minhow.com Url, absolute or relative path | 链接，绝对或相对路径# target: true Whether to jump out | 是否跳出social: home: title: MinHow url: //minhow.com target: true github: title: Github url: //github.com/wongminho target: true weibo: title: Weibo url: //weibo.com/WongMinHo target: true twitter: title: Twitter url: //twitter.com/huangminhow target: true #qq: #weixin: #snapchat: #telegram: #mail: #facebook: #google: #linkedin:# Content# Excerpt length | 摘录长度excerpt_length: 190# Excerpt link | 摘录链接excerpt_link: more&gt;&gt;# New window open link | 新窗口打开文章open_new_link: false# Article default cover picture，size：350*150 | 文章默认封面图，尺寸：350*150cover_picture: images/banner.jpg# Open background particles | 开启背景粒子open_bg_particle: true# Open animation in homepage and head | 开启主页及头部动画open_animation: true# Article# Open toc | 是否开启toctoc: true# Open share | 是否开启分享share: true# Style customization | 样式定制style: # Main color tone | 主色调 main_color: '#0cc'# Comments | 评论# 畅言，输入appid和appkeychangyan_appid: falsechangyan_appkey: false# 友言，输入idyouyan_id: false# disqusdisqus: false# Analytics | 分析# 站长分析，输入站点idcnzz_analytics: false# 百度分析，输入key值baidu_analytics: false# google analytics | google分析google_analytics: false# Footer# Access statistics | “不蒜子”访问量统计access_counter: on: true site_uv: 总访客数： site_pv: 总访问量：# Copyright Information | 版权信息copyright: 2017 MinHow 4.2 文章封面图文章默认封面图，尺寸：350*150，当文章基本配置没有cover_picture时才显示。1cover_picture: images/banner.jpg 4.3 开启背景粒子是否开启背景粒子。1open_bg_particle: true 4.4 开启主页及头部动画是否开启主页及头部动画。1open_animation: true 4.5 评论支持畅言、disqus。1234567# 畅言，输入appid和appkeychangyan_appid: falsechangyan_appkey: false# 友言，输入idyouyan_id: false# disqusdisqus: false 4.6 数据统计支持站长、百度、google三种数据统计，正确填写配置信息即可。123456# 站长分析，输入站点idcnzz_analytics: false# 百度分析，输入key值baidu_analytics: false# google分析google_analytics: false 4.7 文章基本配置123456789101112---title: Hello Worlddate: 2017-06-18categories: Firstauthor: MinHowtags: - First - Secondcover_picture: /images/banner.jpg--- MinHow-This is a summary&lt;!-- more --&gt; 说明： 需要注意tags和摘要的写法，不然首页不能正确显示标签和摘要； cover_picture文章封面图，不填默认显示_config.yml配置的图片。","categories":[{"name":"开源项目","slug":"开源项目","permalink":"https://www.xunhanliu.top/categories/开源项目/"}],"tags":[{"name":"博客","slug":"博客","permalink":"https://www.xunhanliu.top/tags/博客/"},{"name":"开源项目","slug":"开源项目","permalink":"https://www.xunhanliu.top/tags/开源项目/"}]},{"title":"md文件模板+html","slug":"testHtml","date":"2017-07-31T16:00:00.000Z","updated":"2018-07-05T14:12:53.123Z","comments":true,"path":"2017/08/01/testHtml/","link":"","permalink":"https://www.xunhanliu.top/2017/08/01/testHtml/","excerpt":"","text":"Welcome to Hexo! This is your very first post. Check documentation for more info. If you get any problems when using Hexo, you can find the answer in troubleshooting or you can ask me on GitHub. Quick StartCreate a new post1$ hexo new \"My New Post\" More info: Writing Run server1$ hexo server More info: Server Generate static files1$ hexo generate More info: Generating Deploy to remote sites1$ hexo deploy More info: Deployment","categories":[{"name":"test","slug":"test","permalink":"https://www.xunhanliu.top/categories/test/"}],"tags":[{"name":"test","slug":"test","permalink":"https://www.xunhanliu.top/tags/test/"}]},{"title":"test_Md+Html","slug":"testMd+Html","date":"2017-07-31T16:00:00.000Z","updated":"2018-07-06T18:12:20.241Z","comments":false,"path":"2017/08/01/testMd+Html/","link":"","permalink":"https://www.xunhanliu.top/2017/08/01/testMd+Html/","excerpt":"","text":"Welcome to Hexo! This is your very first post. Check documentation for more info. If you get any problems when using Hexo, you can find the answer in troubleshooting or you can ask me on GitHub. Quick StartCreate a new post1$ hexo new \"My New Post\" More info: Writing Run server1$ hexo server More info: Server Generate static files1$ hexo generate More info: Generating Deploy to remote sites1$ hexo deploy More info: Deployment 内联style又一个title h2标签 外联style 再来一个title","categories":[{"name":"test","slug":"test","permalink":"https://www.xunhanliu.top/categories/test/"}],"tags":[{"name":"test","slug":"test","permalink":"https://www.xunhanliu.top/tags/test/"}]}]}